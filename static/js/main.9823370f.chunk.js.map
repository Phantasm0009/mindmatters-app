{"version":3,"sources":["services/storageService.js","services/weatherService.js","services/colorService.js","components/ThemeManager.js","components/JournalEntry.js","components/JournalLog.js","components/MoodTracker.js","components/BreathingExercises.js","components/EmergencyContacts.js","services/smsService.js","components/SOSButton.js","services/quoteService.js","components/DailyQuote.js","components/WeatherMood.js","services/geoLocationService.js","data/crisisHotlines.js","services/wikiHotlineService.js","services/crisisHotlineService.js","components/CrisisHotlines.js","services/notificationService.js","components/Settings.js","components/Dashboard.js","App.js","index.js"],"names":["DB_NAME","dbPromise","dbInitialized","getDB","async","console","log","openDB","upgrade","db","oldVersion","newVersion","transaction","concat","objectStoreNames","contains","createObjectStore","keyPath","autoIncrement","createIndex","unique","Array","from","err","error","getMoodEntries","getAll","warn","DEFAULT_LAT","DEFAULT_LONG","fetchCurrentWeather","latitude","longitude","navigator","onLine","cachedWeather","localStorage","getItem","data","timestamp","JSON","parse","Date","now","_objectSpread","source","Error","url","response","fetch","signal","AbortSignal","timeout","ok","status","json","weatherCache","setItem","stringify","getWeatherIcon","code","isDay","arguments","length","undefined","getDefaultPalette","mood","defaultPalettes","happy","excited","calm","relaxed","neutral","sad","stressed","angry","anxious","tired","grateful","rgbToHex","rgb","map","x","hex","toString","join","rgbToRgba","alpha","getContrastColor","ThemeContext","createContext","useTheme","useContext","ThemeProvider","_ref","children","currentTheme","setCurrentTheme","useState","customTheme","setCustomTheme","showPicker","setShowPicker","isApplying","setIsApplying","currentMood","setCurrentMood","useEffect","isMounted","themeVars","appliedMood","lastMoodEntry","getLastMoodEntry","moodValue","getAndApplyMoodTheme","getMoodName","applyThemeVariables","applyTheme","savedTheme","savedMood","savedCustomTheme","parsedTheme","e","savedThemeVars","parsedVars","loadSavedTheme","entries","sort","a","b","date","palette","getMoodColorPalette","isArray","primary","secondary","accent","background","text","onPrimary","onSecondary","onAccent","onBackground","primaryLight","c","Math","min","round","primaryDark","secondaryLight","secondaryDark","accentLight","accentDark","primaryTransparent","backgroundDark","max","createThemeFromPalette","variables","root","document","documentElement","Object","forEach","_ref2","key","value","style","setProperty","changeTheme","theme","generateThemeFromMood","themeContextValue","_jsx","Provider","_jsxs","className","onClick","disabled","marginTop","textAlign","fontSize","opacity","JournalEntry","entry","setEntry","thoughts","activities","gratitude","weather","showSuccess","setShowSuccess","loadingWeather","setLoadingWeather","weatherError","setWeatherError","location","Promise","resolve","reject","geolocation","getCurrentPosition","position","coords","message","weatherData","current","prev","temperature","temperature_2m","weatherCode","weather_code","humidity","relative_humidity_2m","is_day","getWeatherData","handleInputChange","name","target","getMoodLabel","onSubmit","preventDefault","newEntry","toISOString","add","saveJournalEntry","setTimeout","type","onChange","newMoodValue","parseInt","moodTexts","htmlFor","id","placeholder","rows","activity","includes","updatedActivities","index","indexOf","splice","push","handleActivityToggle","JournalLog","setEntries","loading","setLoading","filter","setFilter","selectedEntry","setSelectedEntry","searchTerm","setSearchTerm","sortedData","fetchEntries","getFilteredEntries","filteredEntries","oneWeekAgo","setDate","getDate","oneMonthAgo","setMonth","getMonth","trim","term","toLowerCase","formatDate","dateString","toLocaleDateString","weekday","year","month","day","getMoodEmoji","getEntryStyle","borderColor","gradientColor","borderLeft","closeEntryDetails","handleEntryClick","substring","slice","i","stopPropagation","ChartJS","register","registerables","MoodTracker","moodData","setMoodData","timeRange","setTimeRange","showGrid","setShowGrid","chartDataState","setChartDataState","labels","datasets","label","backgroundColor","borderWidth","getMoodData","moods","generateSampleMoodData","fetchMoodData","updateChartData","today","sampleData","floor","random","split","filteredData","cutoff","setFullYear","getFullYear","filtered","formatDisplayDate","dateStr","fill","tension","pointBackgroundColor","pointBorderColor","pointBorderWidth","pointRadius","pointHoverRadius","chartOptions","responsive","maintainAspectRatio","plugins","legend","display","tooltip","mode","intersect","titleColor","bodyColor","padding","displayColors","bodyFont","size","callbacks","title","context","raw","afterLabel","dataIndex","scales","y","ticks","stepSize","font","color","weight","grid","maxRotation","minRotation","interaction","axis","elements","line","stats","calculateMoodStatistics","avg","highest","lowest","moodValues","reduce","total","toFixed","checked","_Fragment","Line","options","BreathingExercises","activeExercise","setActiveExercise","isPlaying","setIsPlaying","counter","setCounter","phase","setPhase","cycles","setCycles","selectedCategory","setSelectedCategory","progress","setProgress","totalDuration","setTotalDuration","elapsedTime","setElapsedTime","timerRef","useRef","phaseTimerRef","countdownIntervalRef","exercises","description","category","inhaleTime","holdInTime","exhaleTime","holdOutTime","benefits","stopExercise","clearInterval","clearTimeout","startPhaseTimer","exercise","currentPhase","duration","nextPhase","newCycles","startCountdown","seconds","setInterval","calculateTotalDuration","filteredExercises","ex","replace","width","intervalId","newElapsed","progressPercent","startExercise","EmergencyContacts","contacts","setContacts","setName","phone","setPhone","editIndex","setEditIndex","isAdding","setIsAdding","formError","setFormError","savedContacts","contact","testCall","phoneNumber","window","href","handleEdit","newContacts","_","removeContact","test","updatedContacts","handleCancel","sendSMS","isIOS","userAgent","encodedMessage","encodeURIComponent","smsLink","SOSButton","showConfirm","setShowConfirm","sending","setSending","sent","setSent","hasContacts","setHasContacts","history","useHistory","checkContacts","storedContacts","handleStorageChange","addEventListener","removeEventListener","handleSOSClick","handleConfirmSOS","toLocaleString","recipients","fallbackQuotes","quote","author","DailyQuote","setQuote","tags","authorBio","refreshing","setRefreshing","isOnline","setIsOnline","showCopied","setShowCopied","showAuthorInfo","setShowAuthorInfo","handleOnline","handleOffline","getQuote","forceRefresh","quoteData","toDateString","cachedData","cached","success","apis","parser","content","tag","bio","q","randomQuote","quoteText","quoteAuthor","api","randomIndex","fallbackQuote","fetchDailyQuote","storedQuote","storedDate","parsedQuote","toggleAuthorInfo","copyQuote","textToCopy","clipboard","writeText","then","catch","Chart","WeatherMood","currentWeather","setCurrentWeather","setError","analysis","setAnalysis","moodEntries","setMoodEntries","chartType","setChartType","getUserLocation","weatherAnalysis","analyzeWeatherMoodPatterns","hasEnoughData","weatherMoodGroups","sunny","avgMood","cloudy","rainy","snowy","keys","weatherType","group","sum","acc","parseFloat","count","insights","bestWeather","highestMood","worstWeather","lowestMood","difference","fetchData","defaultLocation","getChartData","weatherTypes","getWeatherColors","charAt","toUpperCase","borderRadius","hoverBackgroundColor","getChartOptions","baseOptions","parsed","beginAtZero","animation","easing","r","backdropColor","angleLines","pointLabels","formatTemperature","temp","reload","apparent_temperature","getWeatherTimeAgo","diff","minutes","hours","days","Bar","insight","cachedLocationData","cacheTimestamp","crisisHotlines","country","countryCode","hotlines","altPhone","website","CACHE_KEY","getCombinedHotlines","staticHotlines","wikiSuccess","getHotlinesCacheStatus","getWikiHotlinesCacheInfo","age","exists","ageInDays","getHotlinesForCountry","normalizedCode","find","getAvailableCountries","CrisisHotlines","userCountry","setUserCountry","countryHotlines","setCountryHotlines","availableCountries","setAvailableCountries","allHotlines","setAllHotlines","selectedCountry","setSelectedCountry","dataSource","setDataSource","cacheInfo","setCacheInfo","isRefreshing","setIsRefreshing","storedLocation","country_name","country_code","city","region","getUserCountry","cacheStatus","countries","initialCountry","countryData","callHotline","startsWith","hotline","rel","SETTINGS_STORE","canUseNotifications","Notification","permission","requestPermission","scheduleDailyReminder","hour","minute","saveNotificationSettings","enabled","reminderTime","serviceWorker","controller","postMessage","body","getTime","delay","icon","badge","put","settings","getNotificationSettings","get","Settings","activeSection","setActiveSection","notificationPermission","setNotificationPermission","reminderEnabled","setReminderEnabled","setReminderTime","isInstalledPWA","setIsInstalledPWA","appVersion","setAppVersion","offlineStatus","setOfflineStatus","testNotificationSent","setTestNotificationSent","storageUsage","setStorageUsage","reminderActive","isReminderActive","time","getReminderTime","String","padStart","checkNotificationState","checkPWAStatus","isStandalone","matchMedia","matches","standalone","referrer","storage","estimate","usedMB","usage","quotaMB","quota","percentUsed","used","percent","calculateStorageUsage","requestNotificationPermission","sendTestNotification","cancelDailyReminder","Number","newTime","handleInstallClick","deferredPrompt","prompt","userChoice","choiceResult","outcome","confirm","indexedDB","databases","deleteDatabase","clear","caches","all","delete","src","alt","Dashboard","defaultTab","activeTab","setActiveTab","mobileNavOpen","setMobileNavOpen","useLocation","path","pathname","toggleMobileNav","Link","to","items","item","App","Router","Switch","Route","exact","Redirect","swUrl","scope","registration","classList","remove","ReactDOM","render","React","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.9823370f.chunk.js","sourcesContent":["import { openDB } from 'idb';\r\n\r\nconst DB_NAME = 'MindMattersDB';\r\n// Increase the version number to trigger a proper upgrade\r\nconst DB_VERSION = 2;\r\nlet dbPromise = null;\r\nlet dbInitialized = false;\r\n\r\n// Initialize database with proper initialization check\r\nconst getDB = async () => {\r\n  if (!dbPromise) {\r\n    try {\r\n      console.log('Initializing database...');\r\n      dbPromise = openDB(DB_NAME, DB_VERSION, {\r\n        upgrade(db, oldVersion, newVersion, transaction) {\r\n          console.log(`Upgrading database from v${oldVersion} to v${newVersion}`);\r\n          \r\n          // Create all necessary object stores if they don't exist\r\n          if (!db.objectStoreNames.contains('moodEntries')) {\r\n            console.log('Creating moodEntries store');\r\n            const store = db.createObjectStore('moodEntries', { \r\n              keyPath: 'id', \r\n              autoIncrement: true \r\n            });\r\n            store.createIndex('date', 'date', { unique: false });\r\n          }\r\n          \r\n          if (!db.objectStoreNames.contains('settings')) {\r\n            console.log('Creating settings store');\r\n            db.createObjectStore('settings', { keyPath: 'id' });\r\n          }\r\n          \r\n          if (!db.objectStoreNames.contains('themes')) {\r\n            console.log('Creating themes store');\r\n            db.createObjectStore('themes', { keyPath: 'id' });\r\n          }\r\n        }\r\n      });\r\n      \r\n      // Wait for the database to open successfully\r\n      const db = await dbPromise;\r\n      dbInitialized = true;\r\n      console.log('Database initialized successfully with stores:', Array.from(db.objectStoreNames));\r\n      return db;\r\n    } catch (err) {\r\n      console.error('Database initialization failed:', err);\r\n      dbPromise = null;\r\n      return null;\r\n    }\r\n  }\r\n  \r\n  // Wait for the promise to resolve\r\n  try {\r\n    return await dbPromise;\r\n  } catch (err) {\r\n    console.error('Error accessing database:', err);\r\n    dbPromise = null;\r\n    return null;\r\n  }\r\n};\r\n\r\n// Enhanced getMoodEntries with better error handling\r\nexport const getMoodEntries = async () => {\r\n  try {\r\n    const db = await getDB();\r\n    if (!db) {\r\n      console.warn('Database not available, returning empty entries list');\r\n      return [];\r\n    }\r\n    \r\n    // Verify the object store exists before attempting transaction\r\n    if (!db.objectStoreNames.contains('moodEntries')) {\r\n      console.error('moodEntries store not found in database');\r\n      return [];\r\n    }\r\n    \r\n    return await db.getAll('moodEntries');\r\n  } catch (error) {\r\n    console.error('Error getting mood entries:', error);\r\n    return []; // Return empty array as fallback\r\n  }\r\n};\r\n\r\n// Apply the same pattern to other database methods\r\nexport const saveJournalEntry = async (entry) => {\r\n  try {\r\n    const db = await getDB();\r\n    if (!db) {\r\n      console.error('Cannot save entry: Database not available');\r\n      return false;\r\n    }\r\n    \r\n    // Verify the object store exists\r\n    if (!db.objectStoreNames.contains('moodEntries')) {\r\n      console.error('Cannot save entry: moodEntries store not found');\r\n      return false;\r\n    }\r\n    \r\n    await db.add('moodEntries', entry);\r\n    console.log('Journal entry saved successfully');\r\n    return true;\r\n  } catch (error) {\r\n    console.error('Error saving journal entry:', error);\r\n    return false;\r\n  }\r\n};\r\n\r\n// Add a mood entry\r\nexport const addMoodEntry = async (entry) => {\r\n  try {\r\n    const db = await getDB();\r\n    if (!db) {\r\n      console.error('Cannot add entry: Database not available');\r\n      return false;\r\n    }\r\n\r\n    // Verify the object store exists\r\n    if (!db.objectStoreNames.contains('moodEntries')) {\r\n      console.error('Cannot add entry: moodEntries store not found');\r\n      return false;\r\n    }\r\n\r\n    await db.add('moodEntries', entry);\r\n    console.log('Mood entry added successfully');\r\n    return true;\r\n  } catch (error) {\r\n    console.error('Error adding mood entry:', error);\r\n    return false;\r\n  }\r\n};\r\n\r\n// Get mood data function explicitly exported\r\nexport const getMoodData = async () => {\r\n  try {\r\n    return await getMoodEntries();\r\n  } catch (error) {\r\n    console.error(\"Error fetching mood data:\", error);\r\n    return []; // Return empty array on error\r\n  }\r\n};\r\n\r\n// Clear all mood entries\r\nexport const clearMoodEntries = async () => {\r\n  try {\r\n    const db = await getDB();\r\n    if (!db) {\r\n      console.error('Cannot clear entries: Database not available');\r\n      return false;\r\n    }\r\n\r\n    // Verify the object store exists\r\n    if (!db.objectStoreNames.contains('moodEntries')) {\r\n      console.error('Cannot clear entries: moodEntries store not found');\r\n      return false;\r\n    }\r\n\r\n    await db.clear('moodEntries');\r\n    console.log('All mood entries cleared successfully');\r\n    return true;\r\n  } catch (error) {\r\n    console.error('Error clearing mood entries:', error);\r\n    return false;\r\n  }\r\n};\r\n\r\n// Get mood entries by date\r\nexport const getMoodEntriesByDate = async (date) => {\r\n  try {\r\n    const entries = await getMoodEntries();\r\n    return entries.filter(entry => entry.date === date);\r\n  } catch (error) {\r\n    console.error('Error getting mood entries by date:', error);\r\n    return [];\r\n  }\r\n};\r\n\r\n// Add to storageService.js\r\nexport const resetDatabase = async () => {\r\n  try {\r\n    await deleteDB(DB_NAME);\r\n    dbPromise = null;\r\n    dbInitialized = false;\r\n    console.log('Database reset successfully');\r\n    return true;\r\n  } catch (err) {\r\n    console.error('Error resetting database:', err);\r\n    return false;\r\n  }\r\n};","/**\r\n * Weather service to interact with Open-Meteo API\r\n */\r\n\r\n// Default coordinates if geolocation is not available\r\nconst DEFAULT_LAT = 40.7128;  // New York\r\nconst DEFAULT_LONG = -74.0060;\r\n\r\n/**\r\n * Get the user's current location\r\n * @returns {Promise} Promise resolving to {latitude, longitude}\r\n */\r\nexport const getUserLocation = () => {\r\n  return new Promise((resolve, reject) => {\r\n    if (!navigator.geolocation) {\r\n      console.log('Geolocation not supported, using default location');\r\n      resolve({ latitude: DEFAULT_LAT, longitude: DEFAULT_LONG });\r\n      return;\r\n    }\r\n\r\n    navigator.geolocation.getCurrentPosition(\r\n      (position) => {\r\n        resolve({\r\n          latitude: position.coords.latitude,\r\n          longitude: position.coords.longitude\r\n        });\r\n      },\r\n      (error) => {\r\n        console.error('Error getting location:', error.message);\r\n        resolve({ latitude: DEFAULT_LAT, longitude: DEFAULT_LONG });\r\n      },\r\n      { timeout: 10000 }\r\n    );\r\n  });\r\n};\r\n\r\n/**\r\n * Fetch current weather data from Open-Meteo API\r\n * @param {number} latitude - Location latitude\r\n * @param {number} longitude - Location longitude\r\n * @returns {Promise} Weather data\r\n */\r\nexport const fetchCurrentWeather = async (latitude, longitude) => {\r\n  try {\r\n    // If offline, return cached weather if available\r\n    if (!navigator.onLine) {\r\n      const cachedWeather = localStorage.getItem('cachedWeather');\r\n      if (cachedWeather) {\r\n        const { data, timestamp } = JSON.parse(cachedWeather);\r\n        // Return cached data if less than 3 hours old\r\n        if (Date.now() - timestamp < 3 * 60 * 60 * 1000) {\r\n          return { ...data, source: 'cache' };\r\n        }\r\n      }\r\n      throw new Error('Offline and no recent cached weather');\r\n    }\r\n\r\n    const url = `https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current=temperature_2m,relative_humidity_2m,apparent_temperature,is_day,precipitation,rain,showers,snowfall,weather_code,cloud_cover,pressure_msl,wind_speed_10m,wind_direction_10m,wind_gusts_10m&hourly=temperature_2m,precipitation_probability,weather_code&daily=weather_code,temperature_2m_max,temperature_2m_min,sunrise,sunset&timezone=auto&forecast_days=1`;\r\n\r\n    const response = await fetch(url, { \r\n      signal: AbortSignal.timeout(5000) // 5 second timeout\r\n    });\r\n    \r\n    if (!response.ok) {\r\n      throw new Error(`Weather API error: ${response.status}`);\r\n    }\r\n\r\n    const data = await response.json();\r\n    \r\n    // Cache the weather data\r\n    const weatherCache = {\r\n      data,\r\n      timestamp: Date.now()\r\n    };\r\n    localStorage.setItem('cachedWeather', JSON.stringify(weatherCache));\r\n    \r\n    return { ...data, source: 'api' };\r\n  } catch (error) {\r\n    console.error('Failed to fetch weather:', error);\r\n    \r\n    // Return cached data if available, regardless of age\r\n    const cachedWeather = localStorage.getItem('cachedWeather');\r\n    if (cachedWeather) {\r\n      const { data } = JSON.parse(cachedWeather);\r\n      return { ...data, source: 'old-cache' };\r\n    }\r\n    \r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Get weather description from weather code\r\n * @param {number} code - WMO weather code\r\n * @returns {string} Weather description\r\n */\r\nexport const getWeatherDescription = (code) => {\r\n  const weatherCodes = {\r\n    0: 'Clear sky',\r\n    1: 'Mainly clear',\r\n    2: 'Partly cloudy',\r\n    3: 'Overcast',\r\n    45: 'Fog',\r\n    48: 'Depositing rime fog',\r\n    51: 'Light drizzle',\r\n    53: 'Moderate drizzle',\r\n    55: 'Dense drizzle',\r\n    56: 'Light freezing drizzle',\r\n    57: 'Dense freezing drizzle',\r\n    61: 'Slight rain',\r\n    63: 'Moderate rain',\r\n    65: 'Heavy rain',\r\n    66: 'Light freezing rain',\r\n    67: 'Heavy freezing rain',\r\n    71: 'Slight snow fall',\r\n    73: 'Moderate snow fall',\r\n    75: 'Heavy snow fall',\r\n    77: 'Snow grains',\r\n    80: 'Slight rain showers',\r\n    81: 'Moderate rain showers',\r\n    82: 'Violent rain showers',\r\n    85: 'Slight snow showers',\r\n    86: 'Heavy snow showers',\r\n    95: 'Thunderstorm',\r\n    96: 'Thunderstorm with slight hail',\r\n    99: 'Thunderstorm with heavy hail'\r\n  };\r\n  \r\n  return weatherCodes[code] || 'Unknown';\r\n};\r\n\r\n/**\r\n * Get weather icon based on weather code and day/night\r\n * @param {number} code - WMO weather code\r\n * @param {boolean} isDay - Whether it's daytime\r\n * @returns {string} Weather icon (emoji)\r\n */\r\nexport const getWeatherIcon = (code, isDay = true) => {\r\n  // Map weather codes to emojis\r\n  if (code === 0) return isDay ? '' : ''; // Clear\r\n  if (code === 1) return isDay ? '' : ''; // Mainly clear\r\n  if (code === 2) return isDay ? '' : ''; // Partly cloudy\r\n  if (code === 3) return ''; // Overcast\r\n  if (code >= 45 && code <= 48) return ''; // Fog\r\n  if (code >= 51 && code <= 57) return ''; // Drizzle\r\n  if (code >= 61 && code <= 67) return ''; // Rain\r\n  if (code >= 71 && code <= 77) return ''; // Snow\r\n  if (code >= 80 && code <= 82) return ''; // Rain showers\r\n  if (code >= 85 && code <= 86) return ''; // Snow showers\r\n  if (code >= 95) return ''; // Thunderstorm\r\n  \r\n  return isDay ? '' : ''; // Default\r\n};\r\n\r\n/**\r\n * Analyze historical weather and mood data to find patterns\r\n * @param {Array} moodEntries - User's mood entries\r\n * @param {Array} weatherData - Historical weather data\r\n * @returns {Object} Analysis of weather-mood relationships\r\n */\r\nexport const analyzeWeatherMoodPatterns = (moodEntries, weatherData) => {\r\n  // If we don't have enough data, return null\r\n  if (!moodEntries || moodEntries.length < 3) {\r\n    return {\r\n      hasEnoughData: false,\r\n      message: \"We need more mood entries to analyze weather patterns. Keep logging your moods!\"\r\n    };\r\n  }\r\n\r\n  // Group mood entries by weather conditions\r\n  const weatherMoodGroups = {\r\n    sunny: { entries: [], avgMood: 0 },\r\n    cloudy: { entries: [], avgMood: 0 },\r\n    rainy: { entries: [], avgMood: 0 },\r\n    snowy: { entries: [], avgMood: 0 }\r\n  };\r\n  \r\n  // Process entries to group by weather\r\n  moodEntries.forEach(entry => {\r\n    if (!entry.weather) return;\r\n    \r\n    const weatherCode = entry.weather.weatherCode;\r\n    \r\n    if (weatherCode === 0 || weatherCode === 1) {\r\n      weatherMoodGroups.sunny.entries.push(entry);\r\n    } else if (weatherCode === 2 || weatherCode === 3) {\r\n      weatherMoodGroups.cloudy.entries.push(entry);\r\n    } else if ((weatherCode >= 51 && weatherCode <= 67) || \r\n              (weatherCode >= 80 && weatherCode <= 82)) {\r\n      weatherMoodGroups.rainy.entries.push(entry);\r\n    } else if ((weatherCode >= 71 && weatherCode <= 77) || \r\n              (weatherCode >= 85 && weatherCode <= 86)) {\r\n      weatherMoodGroups.snowy.entries.push(entry);\r\n    }\r\n  });\r\n  \r\n  // Calculate averages for each weather type\r\n  Object.keys(weatherMoodGroups).forEach(weatherType => {\r\n    const group = weatherMoodGroups[weatherType];\r\n    if (group.entries.length > 0) {\r\n      const sum = group.entries.reduce((acc, entry) => acc + entry.moodValue, 0);\r\n      group.avgMood = parseFloat((sum / group.entries.length).toFixed(1));\r\n      group.count = group.entries.length;\r\n    }\r\n  });\r\n\r\n  // Generate insights\r\n  const insights = [];\r\n  \r\n  // Find best weather for mood\r\n  let bestWeather = null;\r\n  let highestMood = 0;\r\n  \r\n  // Find worst weather for mood\r\n  let worstWeather = null;\r\n  let lowestMood = 11;\r\n  \r\n  Object.keys(weatherMoodGroups).forEach(weatherType => {\r\n    const group = weatherMoodGroups[weatherType];\r\n    if (group.entries.length >= 2) { // Only if we have enough data\r\n      if (group.avgMood > highestMood) {\r\n        highestMood = group.avgMood;\r\n        bestWeather = weatherType;\r\n      }\r\n      \r\n      if (group.avgMood < lowestMood) {\r\n        lowestMood = group.avgMood;\r\n        worstWeather = weatherType;\r\n      }\r\n    }\r\n  });\r\n  \r\n  if (bestWeather) {\r\n    insights.push({\r\n      type: 'positive',\r\n      text: `You tend to feel better on ${bestWeather} days (average mood: ${highestMood}/10).`\r\n    });\r\n  }\r\n  \r\n  if (worstWeather && worstWeather !== bestWeather) {\r\n    insights.push({\r\n      type: 'negative',\r\n      text: `You tend to feel lower on ${worstWeather} days (average mood: ${lowestMood}/10).`\r\n    });\r\n  }\r\n  \r\n  // Check for substantial differences\r\n  if (bestWeather && worstWeather && bestWeather !== worstWeather) {\r\n    const difference = highestMood - lowestMood;\r\n    if (difference >= 2) {\r\n      insights.push({\r\n        type: 'significant',\r\n        text: `Weather seems to have a significant impact on your mood (${difference.toFixed(1)} points difference).`\r\n      });\r\n    }\r\n  }\r\n  \r\n  return {\r\n    hasEnoughData: true,\r\n    weatherMoodGroups,\r\n    insights,\r\n    bestWeather,\r\n    worstWeather\r\n  };\r\n};","/**\r\n * Service to fetch color palettes from Colormind.io based on mood\r\n */\r\n\r\nconst COLORMIND_API = 'http://colormind.io/api/';\r\n\r\n/**\r\n * Get a color palette based on mood\r\n * @param {string} mood - The mood description (happy, sad, calm, etc)\r\n * @returns {Promise<Array>} Array of RGB colors\r\n */\r\nexport const getMoodColorPalette = async (mood) => {\r\n  // Skip API calls entirely and use default palettes\r\n  return getDefaultPalette(mood);\r\n};\r\n\r\n/**\r\n * Get a fallback color palette based on mood\r\n * @param {string} mood - The mood description\r\n * @returns {Array} Array of RGB colors\r\n */\r\nconst getDefaultPalette = (mood) => {\r\n  // Enhanced color palettes with harmonious combinations for each emotion\r\n  // Each palette is carefully designed for both aesthetic appeal and emotional resonance\r\n  const defaultPalettes = {\r\n    happy: [\r\n      [255, 195, 0],   // Primary: Bright yellow\r\n      [255, 153, 51],  // Secondary: Warm orange\r\n      [255, 87, 51],   // Accent: Coral\r\n      [255, 253, 230], // Background: Cream\r\n      [35, 35, 35]     // Text: Dark gray\r\n    ],\r\n    excited: [\r\n      [255, 89, 94],   // Primary: Coral red\r\n      [255, 130, 67],  // Secondary: Bright orange\r\n      [255, 45, 85],   // Accent: Hot pink\r\n      [255, 245, 245], // Background: Light cream\r\n      [40, 40, 40]     // Text: Near black\r\n    ],\r\n    calm: [\r\n      [86, 161, 200],  // Primary: Sky blue\r\n      [121, 189, 154], // Secondary: Seafoam\r\n      [71, 150, 237],  // Accent: Bright blue\r\n      [240, 248, 255], // Background: Alice blue\r\n      [45, 55, 72]     // Text: Blue-gray\r\n    ],\r\n    relaxed: [\r\n      [106, 177, 135], // Primary: Soft green\r\n      [132, 197, 175], // Secondary: Mint\r\n      [65, 176, 131],  // Accent: Emerald\r\n      [242, 250, 242], // Background: Off-white\r\n      [50, 72, 62]     // Text: Deep green-gray\r\n    ],\r\n    neutral: [\r\n      [190, 190, 190], // Primary: Medium gray\r\n      [160, 160, 170], // Secondary: Blue-gray\r\n      [130, 150, 170], // Accent: Slate\r\n      [246, 246, 246], // Background: Off-white\r\n      [60, 60, 60]     // Text: Dark gray\r\n    ],\r\n    sad: [\r\n      [108, 117, 187], // Primary: Muted blue\r\n      [143, 158, 191], // Secondary: Periwinkle\r\n      [95, 110, 175],  // Accent: Deeper blue\r\n      [240, 245, 250], // Background: Pale blue\r\n      [45, 50, 80]     // Text: Navy blue\r\n    ],\r\n    stressed: [\r\n      [242, 103, 34],  // Primary: Burnt orange\r\n      [236, 139, 94],  // Secondary: Soft orange\r\n      [255, 76, 5],    // Accent: Bright orange\r\n      [252, 247, 240], // Background: Cream\r\n      [60, 36, 21]     // Text: Dark brown\r\n    ],\r\n    angry: [\r\n      [201, 42, 42],   // Primary: Deep red\r\n      [220, 73, 58],   // Secondary: Brick red\r\n      [230, 46, 0],    // Accent: Fiery orange-red\r\n      [253, 241, 240], // Background: Light pink\r\n      [70, 28, 28]     // Text: Dark maroon\r\n    ],\r\n    anxious: [\r\n      [255, 177, 0],   // Primary: Amber\r\n      [255, 201, 71],  // Secondary: Muted gold\r\n      [255, 145, 0],   // Accent: Orange\r\n      [254, 250, 235], // Background: Light cream\r\n      [66, 54, 30]     // Text: Dark brown\r\n    ],\r\n    tired: [\r\n      [147, 112, 170], // Primary: Lavender\r\n      [170, 142, 190], // Secondary: Light purple\r\n      [120, 90, 140],  // Accent: Deep purple\r\n      [246, 243, 248], // Background: Pale lavender\r\n      [60, 45, 70]     // Text: Dark purple\r\n    ],\r\n    grateful: [\r\n      [41, 166, 126],  // Primary: Emerald\r\n      [92, 190, 143],  // Secondary: Light green\r\n      [39, 143, 108],  // Accent: Deep green\r\n      [240, 250, 244], // Background: Pale mint\r\n      [40, 70, 55]     // Text: Forest green\r\n    ]\r\n  };\r\n  \r\n  // Return default palette based on mood, or neutral if mood not found\r\n  return defaultPalettes[mood] || defaultPalettes.neutral;\r\n};\r\n\r\n/**\r\n * Convert RGB array to CSS hex color\r\n * @param {Array} rgb - [r, g, b] array\r\n * @returns {string} Hex color string (#RRGGBB)\r\n */\r\nexport const rgbToHex = (rgb) => {\r\n  return '#' + rgb.map(x => {\r\n    const hex = x.toString(16);\r\n    return hex.length === 1 ? '0' + hex : hex;\r\n  }).join('');\r\n};\r\n\r\n/**\r\n * Convert RGB array to CSS rgba string\r\n * @param {Array} rgb - [r, g, b] array\r\n * @param {number} alpha - Alpha transparency (0-1)\r\n * @returns {string} RGBA color string\r\n */\r\nexport const rgbToRgba = (rgb, alpha = 1) => {\r\n  return `rgba(${rgb[0]}, ${rgb[1]}, ${rgb[2]}, ${alpha})`;\r\n};\r\n\r\n/**\r\n * Extract text color (white/black) that contrasts with background\r\n * @param {Array} rgb - Background color as [r, g, b] array\r\n * @returns {string} '#ffffff' for dark backgrounds or '#333333' for light backgrounds\r\n */\r\nexport const getContrastColor = (rgb) => {\r\n  // Calculate perceived brightness using weighted RGB (YIQ formula)\r\n  // This formula accounts for human perception of color brightness\r\n  const brightness = (rgb[0] * 299 + rgb[1] * 587 + rgb[2] * 114) / 1000;\r\n  return brightness > 128 ? '#333333' : '#ffffff';\r\n};\r\n\r\n/**\r\n * Creates a full theme object from a color palette\r\n * @param {Array} palette - Array of RGB colors from Colormind\r\n * @returns {Object} Theme object with CSS variables\r\n */\r\nexport const createThemeFromPalette = (palette) => {\r\n  if (!palette || !Array.isArray(palette) || palette.length < 5) {\r\n    console.error('Invalid palette provided to createThemeFromPalette', palette);\r\n    return null;\r\n  }\r\n  \r\n  // Extract colors from palette\r\n  const [primary, secondary, accent, background, text] = palette;\r\n  \r\n  // Determine contrasting text colors\r\n  const onPrimary = getContrastColor(primary);\r\n  const onSecondary = getContrastColor(secondary);\r\n  const onAccent = getContrastColor(accent);\r\n  const onBackground = getContrastColor(background);\r\n  \r\n  // Create lighter and darker variants of primary color\r\n  const primaryLight = primary.map(c => Math.min(255, Math.round(c * 1.2)));\r\n  const primaryDark = primary.map(c => Math.round(c * 0.8));\r\n  \r\n  // Create lighter and darker variants of secondary color for more versatility\r\n  const secondaryLight = secondary.map(c => Math.min(255, Math.round(c * 1.15)));\r\n  const secondaryDark = secondary.map(c => Math.round(c * 0.85));\r\n  \r\n  // Create accent variations\r\n  const accentLight = accent.map(c => Math.min(255, Math.round(c * 1.1)));\r\n  const accentDark = accent.map(c => Math.round(c * 0.9));\r\n  \r\n  // Create a semi-transparent version of the primary color for overlays\r\n  const primaryTransparent = rgbToRgba(primary, 0.15);\r\n  \r\n  // Create a darker background for cards and panels\r\n  const backgroundDark = background.map(c => Math.max(0, Math.round(c * 0.97)));\r\n  \r\n  return {\r\n    '--primary-color': rgbToHex(primary),\r\n    '--primary-color-light': rgbToHex(primaryLight),\r\n    '--primary-color-dark': rgbToHex(primaryDark),\r\n    '--primary-transparent': primaryTransparent,\r\n    \r\n    '--secondary-color': rgbToHex(secondary),\r\n    '--secondary-color-light': rgbToHex(secondaryLight),\r\n    '--secondary-color-dark': rgbToHex(secondaryDark),\r\n    \r\n    '--accent-color': rgbToHex(accent),\r\n    '--accent-color-light': rgbToHex(accentLight),\r\n    '--accent-color-dark': rgbToHex(accentDark),\r\n    \r\n    '--background-light': rgbToHex(background),\r\n    '--background-dark': rgbToHex(backgroundDark),\r\n    '--background-white': '#ffffff',\r\n    \r\n    '--text-primary': rgbToHex(text),\r\n    '--text-secondary': onBackground === '#ffffff' ? '#dddddd' : '#666666',\r\n    '--text-light': rgbToRgba(text, 0.7),\r\n    \r\n    '--text-on-primary': onPrimary,\r\n    '--text-on-secondary': onSecondary,\r\n    '--text-on-accent': onAccent,\r\n    \r\n    '--shadow-color': rgbToRgba(text, 0.1),\r\n    '--card-border-color': rgbToRgba(primary, 0.3)\r\n  };\r\n};\r\n\r\n/**\r\n * Generate complementary colors for decorative elements\r\n * @param {Array} rgb - Base RGB color\r\n * @returns {string} Hex color string\r\n */\r\nexport const getComplementaryColor = (rgb) => {\r\n  // Create a complementary color by inverting the RGB values\r\n  return rgbToHex([\r\n    255 - rgb[0],\r\n    255 - rgb[1],\r\n    255 - rgb[2]\r\n  ]);\r\n};","import React, { useState, useEffect, createContext, useContext } from 'react';\r\nimport { getMoodColorPalette, createThemeFromPalette, rgbToHex } from '../services/colorService';\r\nimport { getMoodEntries } from '../services/storageService';\r\nimport './ThemeManager.css';\r\n\r\n// Create theme context\r\nconst ThemeContext = createContext();\r\n\r\n// Hook for components to access theme\r\nexport const useTheme = () => useContext(ThemeContext);\r\n\r\nexport const ThemeProvider = ({ children }) => {\r\n  const [currentTheme, setCurrentTheme] = useState('auto');\r\n  const [customTheme, setCustomTheme] = useState(null);\r\n  const [showPicker, setShowPicker] = useState(false);\r\n  const [isApplying, setIsApplying] = useState(false);\r\n  const [currentMood, setCurrentMood] = useState(null);\r\n  \r\n  // Apply theme when it changes\r\n  useEffect(() => {\r\n    let isMounted = true;\r\n    \r\n    const applyTheme = async () => {\r\n      setIsApplying(true);\r\n      try {\r\n        let themeVars;\r\n        let appliedMood = null;\r\n        \r\n        // Check what type of theme we're using\r\n        if (currentTheme === 'auto') {\r\n          // Get the last recorded mood\r\n          const lastMoodEntry = await getLastMoodEntry();\r\n          if (lastMoodEntry && lastMoodEntry.moodValue) {\r\n            themeVars = await getAndApplyMoodTheme(lastMoodEntry.moodValue);\r\n            appliedMood = getMoodName(lastMoodEntry.moodValue);\r\n          } else {\r\n            // Use default if no mood entry\r\n            themeVars = await getAndApplyMoodTheme('neutral');\r\n            appliedMood = 'neutral';\r\n          }\r\n        } else if (currentTheme === 'custom' && customTheme) {\r\n          // Apply custom theme\r\n          applyThemeVariables(customTheme);\r\n          themeVars = customTheme;\r\n        } else {\r\n          // Apply preset theme\r\n          themeVars = await getAndApplyMoodTheme(currentTheme);\r\n          appliedMood = currentTheme;\r\n        }\r\n        \r\n        setCurrentMood(appliedMood);\r\n        \r\n        // Save the theme preference and current mood to localStorage\r\n        localStorage.setItem('themePreference', currentTheme);\r\n        localStorage.setItem('currentMood', appliedMood || '');\r\n        \r\n        if (customTheme) {\r\n          localStorage.setItem('customTheme', JSON.stringify(customTheme));\r\n        }\r\n        \r\n        // Save applied theme variables to ensure they persist on refresh\r\n        localStorage.setItem('appliedThemeVars', JSON.stringify(themeVars));\r\n      } catch (error) {\r\n        console.error(\"Failed to apply theme:\", error);\r\n      } finally {\r\n        if (isMounted) {\r\n          setIsApplying(false);\r\n        }\r\n      }\r\n    };\r\n    \r\n    applyTheme();\r\n    \r\n    // Cleanup function\r\n    return () => {\r\n      isMounted = false;\r\n    };\r\n  }, [currentTheme, customTheme]);\r\n  \r\n  // Load saved theme preference and applied theme on first render\r\n  useEffect(() => {\r\n    const loadSavedTheme = async () => {\r\n      try {\r\n        // Get saved theme preference\r\n        const savedTheme = localStorage.getItem('themePreference') || 'auto';\r\n        setCurrentTheme(savedTheme);\r\n        \r\n        // Get saved mood\r\n        const savedMood = localStorage.getItem('currentMood');\r\n        if (savedMood) {\r\n          setCurrentMood(savedMood);\r\n        }\r\n        \r\n        // Get saved custom theme\r\n        const savedCustomTheme = localStorage.getItem('customTheme');\r\n        if (savedCustomTheme) {\r\n          try {\r\n            const parsedTheme = JSON.parse(savedCustomTheme);\r\n            setCustomTheme(parsedTheme);\r\n          } catch (e) {\r\n            console.error(\"Couldn't parse saved custom theme\", e);\r\n          }\r\n        }\r\n        \r\n        // Apply saved theme variables immediately for fast loading\r\n        const savedThemeVars = localStorage.getItem('appliedThemeVars');\r\n        if (savedThemeVars) {\r\n          try {\r\n            const parsedVars = JSON.parse(savedThemeVars);\r\n            applyThemeVariables(parsedVars);\r\n          } catch (e) {\r\n            console.error(\"Couldn't apply saved theme variables\", e);\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Error loading saved theme:\", error);\r\n      }\r\n    };\r\n    \r\n    loadSavedTheme();\r\n  }, []);\r\n  \r\n  // Get last mood entry from storage\r\n  const getLastMoodEntry = async () => {\r\n    try {\r\n      const entries = await getMoodEntries();\r\n      if (!entries || entries.length === 0) return null;\r\n      \r\n      // Sort entries by date (newest first)\r\n      entries.sort((a, b) => new Date(b.date) - new Date(a.date));\r\n      return entries[0];\r\n    } catch (error) {\r\n      console.error('Error getting last mood entry:', error);\r\n      return null; // Return null as fallback\r\n    }\r\n  };\r\n  \r\n  const getMoodName = (moodValue) => {\r\n    if (moodValue <= 2) return 'sad';\r\n    if (moodValue === 3) return 'anxious';\r\n    if (moodValue === 4) return 'stressed';\r\n    if (moodValue === 5) return 'neutral';\r\n    if (moodValue === 6) return 'tired';\r\n    if (moodValue === 7) return 'calm';\r\n    if (moodValue === 8) return 'relaxed';\r\n    if (moodValue === 9) return 'happy';\r\n    return 'excited';\r\n  };\r\n  \r\n  // Apply theme based on mood\r\n  const getAndApplyMoodTheme = async (mood) => {\r\n    try {\r\n      const palette = await getMoodColorPalette(mood);\r\n      const themeVars = createThemeFromPalette(palette);\r\n      applyThemeVariables(themeVars);\r\n      return themeVars;\r\n    } catch (error) {\r\n      console.error(\"Error applying mood theme:\", error);\r\n      throw error;\r\n    }\r\n  };\r\n  \r\n  // Apply CSS variables to root\r\n  const applyThemeVariables = (variables) => {\r\n    const root = document.documentElement;\r\n    Object.entries(variables).forEach(([key, value]) => {\r\n      root.style.setProperty(key, value);\r\n    });\r\n  };\r\n  \r\n  // Handle theme change\r\n  const changeTheme = (theme) => {\r\n    setCurrentTheme(theme);\r\n    setShowPicker(false);\r\n  };\r\n  \r\n  // Generate theme from specific mood\r\n  const generateThemeFromMood = async (mood) => {\r\n    setIsApplying(true);\r\n    try {\r\n      const themeVars = await getAndApplyMoodTheme(mood);\r\n      \r\n      // When generating a theme from mood, set it as custom theme\r\n      setCustomTheme(themeVars);\r\n      setCurrentTheme('custom');\r\n      setCurrentMood(mood);\r\n      \r\n      // Save the generated theme\r\n      localStorage.setItem('customTheme', JSON.stringify(themeVars));\r\n      localStorage.setItem('themePreference', 'custom');\r\n      localStorage.setItem('currentMood', mood);\r\n      localStorage.setItem('appliedThemeVars', JSON.stringify(themeVars));\r\n      \r\n      return themeVars;\r\n    } catch (error) {\r\n      console.error(\"Failed to generate theme from mood:\", error);\r\n      return null;\r\n    } finally {\r\n      setIsApplying(false);\r\n    }\r\n  };\r\n  \r\n  // Context value\r\n  const themeContextValue = {\r\n    currentTheme,\r\n    currentMood,\r\n    changeTheme,\r\n    generateThemeFromMood,\r\n    isApplying\r\n  };\r\n  \r\n  return (\r\n    <ThemeContext.Provider value={themeContextValue}>\r\n      <div className=\"theme-manager-container\">\r\n        {children}\r\n        \r\n        <button \r\n          className=\"theme-picker-button\"\r\n          onClick={() => setShowPicker(!showPicker)}\r\n          aria-label=\"Change theme\"\r\n        >\r\n          <span className=\"theme-icon\"></span>\r\n        </button>\r\n        \r\n        {showPicker && (\r\n          <div className=\"theme-picker\">\r\n            <h3>Color Theme</h3>\r\n            <div className=\"theme-options\">\r\n              <button \r\n                className={`theme-option ${currentTheme === 'auto' ? 'active' : ''}`}\r\n                onClick={() => changeTheme('auto')}\r\n              >\r\n                <div className=\"theme-preview auto\"></div>\r\n                <span className=\"theme-label\">Match Mood</span>\r\n              </button>\r\n              <button \r\n                className={`theme-option ${currentTheme === 'happy' ? 'active' : ''}`}\r\n                onClick={() => changeTheme('happy')}\r\n              >\r\n                <div className=\"theme-preview happy\"></div>\r\n                <span className=\"theme-label\">Happy</span>\r\n              </button>\r\n              <button \r\n                className={`theme-option ${currentTheme === 'calm' ? 'active' : ''}`}\r\n                onClick={() => changeTheme('calm')}\r\n              >\r\n                <div className=\"theme-preview calm\"></div>\r\n                <span className=\"theme-label\">Calm</span>\r\n              </button>\r\n              <button \r\n                className={`theme-option ${currentTheme === 'neutral' ? 'active' : ''}`}\r\n                onClick={() => changeTheme('neutral')}\r\n              >\r\n                <div className=\"theme-preview neutral\"></div>\r\n                <span className=\"theme-label\">Neutral</span>\r\n              </button>\r\n            </div>\r\n            \r\n            <div className=\"generate-theme\">\r\n              <h4>Generate Theme from Emotion</h4>\r\n              <div className=\"mood-buttons\">\r\n                <button \r\n                  onClick={() => generateThemeFromMood('excited')}\r\n                  disabled={isApplying}\r\n                  className=\"mood-excited\"\r\n                >\r\n                  Excited \r\n                </button>\r\n                <button \r\n                  onClick={() => generateThemeFromMood('happy')}\r\n                  disabled={isApplying}\r\n                  className=\"mood-happy\"\r\n                >\r\n                  Happy \r\n                </button>\r\n                <button \r\n                  onClick={() => generateThemeFromMood('calm')}\r\n                  disabled={isApplying}\r\n                  className=\"mood-calm\"\r\n                >\r\n                  Calm \r\n                </button>\r\n                <button \r\n                  onClick={() => generateThemeFromMood('relaxed')}\r\n                  disabled={isApplying}\r\n                  className=\"mood-relaxed\"\r\n                >\r\n                  Relaxed \r\n                </button>\r\n                <button \r\n                  onClick={() => generateThemeFromMood('neutral')}\r\n                  disabled={isApplying}\r\n                  className=\"mood-neutral\"\r\n                >\r\n                  Neutral \r\n                </button>\r\n                <button \r\n                  onClick={() => generateThemeFromMood('sad')}\r\n                  disabled={isApplying}\r\n                  className=\"mood-sad\"\r\n                >\r\n                  Sad \r\n                </button>\r\n                <button \r\n                  onClick={() => generateThemeFromMood('anxious')}\r\n                  disabled={isApplying}\r\n                  className=\"mood-anxious\"\r\n                >\r\n                  Anxious \r\n                </button>\r\n                <button \r\n                  onClick={() => generateThemeFromMood('tired')}\r\n                  disabled={isApplying}\r\n                  className=\"mood-tired\"\r\n                >\r\n                  Tired \r\n                </button>\r\n              </div>\r\n            </div>\r\n            \r\n            {currentMood && (\r\n              <div style={{marginTop: '15px', textAlign: 'center', fontSize: '0.9rem', opacity: 0.7}}>\r\n                Current mood theme: <strong>{currentMood}</strong>\r\n              </div>\r\n            )}\r\n            \r\n            {isApplying && (\r\n              <div className=\"theme-applying\">\r\n                <div className=\"theme-spinner\"></div>\r\n                <span>Applying theme...</span>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </ThemeContext.Provider>\r\n  );\r\n};","import React, { useState, useEffect } from 'react';\r\nimport { saveJournalEntry } from '../services/storageService';\r\nimport { getUserLocation, fetchCurrentWeather } from '../services/weatherService';\r\nimport './JournalEntry.css';\r\nimport { useTheme } from './ThemeManager';\r\n\r\nconst JournalEntry = () => {\r\n    const [entry, setEntry] = useState({\r\n        mood: '',\r\n        moodValue: 5,\r\n        thoughts: '',\r\n        activities: [],\r\n        gratitude: '',\r\n        weather: null\r\n    });\r\n    const [showSuccess, setShowSuccess] = useState(false);\r\n    const [loadingWeather, setLoadingWeather] = useState(true);\r\n    const [weatherError, setWeatherError] = useState(null);\r\n    \r\n    // Add the theme context\r\n    const { generateThemeFromMood, currentTheme } = useTheme();\r\n\r\n    // Fetch weather data when component mounts\r\n    useEffect(() => {\r\n        let isMounted = true;\r\n\r\n        const getWeatherData = async () => {\r\n            setLoadingWeather(true);\r\n            try {\r\n                const location = await getUserLocation();\r\n                const weatherData = await fetchCurrentWeather(location.latitude, location.longitude);\r\n                \r\n                if (isMounted) {\r\n                    if (weatherData && weatherData.current) {\r\n                        setEntry(prev => ({\r\n                            ...prev,\r\n                            weather: {\r\n                                temperature: weatherData.current.temperature_2m,\r\n                                weatherCode: weatherData.current.weather_code,\r\n                                humidity: weatherData.current.relative_humidity_2m,\r\n                                isDay: weatherData.current.is_day === 1\r\n                            }\r\n                        }));\r\n                    }\r\n                    setLoadingWeather(false);\r\n                }\r\n            } catch (error) {\r\n                if (isMounted) {\r\n                    console.error('Failed to load weather:', error);\r\n                    setWeatherError(\"Couldn't fetch weather data\");\r\n                    setLoadingWeather(false);\r\n                }\r\n            }\r\n        };\r\n        \r\n        getWeatherData();\r\n        \r\n        return () => {\r\n            isMounted = false;\r\n        };\r\n    }, []);\r\n\r\n    const handleInputChange = (e) => {\r\n        const { name, value } = e.target;\r\n        setEntry({\r\n            ...entry,\r\n            [name]: value\r\n        });\r\n    };\r\n\r\n    // Update the handleMoodSlider function in the JournalEntry component\r\n    const handleMoodSlider = (e) => {\r\n        const newMoodValue = parseInt(e.target.value);\r\n        setEntry({\r\n            ...entry,\r\n            moodValue: newMoodValue\r\n        });\r\n        \r\n        // Always update theme when mood slider changes for immediate visual feedback\r\n        generateThemeFromMood(newMoodValue);\r\n        \r\n        // Also add mood text based on value\r\n        const moodTexts = {\r\n            1: 'Very sad',\r\n            2: 'Sad',\r\n            3: 'Anxious',\r\n            4: 'Stressed',\r\n            5: 'Neutral',\r\n            6: 'Content',\r\n            7: 'Calm',\r\n            8: 'Happy',\r\n            9: 'Very happy',\r\n            10: 'Excited'\r\n        };\r\n        \r\n        // Auto-suggest mood text but don't overwrite if user has entered their own\r\n        if (!entry.mood || entry.mood === getMoodLabel(entry.moodValue - 1)) {\r\n            setEntry(prev => ({\r\n                ...prev,\r\n                mood: moodTexts[newMoodValue] || ''\r\n            }));\r\n        }\r\n    };\r\n\r\n    const handleActivityToggle = (activity) => {\r\n        const updatedActivities = [...entry.activities];\r\n        \r\n        if (updatedActivities.includes(activity)) {\r\n            const index = updatedActivities.indexOf(activity);\r\n            updatedActivities.splice(index, 1);\r\n        } else {\r\n            updatedActivities.push(activity);\r\n        }\r\n        \r\n        setEntry({\r\n            ...entry,\r\n            activities: updatedActivities\r\n        });\r\n    };\r\n\r\n    const getMoodEmoji = (value) => {\r\n        const emojis = ['', '', '', '', '', '', '', '', '', ''];\r\n        return emojis[value - 1] || '';\r\n    };\r\n\r\n    const getMoodLabel = (value) => {\r\n        const labels = [\r\n            'Very sad', 'Sad', 'Down', 'Neutral', 'Okay', \r\n            'Good', 'Happy', 'Very happy', 'Excellent', 'Amazing'\r\n        ];\r\n        return labels[value - 1] || 'Neutral';\r\n    };\r\n\r\n    const getWeatherIcon = (weatherCode, isDay) => {\r\n        if (weatherCode === 0) return isDay ? '' : '';\r\n        if (weatherCode === 1) return isDay ? '' : '';\r\n        if (weatherCode === 2) return isDay ? '' : '';\r\n        if (weatherCode === 3) return '';\r\n        if (weatherCode >= 45 && weatherCode <= 48) return '';\r\n        if (weatherCode >= 51 && weatherCode <= 57) return '';\r\n        if (weatherCode >= 61 && weatherCode <= 67) return '';\r\n        if (weatherCode >= 71 && weatherCode <= 77) return '';\r\n        if (weatherCode >= 80 && weatherCode <= 82) return '';\r\n        if (weatherCode >= 85 && weatherCode <= 86) return '';\r\n        if (weatherCode >= 95) return '';\r\n        \r\n        return isDay ? '' : '';\r\n    };\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        const newEntry = {\r\n            ...entry,\r\n            date: new Date().toISOString()\r\n        };\r\n        \r\n        try {\r\n            await saveJournalEntry(newEntry);\r\n            setShowSuccess(true);\r\n            setTimeout(() => setShowSuccess(false), 3000);\r\n            \r\n            setEntry({\r\n                mood: '',\r\n                moodValue: 5,\r\n                thoughts: '',\r\n                activities: [],\r\n                gratitude: '',\r\n                weather: entry.weather\r\n            });\r\n        } catch (error) {\r\n            console.error('Failed to save entry:', error);\r\n        }\r\n    };\r\n\r\n    const activities = [\r\n        'Exercise', 'Reading', 'Meditation', 'Family time', \r\n        'Friends', 'Work', 'Hobby', 'Nature'\r\n    ];\r\n\r\n    return (\r\n        <div className=\"journal-entry\">\r\n            <h2>Daily Journal Entry</h2>\r\n            \r\n            {/* Add a theme indicator */}\r\n            <div className=\"theme-status\">\r\n                <small>UI color theme will update based on your mood</small>\r\n            </div>\r\n            \r\n            <form onSubmit={handleSubmit}>\r\n                <div className=\"weather-info\">\r\n                    {loadingWeather ? (\r\n                        <div className=\"weather-loading-mini\">Loading weather...</div>\r\n                    ) : weatherError ? (\r\n                        <div className=\"weather-error-mini\">{weatherError}</div>\r\n                    ) : entry.weather ? (\r\n                        <div className=\"current-weather-mini\">\r\n                            <span className=\"weather-icon-mini\">\r\n                                {getWeatherIcon(entry.weather.weatherCode, entry.weather.isDay)}\r\n                            </span>\r\n                            <span className=\"weather-temp-mini\">\r\n                                {Math.round(entry.weather.temperature)}C\r\n                            </span>\r\n                            <span className=\"weather-note\">\r\n                                Weather is being recorded with your entry\r\n                            </span>\r\n                        </div>\r\n                    ) : null}\r\n                </div>\r\n\r\n                <div className=\"mood-selector\">\r\n                    <h3>How are you feeling today?</h3>\r\n                    \r\n                    <div className=\"mood-slider-container\">\r\n                        <input \r\n                            type=\"range\" \r\n                            min=\"1\" \r\n                            max=\"10\" \r\n                            value={entry.moodValue} \r\n                            onChange={handleMoodSlider}\r\n                            className=\"mood-slider\"\r\n                        />\r\n                        <div className=\"mood-emoji\">{getMoodEmoji(entry.moodValue)}</div>\r\n                        <div className=\"mood-label\">{getMoodLabel(entry.moodValue)}</div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"form-group\">\r\n                    <label htmlFor=\"mood\">In one word, describe your mood:</label>\r\n                    <input\r\n                        type=\"text\"\r\n                        id=\"mood\"\r\n                        name=\"mood\"\r\n                        value={entry.mood}\r\n                        onChange={handleInputChange}\r\n                        placeholder=\"e.g. Peaceful, Anxious, Excited...\"\r\n                    />\r\n                </div>\r\n                \r\n                <div className=\"form-group\">\r\n                    <label htmlFor=\"thoughts\">What's on your mind today?</label>\r\n                    <textarea\r\n                        id=\"thoughts\"\r\n                        name=\"thoughts\"\r\n                        value={entry.thoughts}\r\n                        onChange={handleInputChange}\r\n                        placeholder=\"Share your thoughts, feelings, or experiences...\"\r\n                        rows=\"5\"\r\n                    />\r\n                </div>\r\n\r\n                <div className=\"form-group\">\r\n                    <label>Activities today: (select all that apply)</label>\r\n                    <div className=\"activity-tags\">\r\n                        {activities.map(activity => (\r\n                            <div \r\n                                key={activity}\r\n                                className={`activity-tag ${entry.activities.includes(activity) ? 'selected' : ''}`}\r\n                                onClick={() => handleActivityToggle(activity)}\r\n                            >\r\n                                {activity}\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"form-group\">\r\n                    <label htmlFor=\"gratitude\">What are you grateful for today?</label>\r\n                    <textarea\r\n                        id=\"gratitude\"\r\n                        name=\"gratitude\"\r\n                        value={entry.gratitude}\r\n                        onChange={handleInputChange}\r\n                        placeholder=\"List one or more things you appreciate today...\"\r\n                        rows=\"3\"\r\n                    />\r\n                </div>\r\n\r\n                <button type=\"submit\" className=\"submit-button\">\r\n                    Save Entry\r\n                </button>\r\n                \r\n                {showSuccess && (\r\n                    <div className=\"success-message\">\r\n                        <span> Journal entry saved successfully!</span>\r\n                    </div>\r\n                )}\r\n            </form>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default JournalEntry;","import React, { useState, useEffect } from 'react';\r\nimport { getMoodEntries } from '../services/storageService';\r\nimport './JournalLog.css';\r\n\r\nconst JournalLog = () => {\r\n    const [entries, setEntries] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [filter, setFilter] = useState('all'); // all, week, month\r\n    const [selectedEntry, setSelectedEntry] = useState(null);\r\n    const [searchTerm, setSearchTerm] = useState('');\r\n\r\n    useEffect(() => {\r\n        const fetchEntries = async () => {\r\n            try {\r\n                const data = await getMoodEntries();\r\n                // Sort by date, newest first\r\n                const sortedData = data.sort((a, b) => \r\n                    new Date(b.date) - new Date(a.date)\r\n                );\r\n                setEntries(sortedData);\r\n            } catch (error) {\r\n                console.error(\"Error fetching journal entries:\", error);\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n\r\n        fetchEntries();\r\n    }, []);\r\n\r\n    const getFilteredEntries = () => {\r\n        let filteredEntries = [...entries];\r\n        \r\n        // Apply date filter\r\n        if (filter === 'week') {\r\n            const oneWeekAgo = new Date();\r\n            oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);\r\n            filteredEntries = filteredEntries.filter(entry => \r\n                new Date(entry.date) >= oneWeekAgo\r\n            );\r\n        } else if (filter === 'month') {\r\n            const oneMonthAgo = new Date();\r\n            oneMonthAgo.setMonth(oneMonthAgo.getMonth() - 1);\r\n            filteredEntries = filteredEntries.filter(entry => \r\n                new Date(entry.date) >= oneMonthAgo\r\n            );\r\n        }\r\n        \r\n        // Apply search filter if search term exists\r\n        if (searchTerm.trim()) {\r\n            const term = searchTerm.toLowerCase();\r\n            filteredEntries = filteredEntries.filter(entry => \r\n                (entry.thoughts && entry.thoughts.toLowerCase().includes(term)) || \r\n                (entry.mood && entry.mood.toLowerCase().includes(term)) ||\r\n                (entry.gratitude && entry.gratitude.toLowerCase().includes(term))\r\n            );\r\n        }\r\n        \r\n        return filteredEntries;\r\n    };\r\n\r\n    const formatDate = (dateString) => {\r\n        const options = { weekday: 'short', year: 'numeric', month: 'short', day: 'numeric' };\r\n        return new Date(dateString).toLocaleDateString(undefined, options);\r\n    };\r\n\r\n    const getMoodEmoji = (value) => {\r\n        const emojis = ['', '', '', '', '', '', '', '', '', ''];\r\n        return emojis[value - 1] || '';\r\n    };\r\n\r\n    const getWeatherIcon = (weatherCode, isDay) => {\r\n        if (weatherCode === 0) return isDay ? '' : ''; // Clear\r\n        if (weatherCode === 1) return isDay ? '' : ''; // Mainly clear\r\n        if (weatherCode === 2) return isDay ? '' : ''; // Partly cloudy\r\n        if (weatherCode === 3) return ''; // Overcast\r\n        if (weatherCode >= 45 && weatherCode <= 48) return ''; // Fog\r\n        if (weatherCode >= 51 && weatherCode <= 57) return ''; // Drizzle\r\n        if (weatherCode >= 61 && weatherCode <= 67) return ''; // Rain\r\n        if (weatherCode >= 71 && weatherCode <= 77) return ''; // Snow\r\n        if (weatherCode >= 80 && weatherCode <= 82) return ''; // Rain showers\r\n        if (weatherCode >= 85 && weatherCode <= 86) return ''; // Snow showers\r\n        if (weatherCode >= 95) return ''; // Thunderstorm\r\n        \r\n        return isDay ? '' : ''; // Default\r\n    };\r\n\r\n    const getEntryStyle = (moodValue) => {\r\n        // Create a style based on the mood value\r\n        if (!moodValue) return {};\r\n        \r\n        // Generate a color based on mood\r\n        let borderColor;\r\n        let gradientColor;\r\n        \r\n        if (moodValue <= 2) {\r\n            // Sad moods: blue tones\r\n            borderColor = 'var(--sad-color, rgb(108, 117, 187))';\r\n            gradientColor = 'rgba(108, 117, 187, 0.05)';\r\n        } else if (moodValue === 3) {\r\n            // Anxious moods: amber tones\r\n            borderColor = 'var(--anxious-color, rgb(255, 177, 0))';\r\n            gradientColor = 'rgba(255, 177, 0, 0.05)';\r\n        } else if (moodValue === 4) {\r\n            // Stressed moods: orange tones\r\n            borderColor = 'var(--stressed-color, rgb(242, 103, 34))';\r\n            gradientColor = 'rgba(242, 103, 34, 0.05)';\r\n        } else if (moodValue === 5) {\r\n            // Neutral moods: gray tones\r\n            borderColor = 'var(--neutral-color, rgb(190, 190, 190))';\r\n            gradientColor = 'rgba(190, 190, 190, 0.05)';\r\n        } else if (moodValue === 6) {\r\n            // Content moods: lavender tones\r\n            borderColor = 'var(--tired-color, rgb(147, 112, 170))'; \r\n            gradientColor = 'rgba(147, 112, 170, 0.05)';\r\n        } else if (moodValue === 7) {\r\n            // Calm moods: blue tones\r\n            borderColor = 'var(--calm-color, rgb(86, 161, 200))';\r\n            gradientColor = 'rgba(86, 161, 200, 0.05)';\r\n        } else if (moodValue === 8) {\r\n            // Relaxed moods: green tones\r\n            borderColor = 'var(--relaxed-color, rgb(106, 177, 135))';\r\n            gradientColor = 'rgba(106, 177, 135, 0.05)';\r\n        } else if (moodValue === 9) {\r\n            // Happy moods: yellow tones\r\n            borderColor = 'var(--happy-color, rgb(255, 195, 0))';\r\n            gradientColor = 'rgba(255, 195, 0, 0.05)';\r\n        } else {\r\n            // Excited moods: red-orange tones\r\n            borderColor = 'var(--excited-color, rgb(255, 89, 94))';\r\n            gradientColor = 'rgba(255, 89, 94, 0.05)';\r\n        }\r\n        \r\n        return {\r\n            borderLeft: `4px solid ${borderColor}`,\r\n            background: `linear-gradient(to right, ${gradientColor}, transparent 20%)`\r\n        };\r\n    };\r\n\r\n    const handleEntryClick = (entry) => {\r\n        setSelectedEntry(entry);\r\n    };\r\n\r\n    const closeEntryDetails = () => {\r\n        setSelectedEntry(null);\r\n    };\r\n\r\n    return (\r\n        <div className=\"journal-log\">\r\n            <h2>Your Journal History</h2>\r\n            \r\n            <div className=\"journal-controls\">\r\n                <div className=\"search-box\">\r\n                    <input \r\n                        type=\"text\"\r\n                        placeholder=\"Search your entries...\"\r\n                        value={searchTerm}\r\n                        onChange={(e) => setSearchTerm(e.target.value)}\r\n                    />\r\n                </div>\r\n                \r\n                <div className=\"filter-controls\">\r\n                    <button \r\n                        className={filter === 'all' ? 'active' : ''} \r\n                        onClick={() => setFilter('all')}>\r\n                        All Time\r\n                    </button>\r\n                    <button \r\n                        className={filter === 'month' ? 'active' : ''} \r\n                        onClick={() => setFilter('month')}>\r\n                        Past Month\r\n                    </button>\r\n                    <button \r\n                        className={filter === 'week' ? 'active' : ''} \r\n                        onClick={() => setFilter('week')}>\r\n                        Past Week\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            {loading ? (\r\n                <div className=\"loading-spinner\">\r\n                    <div className=\"spinner\"></div>\r\n                    <p>Loading your journal entries...</p>\r\n                </div>\r\n            ) : (\r\n                <div className=\"entries-list\">\r\n                    {getFilteredEntries().length > 0 ? (\r\n                        getFilteredEntries().map((entry, index) => (\r\n                            <div \r\n                                key={index} \r\n                                className=\"entry-card\"\r\n                                onClick={() => handleEntryClick(entry)}\r\n                                style={getEntryStyle(entry.moodValue)}\r\n                            >\r\n                                <div className=\"entry-header\">\r\n                                    <span className=\"entry-date\">{formatDate(entry.date)}</span>\r\n                                    <span className=\"entry-mood\">\r\n                                        {getMoodEmoji(entry.moodValue)} {entry.mood || `Level ${entry.moodValue}`}\r\n                                    </span>\r\n                                </div>\r\n                                {entry.weather && (\r\n                                    <div className=\"entry-weather\">\r\n                                        <span className=\"weather-icon\">\r\n                                            {getWeatherIcon(entry.weather.weatherCode, entry.weather.isDay)}\r\n                                        </span>\r\n                                        <span className=\"weather-temp\">{Math.round(entry.weather.temperature)}C</span>\r\n                                    </div>\r\n                                )}\r\n                                <div className=\"entry-preview\">\r\n                                    {entry.thoughts ? (\r\n                                        <p>{entry.thoughts.substring(0, 100)}\r\n                                            {entry.thoughts.length > 100 ? '...' : ''}\r\n                                        </p>\r\n                                    ) : (\r\n                                        <p className=\"no-content\">No thoughts recorded</p>\r\n                                    )}\r\n                                </div>\r\n                                <div className=\"entry-footer\">\r\n                                    {entry.activities && entry.activities.length > 0 && (\r\n                                        <div className=\"entry-tags\">\r\n                                            {entry.activities.slice(0, 3).map((activity, i) => (\r\n                                                <span key={i} className=\"activity-tag\">{activity}</span>\r\n                                            ))}\r\n                                            {entry.activities.length > 3 && <span className=\"more-tag\">+{entry.activities.length - 3}</span>}\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                        ))\r\n                    ) : (\r\n                        <div className=\"no-entries\">\r\n                            <p>No journal entries found</p>\r\n                            {searchTerm && <p>Try changing your search term</p>}\r\n                            {filter !== 'all' && <p>Try changing your date filter</p>}\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            )}\r\n\r\n            {selectedEntry && (\r\n                <div className=\"entry-modal-overlay\" onClick={closeEntryDetails}>\r\n                    <div className=\"entry-modal\" onClick={(e) => e.stopPropagation()}>\r\n                        <button className=\"close-button\" onClick={closeEntryDetails}></button>\r\n                        <div className=\"entry-modal-date\">{formatDate(selectedEntry.date)}</div>\r\n                        \r\n                        <div className=\"entry-modal-mood\">\r\n                            <span className=\"large-emoji\">{getMoodEmoji(selectedEntry.moodValue)}</span>\r\n                            <h3>{selectedEntry.mood || `Mood Level: ${selectedEntry.moodValue}`}</h3>\r\n                        </div>\r\n                        \r\n                        <div className=\"entry-modal-section\">\r\n                            <h4>Thoughts</h4>\r\n                            <p>{selectedEntry.thoughts || \"No thoughts recorded\"}</p>\r\n                        </div>\r\n                        \r\n                        {selectedEntry.activities && selectedEntry.activities.length > 0 && (\r\n                            <div className=\"entry-modal-section\">\r\n                                <h4>Activities</h4>\r\n                                <div className=\"activity-tags\">\r\n                                    {selectedEntry.activities.map((activity, i) => (\r\n                                        <span key={i} className=\"activity-tag\">{activity}</span>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n                        \r\n                        {selectedEntry.gratitude && (\r\n                            <div className=\"entry-modal-section\">\r\n                                <h4>Gratitude</h4>\r\n                                <p>{selectedEntry.gratitude}</p>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default JournalLog;","import React, { useState, useEffect } from 'react';\r\nimport { Chart as ChartJS, registerables } from 'chart.js';\r\nimport { Line } from 'react-chartjs-2';\r\nimport { getMoodData } from '../services/storageService';\r\nimport './MoodTracker.css';\r\n\r\n// Register Chart.js components\r\nChartJS.register(...registerables);\r\n\r\nconst MoodTracker = () => {\r\n    const [moodData, setMoodData] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [timeRange, setTimeRange] = useState('week');\r\n    const [showGrid, setShowGrid] = useState(true);\r\n    const [chartDataState, setChartDataState] = useState({\r\n        labels: [],\r\n        datasets: [{\r\n            label: 'Mood Trend',\r\n            data: [],\r\n            borderColor: 'rgba(75, 192, 192, 1)',\r\n            backgroundColor: 'rgba(75, 192, 192, 0.2)',\r\n            borderWidth: 1\r\n        }]\r\n    });\r\n\r\n    useEffect(() => {\r\n        const fetchMoodData = async () => {\r\n            setLoading(true);\r\n            try {\r\n                // In a real app, fetch from your storage service\r\n                const data = await getMoodData();\r\n                // If no data yet, use sample data for demonstration\r\n                const moods = data && data.length > 0 ? data : generateSampleMoodData();\r\n                setMoodData(moods);\r\n            } catch (error) {\r\n                console.error(\"Error fetching mood data:\", error);\r\n                // Fallback to sample data if there's an error\r\n                setMoodData(generateSampleMoodData());\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n\r\n        fetchMoodData();\r\n    }, []);\r\n\r\n    // Update chart data whenever mood data or time range changes\r\n    useEffect(() => {\r\n        if (moodData && moodData.length > 0) {\r\n            updateChartData();\r\n        }\r\n    }, [moodData, timeRange]);\r\n\r\n    const generateSampleMoodData = () => {\r\n        // Create sample data with a realistic pattern\r\n        const today = new Date();\r\n        const sampleData = [];\r\n        \r\n        for (let i = 30; i >= 0; i--) {\r\n            const date = new Date(today);\r\n            date.setDate(today.getDate() - i);\r\n            \r\n            // Generate a somewhat realistic mood pattern\r\n            let moodValue;\r\n            \r\n            if (i % 7 === 0) {\r\n                // Weekend effect - slightly happier\r\n                moodValue = Math.min(10, Math.floor(Math.random() * 3) + 7);\r\n            } else if (i % 5 === 0) {\r\n                // Some bad days\r\n                moodValue = Math.max(1, Math.floor(Math.random() * 3) + 2);\r\n            } else {\r\n                // Normal days - between 4 and 8\r\n                moodValue = Math.floor(Math.random() * 5) + 4;\r\n            }\r\n            \r\n            sampleData.push({\r\n                date: date.toISOString().split('T')[0],\r\n                moodValue: moodValue,\r\n                mood: getMoodLabel(moodValue - 1)\r\n            });\r\n        }\r\n        \r\n        return sampleData;\r\n    };\r\n\r\n    const filteredData = () => {\r\n        if (!moodData || moodData.length === 0) {\r\n            return [];\r\n        }\r\n        \r\n        const now = new Date();\r\n        let cutoff = new Date();\r\n        \r\n        if (timeRange === 'week') {\r\n            cutoff.setDate(now.getDate() - 7);\r\n        } else if (timeRange === 'month') {\r\n            cutoff.setMonth(now.getMonth() - 1);\r\n        } else if (timeRange === 'year') {\r\n            cutoff.setFullYear(now.getFullYear() - 1);\r\n        } else {\r\n            // All time - no filtering\r\n            return moodData;\r\n        }\r\n        \r\n        return moodData.filter(entry => new Date(entry.date) >= cutoff);\r\n    };\r\n\r\n    const formatDisplayDate = (dateStr) => {\r\n        const date = new Date(dateStr);\r\n        return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });\r\n    };\r\n\r\n    // Generate beautiful gradient for the chart\r\n    const createGradient = (ctx) => {\r\n        if (!ctx) return 'rgba(66, 133, 244, 0.2)';\r\n        \r\n        const gradient = ctx.createLinearGradient(0, 0, 0, 300);\r\n        gradient.addColorStop(0, 'rgba(66, 133, 244, 0.6)');\r\n        gradient.addColorStop(1, 'rgba(66, 133, 244, 0.1)');\r\n        return gradient;\r\n    };\r\n\r\n    // Update chart data state\r\n    const updateChartData = () => {\r\n        const filtered = filteredData();\r\n        \r\n        if (!filtered || filtered.length === 0) {\r\n            setChartDataState({\r\n                labels: [],\r\n                datasets: [{\r\n                    label: 'Mood Trend',\r\n                    data: [],\r\n                    borderColor: 'rgba(75, 192, 192, 1)',\r\n                    backgroundColor: 'rgba(75, 192, 192, 0.2)',\r\n                    borderWidth: 1\r\n                }]\r\n            });\r\n            return;\r\n        }\r\n        \r\n        try {\r\n            const labels = filtered.map(entry => formatDisplayDate(entry.date));\r\n            const data = filtered.map(entry => entry.moodValue || 0);\r\n            \r\n            setChartDataState({\r\n                labels: labels,\r\n                datasets: [{\r\n                    label: 'Mood Level',\r\n                    data: data,\r\n                    borderColor: 'rgba(66, 133, 244, 1)',\r\n                    backgroundColor: 'rgba(66, 133, 244, 0.2)',\r\n                    fill: true,\r\n                    tension: 0.4,\r\n                    pointBackgroundColor: 'rgba(66, 133, 244, 1)',\r\n                    pointBorderColor: '#fff',\r\n                    pointBorderWidth: 2,\r\n                    pointRadius: 4,\r\n                    pointHoverRadius: 6\r\n                }]\r\n            });\r\n        } catch (error) {\r\n            console.error(\"Error updating chart data:\", error);\r\n            // Set fallback empty data structure\r\n            setChartDataState({\r\n                labels: [],\r\n                datasets: [{\r\n                    label: 'Mood Trend',\r\n                    data: [],\r\n                    borderColor: 'rgba(75, 192, 192, 1)',\r\n                    backgroundColor: 'rgba(75, 192, 192, 0.2)',\r\n                    borderWidth: 1\r\n                }]\r\n            });\r\n        }\r\n    };\r\n\r\n    const chartOptions = {\r\n        responsive: true,\r\n        maintainAspectRatio: false,\r\n        plugins: {\r\n            legend: {\r\n                display: false\r\n            },\r\n            tooltip: {\r\n                mode: 'index',\r\n                intersect: false,\r\n                backgroundColor: 'rgba(255, 255, 255, 0.9)',\r\n                titleColor: '#333',\r\n                bodyColor: '#555',\r\n                borderColor: '#ddd',\r\n                borderWidth: 1,\r\n                padding: 10,\r\n                displayColors: false,\r\n                bodyFont: {\r\n                    size: 14\r\n                },\r\n                callbacks: {\r\n                    title: function(context) {\r\n                        return context[0].label;\r\n                    },\r\n                    label: function(context) {\r\n                        return `Mood: ${context.raw}/10`;\r\n                    },\r\n                    afterLabel: function(context) {\r\n                        const filtered = filteredData();\r\n                        if (!filtered || !context || context.dataIndex === undefined) return '';\r\n                        const entry = filtered[context.dataIndex];\r\n                        return entry && entry.mood ? `Feeling: ${entry.mood}` : '';\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        scales: {\r\n            y: {\r\n                min: 0,\r\n                max: 10,\r\n                ticks: {\r\n                    stepSize: 1,\r\n                    font: {\r\n                        size: 12\r\n                    },\r\n                    color: '#666'\r\n                },\r\n                title: {\r\n                    display: true,\r\n                    text: 'Mood Level',\r\n                    font: {\r\n                        size: 14,\r\n                        weight: 'bold'\r\n                    },\r\n                    color: '#555'\r\n                },\r\n                grid: {\r\n                    display: showGrid,\r\n                    color: 'rgba(0, 0, 0, 0.05)'\r\n                }\r\n            },\r\n            x: {\r\n                ticks: {\r\n                    font: {\r\n                        size: 11\r\n                    },\r\n                    color: '#666',\r\n                    maxRotation: 45,\r\n                    minRotation: 0\r\n                },\r\n                grid: {\r\n                    display: showGrid,\r\n                    color: 'rgba(0, 0, 0, 0.05)'\r\n                }\r\n            }\r\n        },\r\n        interaction: {\r\n            mode: 'nearest',\r\n            axis: 'x',\r\n            intersect: false\r\n        },\r\n        elements: {\r\n            line: {\r\n                tension: 0.4\r\n            }\r\n        }\r\n    };\r\n\r\n    const calculateMoodStatistics = () => {\r\n        const filtered = filteredData();\r\n        \r\n        if (!filtered || filtered.length === 0) {\r\n            return {\r\n                avg: \"0.0\",\r\n                highest: \"0\",\r\n                lowest: \"0\",\r\n                entries: 0\r\n            };\r\n        }\r\n        \r\n        const moodValues = filtered.map(entry => entry.moodValue);\r\n        const sum = moodValues.reduce((total, value) => total + value, 0);\r\n        const avg = (sum / moodValues.length).toFixed(1);\r\n        const highest = Math.max(...moodValues);\r\n        const lowest = Math.min(...moodValues);\r\n        \r\n        return {\r\n            avg,\r\n            highest,\r\n            lowest,\r\n            entries: filtered.length\r\n        };\r\n    };\r\n\r\n    const stats = calculateMoodStatistics();\r\n    \r\n    // Helper function for mood labels\r\n    function getMoodLabel(value) {\r\n        const labels = [\r\n            'Very sad', 'Sad', 'Down', 'Neutral', 'Okay', \r\n            'Good', 'Happy', 'Very happy', 'Excellent', 'Amazing'\r\n        ];\r\n        return labels[value] || 'Neutral';\r\n    }\r\n\r\n    return (\r\n        <div className=\"mood-tracker\">\r\n            <h2>Mood Trends</h2>\r\n            \r\n            <div className=\"chart-controls\">\r\n                <div className=\"time-range-selector\">\r\n                    <button \r\n                        className={timeRange === 'week' ? 'active' : ''} \r\n                        onClick={() => setTimeRange('week')}>\r\n                        Week\r\n                    </button>\r\n                    <button \r\n                        className={timeRange === 'month' ? 'active' : ''} \r\n                        onClick={() => setTimeRange('month')}>\r\n                        Month\r\n                    </button>\r\n                    <button \r\n                        className={timeRange === 'year' ? 'active' : ''} \r\n                        onClick={() => setTimeRange('year')}>\r\n                        Year\r\n                    </button>\r\n                    <button \r\n                        className={timeRange === 'all' ? 'active' : ''} \r\n                        onClick={() => setTimeRange('all')}>\r\n                        All Time\r\n                    </button>\r\n                </div>\r\n                \r\n                <label className=\"toggle-grid\">\r\n                    <input \r\n                        type=\"checkbox\" \r\n                        checked={showGrid} \r\n                        onChange={() => setShowGrid(!showGrid)} \r\n                    />\r\n                    Show Grid\r\n                </label>\r\n            </div>\r\n            \r\n            {loading ? (\r\n                <div className=\"loading-spinner\">\r\n                    <div className=\"spinner\"></div>\r\n                    <p>Loading your mood data...</p>\r\n                </div>\r\n            ) : (\r\n                <>\r\n                    <div className=\"chart-container\">\r\n                        {moodData && moodData.length > 0 ? (\r\n                            <Line data={chartDataState} options={chartOptions} />\r\n                        ) : (\r\n                            <div className=\"no-data-message\">\r\n                                <p>No mood data available yet. Start logging your daily moods!</p>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                    \r\n                    <div className=\"mood-statistics\">\r\n                        <div className=\"stat-card\">\r\n                            <div className=\"stat-value\">{stats.avg}</div>\r\n                            <div className=\"stat-label\">Average Mood</div>\r\n                        </div>\r\n                        <div className=\"stat-card\">\r\n                            <div className=\"stat-value\">{stats.highest}</div>\r\n                            <div className=\"stat-label\">Highest Mood</div>\r\n                        </div>\r\n                        <div className=\"stat-card\">\r\n                            <div className=\"stat-value\">{stats.lowest}</div>\r\n                            <div className=\"stat-label\">Lowest Mood</div>\r\n                        </div>\r\n                        <div className=\"stat-card\">\r\n                            <div className=\"stat-value\">{stats.entries}</div>\r\n                            <div className=\"stat-label\">Total Entries</div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div className=\"mood-insights\">\r\n                        <h3>Insights</h3>\r\n                        {filteredData().length > 0 ? (\r\n                            <>\r\n                                <p>Your average mood is <span className=\"highlight\">{stats.avg}/10</span> over the selected period.</p>\r\n                                {stats.entries > 3 && (\r\n                                    <p>You've been consistently tracking your mood - great job maintaining your mental health routine!</p>\r\n                                )}\r\n                                {timeRange !== 'week' && stats.entries > 7 && (\r\n                                    <p>Tip: Looking at weekly patterns can help identify specific triggers that affect your mood.</p>\r\n                                )}\r\n                            </>\r\n                        ) : (\r\n                            <p>Not enough data for this time period. Keep logging entries to see insights.</p>\r\n                        )}\r\n                    </div>\r\n                </>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default MoodTracker;","import React, { useState, useEffect, useRef } from 'react';\r\nimport './BreathingExercises.css';\r\nimport { useTheme } from './ThemeManager';\r\n\r\nconst BreathingExercises = () => {\r\n    const [activeExercise, setActiveExercise] = useState(null);\r\n    const [isPlaying, setIsPlaying] = useState(false);\r\n    const [counter, setCounter] = useState(0);\r\n    const [phase, setPhase] = useState('');\r\n    const [cycles, setCycles] = useState(0);\r\n    const [selectedCategory, setSelectedCategory] = useState('all');\r\n    const [progress, setProgress] = useState(0);\r\n    const [totalDuration, setTotalDuration] = useState(0);\r\n    const [elapsedTime, setElapsedTime] = useState(0);\r\n    const timerRef = useRef(null);\r\n    const audioRef = useRef(null);\r\n    const phaseTimerRef = useRef(null);\r\n    const countdownIntervalRef = useRef(null);\r\n    const { currentTheme } = useTheme();\r\n\r\n    // Breathing exercises data\r\n    const exercises = [\r\n        {\r\n            id: 1,\r\n            name: \"4-7-8 Breathing\",\r\n            description: \"A relaxing breath pattern that helps reduce anxiety and may help you fall asleep faster.\",\r\n            category: \"relaxation\",\r\n            type: \"box\",\r\n            inhaleTime: 4,\r\n            holdInTime: 7,\r\n            exhaleTime: 8,\r\n            holdOutTime: 0,\r\n            cycles: 5,\r\n            benefits: [\"Reduces anxiety\", \"Helps with sleep\", \"Lowers heart rate\"]\r\n        },\r\n        {\r\n            id: 2,\r\n            name: \"Box Breathing\",\r\n            description: \"A simple technique to help you regain calm and focus. Used by Navy SEALs for stress management.\",\r\n            category: \"focus\",\r\n            type: \"box\",\r\n            inhaleTime: 4,\r\n            holdInTime: 4,\r\n            exhaleTime: 4,\r\n            holdOutTime: 4,\r\n            cycles: 4,\r\n            benefits: [\"Improves concentration\", \"Manages stress\", \"Increases mental clarity\"]\r\n        },\r\n        {\r\n            id: 3,\r\n            name: \"Deep Calm Breathing\",\r\n            description: \"A gentle technique to promote relaxation and reduce physical tension.\",\r\n            category: \"relaxation\",\r\n            type: \"wave\",\r\n            inhaleTime: 5,\r\n            holdInTime: 2,\r\n            exhaleTime: 6,\r\n            holdOutTime: 0,\r\n            cycles: 6,\r\n            benefits: [\"Reduces physical tension\", \"Promotes relaxation\", \"Calms the nervous system\"]\r\n        }\r\n    ];\r\n\r\n    const startExercise = (exercise) => {\r\n        setActiveExercise(exercise);\r\n        setIsPlaying(true);\r\n        setCounter(exercise.inhaleTime);\r\n        setPhase('inhale');\r\n        setCycles(0);\r\n        setProgress(0);\r\n        setTotalDuration(calculateTotalDuration(exercise));\r\n        setElapsedTime(0);\r\n        \r\n        // Start the phase timer\r\n        startPhaseTimer(exercise);\r\n        \r\n        // Start progress tracking\r\n        const intervalId = setInterval(() => {\r\n            if (!isPlaying) return;\r\n            \r\n            setElapsedTime(prev => {\r\n                const newElapsed = prev + 0.1;\r\n                if (totalDuration > 0) {\r\n                    const progressPercent = (newElapsed / totalDuration) * 100;\r\n                    setProgress(Math.min(progressPercent, 100));\r\n                }\r\n                return newElapsed;\r\n            });\r\n        }, 100);\r\n        \r\n        timerRef.current = intervalId;\r\n    };\r\n\r\n    const stopExercise = () => {\r\n        setIsPlaying(false);\r\n        setActiveExercise(null);\r\n        setPhase('');\r\n        setCounter(0);\r\n        setCycles(0);\r\n        setProgress(0);\r\n        setElapsedTime(0);\r\n        \r\n        // Clear all timers\r\n        if (timerRef.current) clearInterval(timerRef.current);\r\n        if (phaseTimerRef.current) clearTimeout(phaseTimerRef.current);\r\n        if (countdownIntervalRef.current) clearInterval(countdownIntervalRef.current);\r\n    };\r\n\r\n    const startPhaseTimer = (exercise) => {\r\n        // Clear any existing timer\r\n        if (phaseTimerRef.current) clearTimeout(phaseTimerRef.current);\r\n        \r\n        const currentPhase = phase;\r\n        let duration = 0;\r\n        let nextPhase = '';\r\n        \r\n        // Determine current phase duration and next phase\r\n        switch (currentPhase) {\r\n            case 'inhale':\r\n                duration = exercise.inhaleTime * 1000;\r\n                nextPhase = exercise.holdInTime > 0 ? 'hold-in' : 'exhale';\r\n                break;\r\n            case 'hold-in':\r\n                duration = exercise.holdInTime * 1000;\r\n                nextPhase = 'exhale';\r\n                break;\r\n            case 'exhale':\r\n                duration = exercise.exhaleTime * 1000;\r\n                nextPhase = exercise.holdOutTime > 0 ? 'hold-out' : 'inhale';\r\n                \r\n                // If next phase is inhale and no hold-out, we've completed a cycle\r\n                if (nextPhase === 'inhale') {\r\n                    const newCycles = cycles + 1;\r\n                    setCycles(newCycles);\r\n                    \r\n                    // Check if we've reached the maximum cycles\r\n                    if (exercise.cycles && newCycles >= exercise.cycles) {\r\n                        phaseTimerRef.current = setTimeout(() => {\r\n                            stopExercise();\r\n                        }, duration);\r\n                        return;\r\n                    }\r\n                }\r\n                break;\r\n            case 'hold-out':\r\n                duration = exercise.holdOutTime * 1000;\r\n                nextPhase = 'inhale';\r\n                \r\n                // Always increment cycle count when returning to inhale from hold-out\r\n                const newCycles = cycles + 1;\r\n                setCycles(newCycles);\r\n                \r\n                // Check if we've reached the maximum cycles\r\n                if (exercise.cycles && newCycles >= exercise.cycles) {\r\n                    phaseTimerRef.current = setTimeout(() => {\r\n                        stopExercise();\r\n                    }, duration);\r\n                    return;\r\n                }\r\n                break;\r\n            default:\r\n                // If phase is empty (initial state), set it to inhale\r\n                duration = 0;\r\n                nextPhase = 'inhale';\r\n                break;\r\n        }\r\n        \r\n        // Start countdown for current phase\r\n        startCountdown(\r\n            currentPhase === 'inhale' ? exercise.inhaleTime :\r\n            currentPhase === 'hold-in' ? exercise.holdInTime :\r\n            currentPhase === 'exhale' ? exercise.exhaleTime :\r\n            exercise.holdOutTime\r\n        );\r\n        \r\n        // Set timer for next phase\r\n        phaseTimerRef.current = setTimeout(() => {\r\n            // Set the next phase\r\n            setPhase(nextPhase);\r\n            \r\n            // Set counter for next phase\r\n            if (nextPhase === 'inhale') setCounter(exercise.inhaleTime);\r\n            else if (nextPhase === 'hold-in') setCounter(exercise.holdInTime);\r\n            else if (nextPhase === 'exhale') setCounter(exercise.exhaleTime);\r\n            else if (nextPhase === 'hold-out') setCounter(exercise.holdOutTime);\r\n            \r\n            // Continue the cycle\r\n            startPhaseTimer(exercise);\r\n        }, duration);\r\n    };\r\n\r\n    const startCountdown = (seconds) => {\r\n        // Clear any existing interval\r\n        if (countdownIntervalRef.current) clearInterval(countdownIntervalRef.current);\r\n        \r\n        // Set initial counter value\r\n        setCounter(seconds);\r\n        \r\n        // Start countdown interval\r\n        countdownIntervalRef.current = setInterval(() => {\r\n            setCounter(prev => {\r\n                if (prev <= 1) {\r\n                    clearInterval(countdownIntervalRef.current);\r\n                    return 0;\r\n                }\r\n                return prev - 1;\r\n            });\r\n        }, 1000);\r\n    };\r\n\r\n    const calculateTotalDuration = (exercise) => {\r\n        const cycleDuration = (\r\n            exercise.inhaleTime +\r\n            exercise.holdInTime +\r\n            exercise.exhaleTime +\r\n            exercise.holdOutTime\r\n        );\r\n        return cycleDuration * exercise.cycles;\r\n    };\r\n    \r\n    // Filter exercises by category\r\n    const filteredExercises = selectedCategory === 'all' \r\n        ? exercises \r\n        : exercises.filter(ex => ex.category === selectedCategory);\r\n    \r\n    // Clean up timers on unmount\r\n    useEffect(() => {\r\n        return () => {\r\n            clearTimeout(timerRef.current);\r\n            clearTimeout(phaseTimerRef.current);\r\n            clearInterval(countdownIntervalRef.current);\r\n        };\r\n    }, []);\r\n    \r\n    // Update when phase changes\r\n    useEffect(() => {\r\n        if (isPlaying && activeExercise && phase) {\r\n            // Any additional effects when phase changes\r\n        }\r\n    }, [phase, isPlaying, activeExercise]);\r\n\r\n    return (\r\n        <div className=\"breathing-exercises\">\r\n            <h2><span className=\"breathing-title-icon\"></span> Breathing Exercises</h2>\r\n            \r\n            {!activeExercise ? (\r\n                <div>\r\n                    <p className=\"breathing-intro\">\r\n                        Select a breathing technique to help reduce stress, increase focus, or promote relaxation.\r\n                    </p>\r\n                    \r\n                    <div className=\"category-filter\">\r\n                        <button \r\n                            className={`category-button ${selectedCategory === 'all' ? 'active' : ''}`}\r\n                            onClick={() => setSelectedCategory('all')}\r\n                        >\r\n                            All\r\n                        </button>\r\n                        <button \r\n                            className={`category-button ${selectedCategory === 'relaxation' ? 'active' : ''}`}\r\n                            onClick={() => setSelectedCategory('relaxation')}\r\n                        >\r\n                            Relaxation\r\n                        </button>\r\n                        <button \r\n                            className={`category-button ${selectedCategory === 'focus' ? 'active' : ''}`}\r\n                            onClick={() => setSelectedCategory('focus')}\r\n                        >\r\n                            Focus\r\n                        </button>\r\n                    </div>\r\n                    \r\n                    <div className=\"exercises-list\">\r\n                        {filteredExercises.map(exercise => (\r\n                            <div key={exercise.id} className=\"exercise-card\">\r\n                                <div className=\"exercise-header\">\r\n                                    <h3>{exercise.name}</h3>\r\n                                </div>\r\n                                <p>{exercise.description}</p>\r\n                                <div className=\"exercise-meta\">\r\n                                    <span className=\"duration-tag\">\r\n                                        {calculateTotalDuration(exercise) / 60 < 1 \r\n                                            ? `${calculateTotalDuration(exercise)} seconds` \r\n                                            : `${Math.round(calculateTotalDuration(exercise) / 60)} minutes`}\r\n                                    </span>\r\n                                    <span className=\"category-tag\">{exercise.category}</span>\r\n                                </div>\r\n                                <button \r\n                                    className=\"start-button\"\r\n                                    onClick={() => startExercise(exercise)}\r\n                                >\r\n                                    Start\r\n                                </button>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            ) : (\r\n                <div className=\"active-exercise\">\r\n                    <h3>{activeExercise.name}</h3>\r\n                    \r\n                    <div className=\"breathing-animation-container\">\r\n                        <div className={`breathing-circle ${activeExercise.type} ${phase} ${activeExercise.name === \"4-7-8 Breathing\" ? \"four-seven-eight\" : \"\"}`}>\r\n                            <div className=\"counter\">{counter}</div>\r\n                            <div className=\"breath-status\">{phase.replace('-', ' ')}</div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div className=\"progress-container\">\r\n                        <div className=\"progress-bar\">\r\n                            <div \r\n                                className=\"progress-fill\" \r\n                                style={{width: `${progress}%`}}\r\n                            ></div>\r\n                        </div>\r\n                        <div className=\"progress-info\">\r\n                            Cycles: {cycles}/{activeExercise.cycles || 10}\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <button \r\n                        className=\"stop-button\" \r\n                        onClick={stopExercise}\r\n                    >\r\n                        Stop Exercise\r\n                    </button>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default BreathingExercises;","import React, { useState, useEffect } from 'react';\r\nimport './EmergencyContacts.css';\r\n\r\nconst EmergencyContacts = () => {\r\n    const [contacts, setContacts] = useState([]);\r\n    const [name, setName] = useState('');\r\n    const [phone, setPhone] = useState('');\r\n    const [editIndex, setEditIndex] = useState(null);\r\n    const [isAdding, setIsAdding] = useState(false);\r\n    const [formError, setFormError] = useState('');\r\n    const [showSuccess, setShowSuccess] = useState(false);\r\n\r\n    // Load contacts from localStorage on component mount\r\n    useEffect(() => {\r\n        const savedContacts = localStorage.getItem('emergencyContacts');\r\n        if (savedContacts) {\r\n            setContacts(JSON.parse(savedContacts));\r\n        }\r\n    }, []);\r\n\r\n    // Save contacts to localStorage whenever they change\r\n    useEffect(() => {\r\n        localStorage.setItem('emergencyContacts', JSON.stringify(contacts));\r\n    }, [contacts]);\r\n\r\n    const validatePhone = (phoneNumber) => {\r\n        // Basic phone validation - allows different formats including country codes\r\n        const regex = /^[+]?[(]?[0-9]{1,4}[)]?[-\\s.]?[0-9]{1,3}[-\\s.]?[0-9]{1,4}[-\\s.]?[0-9]{1,4}$/;\r\n        return regex.test(phoneNumber);\r\n    };\r\n\r\n    const handleSubmit = (e) => {\r\n        e.preventDefault();\r\n        \r\n        if (!name.trim()) {\r\n            setFormError('Please enter a contact name');\r\n            return;\r\n        }\r\n        \r\n        if (!phone.trim() || !validatePhone(phone)) {\r\n            setFormError('Please enter a valid phone number');\r\n            return;\r\n        }\r\n        \r\n        if (editIndex !== null) {\r\n            // Update existing contact\r\n            const updatedContacts = [...contacts];\r\n            updatedContacts[editIndex] = { name, phone };\r\n            setContacts(updatedContacts);\r\n            setEditIndex(null);\r\n        } else {\r\n            // Add new contact\r\n            setContacts([...contacts, { name, phone }]);\r\n        }\r\n        \r\n        // Reset form\r\n        setName('');\r\n        setPhone('');\r\n        setFormError('');\r\n        setIsAdding(false);\r\n        \r\n        // Show success message\r\n        setShowSuccess(true);\r\n        setTimeout(() => setShowSuccess(false), 3000);\r\n    };\r\n\r\n    const handleEdit = (index) => {\r\n        setName(contacts[index].name);\r\n        setPhone(contacts[index].phone);\r\n        setEditIndex(index);\r\n        setIsAdding(true);\r\n        setFormError('');\r\n    };\r\n\r\n    const handleCancel = () => {\r\n        setName('');\r\n        setPhone('');\r\n        setEditIndex(null);\r\n        setIsAdding(false);\r\n        setFormError('');\r\n    };\r\n\r\n    const removeContact = (index) => {\r\n        const newContacts = contacts.filter((_, i) => i !== index);\r\n        setContacts(newContacts);\r\n    };\r\n\r\n    const testCall = (phoneNumber) => {\r\n        window.location.href = `tel:${phoneNumber}`;\r\n    };\r\n\r\n    return (\r\n        <div className=\"emergency-contacts\">\r\n            <h2>\r\n                <span className=\"emergency-icon\"></span> Emergency Contacts\r\n            </h2>\r\n            \r\n            <div className=\"contacts-info\">\r\n                <p>Add people you trust who can be contacted in case of an emergency. \r\n                These contacts will receive an alert message when you use the SOS button.</p>\r\n            </div>\r\n\r\n            {showSuccess && (\r\n                <div className=\"success-message\">\r\n                    <span> Contact {editIndex !== null ? 'updated' : 'added'} successfully!</span>\r\n                </div>\r\n            )}\r\n            \r\n            <div className=\"contacts-container\">\r\n                {contacts.length > 0 ? (\r\n                    <div className=\"contacts-list\">\r\n                        {contacts.map((contact, index) => (\r\n                            <div key={index} className=\"contact-card\">\r\n                                <div className=\"contact-info\">\r\n                                    <h3>{contact.name}</h3>\r\n                                    <p>{contact.phone}</p>\r\n                                </div>\r\n                                <div className=\"contact-actions\">\r\n                                    <button \r\n                                        className=\"test-call-btn\" \r\n                                        onClick={() => testCall(contact.phone)}\r\n                                        aria-label={`Call ${contact.name}`}\r\n                                    >\r\n                                        <span className=\"btn-icon\"></span>\r\n                                    </button>\r\n                                    <button \r\n                                        className=\"edit-contact-btn\" \r\n                                        onClick={() => handleEdit(index)}\r\n                                        aria-label={`Edit ${contact.name}`}\r\n                                    >\r\n                                        <span className=\"btn-icon\"></span>\r\n                                    </button>\r\n                                    <button \r\n                                        className=\"remove-contact-btn\" \r\n                                        onClick={() => removeContact(index)}\r\n                                        aria-label={`Remove ${contact.name}`}\r\n                                    >\r\n                                        <span className=\"btn-icon\"></span>\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"no-contacts\">\r\n                        <div className=\"no-contacts-icon\"></div>\r\n                        <p>No emergency contacts added yet</p>\r\n                        <p className=\"no-contacts-subtitle\">Add trusted people who can help during a crisis</p>\r\n                    </div>\r\n                )}\r\n\r\n                {!isAdding ? (\r\n                    <button className=\"add-contact-button\" onClick={() => setIsAdding(true)}>\r\n                        + Add Emergency Contact\r\n                    </button>\r\n                ) : (\r\n                    <div className=\"contact-form-container\">\r\n                        <h3>{editIndex !== null ? 'Edit Contact' : 'Add New Contact'}</h3>\r\n                        <form onSubmit={handleSubmit} className=\"contact-form\">\r\n                            {formError && <div className=\"form-error\">{formError}</div>}\r\n                            \r\n                            <div className=\"form-group\">\r\n                                <label htmlFor=\"contact-name\">Name</label>\r\n                                <input\r\n                                    id=\"contact-name\"\r\n                                    type=\"text\"\r\n                                    value={name}\r\n                                    onChange={(e) => setName(e.target.value)}\r\n                                    placeholder=\"Contact name\"\r\n                                />\r\n                            </div>\r\n                            \r\n                            <div className=\"form-group\">\r\n                                <label htmlFor=\"contact-phone\">Phone Number</label>\r\n                                <input\r\n                                    id=\"contact-phone\"\r\n                                    type=\"tel\"\r\n                                    value={phone}\r\n                                    onChange={(e) => setPhone(e.target.value)}\r\n                                    placeholder=\"Phone number with country code\"\r\n                                />\r\n                                <small className=\"phone-format-hint\">Format: +1234567890 or 123-456-7890</small>\r\n                            </div>\r\n                            \r\n                            <div className=\"form-actions\">\r\n                                <button type=\"submit\" className=\"save-contact-btn\">\r\n                                    {editIndex !== null ? 'Update Contact' : 'Save Contact'}\r\n                                </button>\r\n                                <button type=\"button\" className=\"cancel-btn\" onClick={handleCancel}>\r\n                                    Cancel\r\n                                </button>\r\n                            </div>\r\n                        </form>\r\n                    </div>\r\n                )}\r\n            </div>\r\n            \r\n            <div className=\"sos-guide\">\r\n                <h3>How to Use SOS Feature</h3>\r\n                <div className=\"sos-steps\">\r\n                    <div className=\"sos-step\">\r\n                        <div className=\"step-number\">1</div>\r\n                        <p>Add your trusted emergency contacts above</p>\r\n                    </div>\r\n                    <div className=\"sos-step\">\r\n                        <div className=\"step-number\">2</div>\r\n                        <p>In a crisis, tap the SOS button in the app header</p>\r\n                    </div>\r\n                    <div className=\"sos-step\">\r\n                        <div className=\"step-number\">3</div>\r\n                        <p>Confirm to send emergency text messages to all your contacts</p>\r\n                    </div>\r\n                </div>\r\n                <div className=\"sos-note\">\r\n                    <p>\r\n                        <strong>Note:</strong> The SOS feature will open your phone's messaging app \r\n                        with pre-written emergency texts. You'll need to manually send the messages.\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default EmergencyContacts;","/**\r\n * Send SMS via device's native SMS functionality\r\n * @param {string} phoneNumber - Recipient's phone number\r\n * @param {string} message - Text message content\r\n * @returns {boolean} Whether the SMS link was opened\r\n */\r\nexport const sendSMS = (phoneNumber, message) => {\r\n    if (!phoneNumber || !message) {\r\n        console.error(\"Phone number and message are required to send SMS.\");\r\n        return false;\r\n    }\r\n\r\n    // Determine platform\r\n    const isIOS = /iPhone|iPad|iPod/.test(navigator.userAgent);\r\n    const isAndroid = /Android/.test(navigator.userAgent);\r\n    \r\n    try {\r\n        // URI encode the message\r\n        const encodedMessage = encodeURIComponent(message);\r\n        \r\n        // Create SMS link appropriate for the platform\r\n        let smsLink;\r\n        \r\n        if (isIOS) {\r\n            // iOS uses sms: protocol with & separator\r\n            smsLink = `sms:${phoneNumber}&body=${encodedMessage}`;\r\n        } else if (isAndroid) {\r\n            // Android uses smsto: or sms: protocol with ? separator\r\n            smsLink = `sms:${phoneNumber}?body=${encodedMessage}`;\r\n        } else {\r\n            // Default format for other platforms\r\n            smsLink = `sms:${phoneNumber}?body=${encodedMessage}`;\r\n        }\r\n        \r\n        // Log for debugging purposes\r\n        console.log(`Opening SMS link: ${smsLink}`);\r\n        \r\n        // Open the SMS link\r\n        window.location.href = smsLink;\r\n        \r\n        return true;\r\n    } catch (error) {\r\n        console.error(\"Error sending SMS:\", error);\r\n        return false;\r\n    }\r\n};\r\n\r\n/**\r\n * Make a phone call using the device's native call functionality\r\n * @param {string} phoneNumber - Phone number to call\r\n * @returns {boolean} Whether the call link was opened\r\n */\r\nexport const makePhoneCall = (phoneNumber) => {\r\n    if (!phoneNumber) {\r\n        console.error(\"Phone number is required to make a call.\");\r\n        return false;\r\n    }\r\n    \r\n    try {\r\n        // Create tel: URI\r\n        const callLink = `tel:${phoneNumber}`;\r\n        \r\n        // Open the call link\r\n        window.location.href = callLink;\r\n        \r\n        return true;\r\n    } catch (error) {\r\n        console.error(\"Error making phone call:\", error);\r\n        return false;\r\n    }\r\n};","import React, { useState, useEffect } from 'react';\r\nimport { sendSMS } from '../services/smsService';\r\nimport { useHistory } from 'react-router-dom';\r\nimport './SOSButton.css';\r\n\r\nconst SOSButton = ({ className }) => {\r\n    const [showConfirm, setShowConfirm] = useState(false);\r\n    const [sending, setSending] = useState(false);\r\n    const [sent, setSent] = useState(false);\r\n    const [hasContacts, setHasContacts] = useState(false);\r\n    const history = useHistory();\r\n    \r\n    // Check if emergency contacts exist\r\n    useEffect(() => {\r\n        const checkContacts = () => {\r\n            const storedContacts = localStorage.getItem('emergencyContacts');\r\n            const contacts = storedContacts ? JSON.parse(storedContacts) : [];\r\n            setHasContacts(contacts.length > 0);\r\n        };\r\n        \r\n        // Check on mount and whenever localStorage might change\r\n        checkContacts();\r\n        \r\n        // Setup storage event listener to detect changes in other tabs\r\n        const handleStorageChange = (e) => {\r\n            if (e.key === 'emergencyContacts') {\r\n                checkContacts();\r\n            }\r\n        };\r\n        \r\n        window.addEventListener('storage', handleStorageChange);\r\n        \r\n        return () => {\r\n            window.removeEventListener('storage', handleStorageChange);\r\n        };\r\n    }, []);\r\n\r\n    const handleSOSClick = () => {\r\n        // If no contacts, prompt to add them\r\n        if (!hasContacts) {\r\n            history.push('/emergency-contacts');\r\n            return;\r\n        }\r\n        \r\n        setShowConfirm(true);\r\n    };\r\n\r\n    const handleCancel = () => {\r\n        setShowConfirm(false);\r\n    };\r\n\r\n    const handleConfirmSOS = () => {\r\n        setSending(true);\r\n        \r\n        // Get contacts from local storage\r\n        const storedContacts = localStorage.getItem('emergencyContacts');\r\n        const contacts = storedContacts ? JSON.parse(storedContacts) : [];\r\n        \r\n        // Prepare emergency message\r\n        const userLocation = 'unknown location'; // Could be enhanced with geolocation\r\n        const timestamp = new Date().toLocaleString();\r\n        \r\n        const message = `EMERGENCY SOS - I need help right now at ${userLocation}. This message was sent from my MindMatters app at ${timestamp}. Please try to contact me or emergency services if you can't reach me.`;\r\n        \r\n        // Create a small delay between each SMS to avoid freezing the UI\r\n        setTimeout(() => {\r\n            // Send the SMS to each contact\r\n            if (contacts.length > 0) {\r\n                // SMS strategy depends on the platform\r\n                if (/iPhone|iPad|iPod/.test(navigator.userAgent)) {\r\n                    // For iOS, we need to do a single SMS with multiple recipients\r\n                    const recipients = contacts.map(contact => contact.phone).join(',');\r\n                    sendSMS(recipients, message);\r\n                } else {\r\n                    // For Android and other platforms, send individual SMS\r\n                    contacts.forEach((contact, index) => {\r\n                        setTimeout(() => {\r\n                            try {\r\n                                sendSMS(contact.phone, message);\r\n                            } catch (error) {\r\n                                console.error(`Failed to send SOS to ${contact.name}:`, error);\r\n                            }\r\n                        }, index * 300); // Small delay between each SMS\r\n                    });\r\n                }\r\n            }\r\n            \r\n            // Update UI state\r\n            setSending(false);\r\n            setSent(true);\r\n            \r\n            // Reset after showing success message\r\n            setTimeout(() => {\r\n                setShowConfirm(false);\r\n                setSent(false);\r\n            }, 3000);\r\n        }, 800);\r\n    };\r\n\r\n    return (\r\n        <div className={`sos-container ${className || ''}`}>\r\n            <button \r\n                onClick={handleSOSClick} \r\n                className={`sos-button ${!hasContacts ? 'sos-add' : ''}`}\r\n                title={hasContacts ? \"Send emergency SOS\" : \"Add emergency contacts first\"}\r\n            >\r\n                {hasContacts ? 'SOS' : '+ SOS'}\r\n            </button>\r\n            \r\n            {showConfirm && (\r\n                <div className=\"sos-confirm\">\r\n                    {!sending && !sent ? (\r\n                        <>\r\n                            <div className=\"sos-confirm-header\">\r\n                                <span className=\"sos-alert-icon\"></span>\r\n                                <h3>Send Emergency Alert?</h3>\r\n                            </div>\r\n                            <p>This will prepare SMS messages to your emergency contacts asking for immediate help.</p>\r\n                            <div className=\"sos-confirm-buttons\">\r\n                                <button onClick={handleConfirmSOS} className=\"confirm-button\">\r\n                                    Yes, Send Alert\r\n                                </button>\r\n                                <button onClick={handleCancel} className=\"cancel-button\">\r\n                                    Cancel\r\n                                </button>\r\n                            </div>\r\n                        </>\r\n                    ) : sending ? (\r\n                        <div className=\"sos-sending\">\r\n                            <div className=\"sending-spinner\"></div>\r\n                            <p>Preparing emergency messages...</p>\r\n                        </div>\r\n                    ) : sent ? (\r\n                        <div className=\"sos-sent\">\r\n                            <div className=\"sent-icon\"></div>\r\n                            <p>Messages ready to send!</p>\r\n                            <small className=\"sent-note\">Please confirm each message in your messaging app</small>\r\n                        </div>\r\n                    ) : null}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default SOSButton;","/**\r\n * Service to fetch inspirational quotes\r\n */\r\n\r\n// Fallback quotes to use when offline or API fails\r\nconst fallbackQuotes = [\r\n  {\r\n    quote: \"The mind is everything. What you think you become.\",\r\n    author: \"Buddha\"\r\n  },\r\n  {\r\n    quote: \"Your task is not to seek love, but merely to seek and find all the barriers within yourself that you have built against it.\",\r\n    author: \"Rumi\"\r\n  },\r\n  {\r\n    quote: \"Happiness is not something ready-made. It comes from your own actions.\",\r\n    author: \"Dalai Lama\"\r\n  },\r\n  {\r\n    quote: \"The greatest glory in living lies not in never falling, but in rising every time we fall.\",\r\n    author: \"Nelson Mandela\"\r\n  },\r\n  {\r\n    quote: \"In the midst of winter, I found there was, within me, an invincible summer.\",\r\n    author: \"Albert Camus\"\r\n  },\r\n  {\r\n    quote: \"It is during our darkest moments that we must focus to see the light.\",\r\n    author: \"Aristotle\"\r\n  },\r\n  {\r\n    quote: \"You are never too old to set another goal or to dream a new dream.\",\r\n    author: \"C.S. Lewis\"\r\n  },\r\n  {\r\n    quote: \"Peace begins with a smile.\",\r\n    author: \"Mother Teresa\"\r\n  },\r\n  {\r\n    quote: \"The future depends on what you do today.\",\r\n    author: \"Mahatma Gandhi\"\r\n  },\r\n  {\r\n    quote: \"What you get by achieving your goals is not as important as what you become by achieving your goals.\",\r\n    author: \"Zig Ziglar\"\r\n  },\r\n  {\r\n    quote: \"When we are no longer able to change a situation, we are challenged to change ourselves.\",\r\n    author: \"Viktor Frankl\"\r\n  },\r\n  {\r\n    quote: \"Live in the sunshine, swim the sea, drink the wild air.\",\r\n    author: \"Ralph Waldo Emerson\"\r\n  }\r\n];\r\n\r\n/**\r\n * Fetch a daily inspirational quote\r\n * @param {boolean} forceRefresh - Whether to bypass cache and fetch a new quote\r\n * @returns {Promise<Object>} Quote object with author and text\r\n */\r\nexport const fetchDailyQuote = async (forceRefresh = false) => {\r\n  // Check if we have a cached quote and it's still valid for today\r\n  const today = new Date().toDateString();\r\n  const cachedData = localStorage.getItem('dailyQuote');\r\n\r\n  if (!forceRefresh && cachedData) {\r\n    try {\r\n      const cached = JSON.parse(cachedData);\r\n      const cacheDate = localStorage.getItem('quoteDate');\r\n      \r\n      if (cacheDate === today) {\r\n        console.log('Using cached quote for today');\r\n        return {\r\n          ...cached,\r\n          success: true,\r\n          source: 'cache'\r\n        };\r\n      }\r\n    } catch (e) {\r\n      console.error('Error reading cached quote', e);\r\n    }\r\n  }\r\n\r\n  // Try multiple APIs to ensure we get a quote\r\n  const apis = [\r\n    { \r\n      name: 'quotable',\r\n      url: 'https://api.quotable.kurokeita.dev/api/quotes/random',\r\n      parser: (data) => ({ \r\n        quote: data.quote.content, \r\n        author: data.quote.author.name,\r\n        tags: data.quote.tags.map(tag => tag.name).join(', '),\r\n        authorBio: data.quote.author.bio || ''\r\n      })\r\n    },\r\n    { \r\n      name: 'zenquotes',\r\n      url: 'https://api.zenquotes.io/v1/random',\r\n      parser: (data) => ({ \r\n        quote: data[0].q, \r\n        author: data[0].a \r\n      })\r\n    },\r\n    { \r\n      name: 'quotable-legacy',\r\n      url: 'https://api.quotable.io/random',\r\n      parser: (data) => ({ \r\n        quote: data.content, \r\n        author: data.author \r\n      })\r\n    },\r\n    { \r\n      name: 'type.fit',\r\n      url: 'https://type.fit/api/quotes',\r\n      parser: (data) => {\r\n        const randomQuote = data[Math.floor(Math.random() * data.length)];\r\n        return { \r\n          quote: randomQuote.text, \r\n          author: randomQuote.author || \"Unknown\" \r\n        };\r\n      }\r\n    },\r\n    {\r\n      name: 'quoteGarden',\r\n      url: 'https://quote-garden.onrender.com/api/v3/quotes/random',\r\n      parser: (data) => ({\r\n        quote: data.data[0].quoteText,\r\n        author: data.data[0].quoteAuthor\r\n      })\r\n    }\r\n  ];\r\n\r\n  // Try each API in sequence until one works\r\n  for (const api of apis) {\r\n    try {\r\n      // First check if we're online before attempting to fetch\r\n      if (!navigator.onLine) {\r\n        throw new Error('You are offline');\r\n      }\r\n      \r\n      console.log(`Trying to fetch quote from ${api.name}...`);\r\n      const response = await fetch(api.url, { \r\n        signal: AbortSignal.timeout(5000)  // 5 second timeout\r\n      });\r\n      \r\n      if (!response.ok) {\r\n        throw new Error(`Failed with status ${response.status}`);\r\n      }\r\n      \r\n      const data = await response.json();\r\n      const quoteData = api.parser(data);\r\n      \r\n      if (quoteData.quote && quoteData.author) {\r\n        // Cache the successful result\r\n        localStorage.setItem('dailyQuote', JSON.stringify(quoteData));\r\n        localStorage.setItem('quoteDate', today);\r\n        \r\n        console.log(`Successfully fetched quote from ${api.name}`);\r\n        \r\n        return {\r\n          ...quoteData,\r\n          success: true,\r\n          source: api.name\r\n        };\r\n      }\r\n      \r\n      throw new Error('Invalid quote data format');\r\n    } catch (error) {\r\n      console.warn(`Failed to fetch from ${api.name}:`, error);\r\n      // Continue to next API\r\n    }\r\n  }\r\n  \r\n  // If all APIs fail, use a random fallback quote\r\n  console.log('All APIs failed, using fallback quote');\r\n  const randomIndex = Math.floor(Math.random() * fallbackQuotes.length);\r\n  const fallbackQuote = fallbackQuotes[randomIndex];\r\n  \r\n  return {\r\n    ...fallbackQuote,\r\n    success: false,\r\n    source: 'fallback',\r\n    error: 'Could not connect to quote services'\r\n  };\r\n};\r\n\r\n/**\r\n * Get a random quote from the fallback collection\r\n * @returns {Object} Quote object\r\n */\r\nexport const getRandomFallbackQuote = () => {\r\n  const randomIndex = Math.floor(Math.random() * fallbackQuotes.length);\r\n  return fallbackQuotes[randomIndex];\r\n};","import React, { useState, useEffect } from 'react';\r\nimport { fetchDailyQuote } from '../services/quoteService';\r\nimport './DailyQuote.css';\r\n\r\nconst DailyQuote = () => {\r\n  const [quote, setQuote] = useState({\r\n    quote: \"\",\r\n    author: \"\",\r\n    tags: \"\",\r\n    authorBio: \"\",\r\n    loading: true,\r\n    error: false,\r\n    source: null\r\n  });\r\n  \r\n  const [refreshing, setRefreshing] = useState(false);\r\n  const [isOnline, setIsOnline] = useState(navigator.onLine);\r\n  const [showCopied, setShowCopied] = useState(false);\r\n  const [showAuthorInfo, setShowAuthorInfo] = useState(false);\r\n\r\n  // Monitor online status\r\n  useEffect(() => {\r\n    const handleOnline = () => setIsOnline(true);\r\n    const handleOffline = () => setIsOnline(false);\r\n    \r\n    window.addEventListener('online', handleOnline);\r\n    window.addEventListener('offline', handleOffline);\r\n    \r\n    return () => {\r\n      window.removeEventListener('online', handleOnline);\r\n      window.removeEventListener('offline', handleOffline);\r\n    };\r\n  }, []);\r\n\r\n  const getQuote = async (forceRefresh = false) => {\r\n    if (refreshing) return;\r\n    \r\n    setRefreshing(true);\r\n    setQuote(prev => ({ ...prev, loading: true }));\r\n    \r\n    try {\r\n      const quoteData = await fetchDailyQuote(forceRefresh);\r\n      setQuote({\r\n        quote: quoteData.quote,\r\n        author: quoteData.author,\r\n        tags: quoteData.tags || \"\",\r\n        authorBio: quoteData.authorBio || \"\",\r\n        loading: false,\r\n        error: !quoteData.success,\r\n        source: quoteData.source\r\n      });\r\n    } catch (error) {\r\n      console.error(\"Error fetching quote:\", error);\r\n      setQuote({\r\n        quote: \"Take a deep breath and try again.\",\r\n        author: \"MindMatters\",\r\n        tags: \"\",\r\n        authorBio: \"\",\r\n        loading: false,\r\n        error: true,\r\n        source: 'error'\r\n      });\r\n    } finally {\r\n      setRefreshing(false);\r\n    }\r\n  };\r\n  \r\n  useEffect(() => {\r\n    // Check if we have a stored quote for today\r\n    const storedQuote = localStorage.getItem('dailyQuote');\r\n    const storedDate = localStorage.getItem('quoteDate');\r\n    const today = new Date().toDateString();\r\n    \r\n    if (storedQuote && storedDate === today) {\r\n      try {\r\n        const parsedQuote = JSON.parse(storedQuote);\r\n        setQuote({\r\n          ...parsedQuote,\r\n          loading: false,\r\n          source: 'cache'\r\n        });\r\n      } catch (e) {\r\n        getQuote();\r\n      }\r\n    } else {\r\n      getQuote();\r\n    }\r\n  }, []);\r\n  \r\n  // Store the quote when we get a new one\r\n  useEffect(() => {\r\n    if (!quote.loading && quote.quote) {\r\n      localStorage.setItem('dailyQuote', JSON.stringify({\r\n        quote: quote.quote,\r\n        author: quote.author,\r\n        tags: quote.tags,\r\n        authorBio: quote.authorBio\r\n      }));\r\n      localStorage.setItem('quoteDate', new Date().toDateString());\r\n    }\r\n  }, [quote]);\r\n\r\n  const copyQuote = () => {\r\n    const textToCopy = `\"${quote.quote}\"  ${quote.author}`;\r\n    navigator.clipboard.writeText(textToCopy)\r\n      .then(() => {\r\n        setShowCopied(true);\r\n        setTimeout(() => setShowCopied(false), 2000);\r\n      })\r\n      .catch(err => console.error('Failed to copy: ', err));\r\n  };\r\n\r\n  const toggleAuthorInfo = () => {\r\n    setShowAuthorInfo(!showAuthorInfo);\r\n  };\r\n\r\n  return (\r\n    <div className=\"daily-quote\">\r\n      <h2>\r\n         Daily Inspiration\r\n        {!isOnline && <span className=\"offline-indicator\">Offline Mode</span>}\r\n      </h2>\r\n      \r\n      <div className={`quote-content ${quote.loading ? 'loading' : ''}`}>\r\n        {quote.loading ? (\r\n          <div className=\"quote-loading\">\r\n            <div className=\"quote-spinner\"></div>\r\n            <p>Finding inspiration...</p>\r\n          </div>\r\n        ) : (\r\n          <>\r\n            <blockquote>\r\n              <p>\"{quote.quote}\"</p>\r\n              <footer>\r\n                <span \r\n                  className={`author-name ${quote.authorBio ? 'has-bio' : ''}`}\r\n                  onClick={quote.authorBio ? toggleAuthorInfo : undefined}\r\n                >\r\n                   {quote.author}\r\n                  {quote.authorBio && <span className=\"info-icon\"></span>}\r\n                </span>\r\n                {quote.source === 'fallback' && <span className=\"offline-quote\">(offline quote)</span>}\r\n              </footer>\r\n              \r\n              {quote.tags && (\r\n                <div className=\"quote-tags\">\r\n                  {quote.tags.split(', ').map(tag => (\r\n                    <span key={tag} className=\"quote-tag\">{tag}</span>\r\n                  ))}\r\n                </div>\r\n              )}\r\n              \r\n              {showAuthorInfo && quote.authorBio && (\r\n                <div className=\"author-bio\">\r\n                  <h4>{quote.author}</h4>\r\n                  <p>{quote.authorBio}</p>\r\n                </div>\r\n              )}\r\n            </blockquote>\r\n            \r\n            <div className=\"quote-actions\">\r\n              <button \r\n                onClick={() => getQuote(true)} \r\n                className=\"refresh-quote\" \r\n                disabled={refreshing || !isOnline}\r\n                aria-label=\"Get a new quote\"\r\n              >\r\n                <span className={`refresh-icon ${refreshing ? 'spinning' : ''}`}></span>\r\n                <span className=\"refresh-text\">{refreshing ? 'Loading...' : 'New Quote'}</span>\r\n              </button>\r\n              \r\n              <button \r\n                onClick={copyQuote} \r\n                className=\"copy-quote\"\r\n                aria-label=\"Copy quote to clipboard\"\r\n              >\r\n                <span className=\"copy-icon\"></span>\r\n                <span className=\"copy-text\">{showCopied ? 'Copied!' : 'Copy'}</span>\r\n              </button>\r\n            </div>\r\n          </>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DailyQuote;","import React, { useState, useEffect } from 'react';\r\nimport { Chart, registerables } from 'chart.js';\r\nimport { Bar } from 'react-chartjs-2';\r\nimport { getMoodEntries } from '../services/storageService';\r\nimport { fetchCurrentWeather, getWeatherIcon, getWeatherDescription, analyzeWeatherMoodPatterns } from '../services/weatherService';\r\nimport './WeatherMood.css';\r\n\r\n// Register Chart.js components\r\nChart.register(...registerables);\r\n\r\nconst WeatherMood = () => {\r\n  const [currentWeather, setCurrentWeather] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [analysis, setAnalysis] = useState(null);\r\n  const [moodEntries, setMoodEntries] = useState([]);\r\n  const [chartType, setChartType] = useState('bar'); // 'bar' or 'radar'\r\n\r\n  // Fetch initial data on component mount\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      setLoading(true);\r\n      try {\r\n        // Get user's location and weather\r\n        const location = await getUserLocation();\r\n        const weatherData = await fetchCurrentWeather(location.latitude, location.longitude);\r\n        setCurrentWeather(weatherData);\r\n        \r\n        // Get mood entries for analysis\r\n        const entries = await getMoodEntries();\r\n        setMoodEntries(entries);\r\n        \r\n        // Analyze weather effects on mood\r\n        const weatherAnalysis = analyzeWeatherMoodPatterns(entries, weatherData);\r\n        setAnalysis(weatherAnalysis);\r\n      } catch (err) {\r\n        console.error('Failed to load weather or mood data:', err);\r\n        setError('Could not load weather or mood data. Please check your internet connection and try again.');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    \r\n    fetchData();\r\n  }, []);\r\n\r\n  // Helper function to get user location\r\n  const getUserLocation = () => {\r\n    return new Promise((resolve) => {\r\n      // Default coordinates if geolocation fails\r\n      const defaultLocation = { latitude: 40.7128, longitude: -74.0060 };\r\n      \r\n      if (!navigator.geolocation) {\r\n        resolve(defaultLocation);\r\n        return;\r\n      }\r\n\r\n      const timeout = setTimeout(() => {\r\n        resolve(defaultLocation);\r\n      }, 5000);\r\n\r\n      navigator.geolocation.getCurrentPosition(\r\n        (position) => {\r\n          clearTimeout(timeout);\r\n          resolve({\r\n            latitude: position.coords.latitude,\r\n            longitude: position.coords.longitude\r\n          });\r\n        },\r\n        () => {\r\n          clearTimeout(timeout);\r\n          resolve(defaultLocation);\r\n        }\r\n      );\r\n    });\r\n  };\r\n\r\n  // Prepare chart data for weather-mood correlation\r\n  const getChartData = () => {\r\n    if (!analysis || !analysis.hasEnoughData) return null;\r\n    \r\n    const weatherTypes = Object.keys(analysis.weatherMoodGroups).filter(\r\n      type => analysis.weatherMoodGroups[type].entries.length > 0\r\n    );\r\n    \r\n    // Get custom colors for each weather type\r\n    const getWeatherColors = (weatherType, alpha = 0.7) => {\r\n      const colors = {\r\n        sunny: `rgba(255, 194, 14, ${alpha})`,  // Bright yellow\r\n        cloudy: `rgba(164, 175, 196, ${alpha})`, // Blue-gray\r\n        rainy: `rgba(86, 141, 198, ${alpha})`,   // Blue\r\n        snowy: `rgba(219, 234, 254, ${alpha})`   // Light blue\r\n      };\r\n      \r\n      return colors[weatherType] || `rgba(150, 150, 150, ${alpha})`;\r\n    };\r\n    \r\n    return {\r\n      labels: weatherTypes.map(type => type.charAt(0).toUpperCase() + type.slice(1)),\r\n      datasets: [\r\n        {\r\n          label: 'Average Mood (1-10)',\r\n          data: weatherTypes.map(type => analysis.weatherMoodGroups[type].avgMood),\r\n          backgroundColor: weatherTypes.map(type => getWeatherColors(type)),\r\n          borderColor: weatherTypes.map(type => getWeatherColors(type, 1)),\r\n          borderWidth: 1,\r\n          borderRadius: 6,\r\n          hoverBackgroundColor: weatherTypes.map(type => getWeatherColors(type, 0.9)),\r\n        }\r\n      ]\r\n    };\r\n  };\r\n  \r\n  // Chart options\r\n  const getChartOptions = () => {\r\n    const baseOptions = {\r\n      responsive: true,\r\n      maintainAspectRatio: false,\r\n      plugins: {\r\n        legend: {\r\n          display: false\r\n        },\r\n        tooltip: {\r\n          backgroundColor: 'rgba(255, 255, 255, 0.9)',\r\n          titleColor: '#333',\r\n          bodyColor: '#555',\r\n          borderColor: '#ddd',\r\n          borderWidth: 1,\r\n          padding: 10,\r\n          displayColors: false,\r\n          callbacks: {\r\n            title: function(context) {\r\n              return `${context[0].label} Weather`;\r\n            },\r\n            label: function(context) {\r\n              return `Average Mood: ${context.parsed.y.toFixed(1)}/10`;\r\n            },\r\n            afterLabel: function(context) {\r\n              const index = context.dataIndex;\r\n              const weatherType = Object.keys(analysis.weatherMoodGroups)[index];\r\n              const count = analysis.weatherMoodGroups[weatherType].count || 0;\r\n              return `Based on ${count} entries`;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    };\r\n    \r\n    // Specific options for bar chart\r\n    if (chartType === 'bar') {\r\n      return {\r\n        ...baseOptions,\r\n        scales: {\r\n          y: {\r\n            beginAtZero: false,\r\n            min: 1,\r\n            max: 10,\r\n            ticks: {\r\n              stepSize: 1,\r\n              color: '#666'\r\n            },\r\n            grid: {\r\n              color: 'rgba(0, 0, 0, 0.05)'\r\n            },\r\n            title: {\r\n              display: true,\r\n              text: 'Mood Level',\r\n              color: '#555',\r\n              font: {\r\n                weight: 'bold'\r\n              }\r\n            }\r\n          },\r\n          x: {\r\n            grid: {\r\n              display: false\r\n            },\r\n            ticks: {\r\n              color: '#666'\r\n            }\r\n          }\r\n        },\r\n        animation: {\r\n          duration: 2000,\r\n          easing: 'easeOutQuart'\r\n        }\r\n      };\r\n    }\r\n    \r\n    // Specific options for radar chart\r\n    return {\r\n      ...baseOptions,\r\n      scales: {\r\n        r: {\r\n          min: 1,\r\n          max: 10,\r\n          ticks: {\r\n            stepSize: 1,\r\n            color: '#666',\r\n            backdropColor: 'transparent'\r\n          },\r\n          angleLines: {\r\n            color: 'rgba(0, 0, 0, 0.1)'\r\n          },\r\n          grid: {\r\n            color: 'rgba(0, 0, 0, 0.1)'\r\n          },\r\n          pointLabels: {\r\n            color: '#333',\r\n            font: {\r\n              size: 12\r\n            }\r\n          }\r\n        }\r\n      }\r\n    };\r\n  };\r\n\r\n  // Format current temperature\r\n  const formatTemperature = (temp) => {\r\n    return `${Math.round(temp)}C`;\r\n  };\r\n\r\n  // Calculate time since weather was last fetched\r\n  const getWeatherTimeAgo = () => {\r\n    if (!currentWeather || !currentWeather.timestamp) return '';\r\n    \r\n    const now = Date.now();\r\n    const timestamp = currentWeather.timestamp;\r\n    const diff = now - timestamp;\r\n    \r\n    // Convert to minutes\r\n    const minutes = Math.floor(diff / 60000);\r\n    \r\n    if (minutes < 1) return 'just now';\r\n    if (minutes === 1) return '1 minute ago';\r\n    if (minutes < 60) return `${minutes} minutes ago`;\r\n    \r\n    // Convert to hours\r\n    const hours = Math.floor(minutes / 60);\r\n    if (hours === 1) return '1 hour ago';\r\n    if (hours < 24) return `${hours} hours ago`;\r\n    \r\n    // Convert to days\r\n    const days = Math.floor(hours / 24);\r\n    if (days === 1) return 'yesterday';\r\n    return `${days} days ago`;\r\n  };\r\n\r\n  return (\r\n    <div className=\"weather-mood\">\r\n      <h2>Weather & Mood Insights</h2>\r\n      \r\n      {loading ? (\r\n        <div className=\"weather-loading\">\r\n          <div className=\"weather-spinner\"></div>\r\n          <p>Loading weather data and analyzing your mood patterns...</p>\r\n        </div>\r\n      ) : error ? (\r\n        <div className=\"weather-error\">\r\n          <p>{error}</p>\r\n          <button onClick={() => window.location.reload()} className=\"reload-button\">\r\n            Try Again\r\n          </button>\r\n        </div>\r\n      ) : (\r\n        <>\r\n          {currentWeather && currentWeather.current && (\r\n            <div className=\"current-weather\">\r\n              <div className=\"weather-icon-large\">\r\n                {getWeatherIcon(currentWeather.current.weather_code, currentWeather.current.is_day)}\r\n              </div>\r\n              <div className=\"weather-details\">\r\n                <h3>Current Weather</h3>\r\n                <div className=\"weather-temp\">\r\n                  {formatTemperature(currentWeather.current.temperature_2m)}\r\n                </div>\r\n                <div className=\"weather-desc\">\r\n                  {getWeatherDescription(currentWeather.current.weather_code)}\r\n                </div>\r\n                <div className=\"weather-meta\">\r\n                  <span>Feels like {formatTemperature(currentWeather.current.apparent_temperature)}</span>\r\n                  <span> Humidity: {currentWeather.current.relative_humidity_2m}%</span>\r\n                  <span className=\"cached-indicator\">Updated {getWeatherTimeAgo()}</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          <div className=\"mood-weather-analysis\">\r\n            <h3>How Weather Affects Your Mood</h3>\r\n            \r\n            {!analysis || !analysis.hasEnoughData ? (\r\n              <div className=\"no-data-message\">\r\n                <p>{analysis?.message || \"Not enough data to analyze weather effects on your mood yet.\"}</p>\r\n                <p>Keep logging your daily entries to see patterns emerge!</p>\r\n              </div>\r\n            ) : (\r\n              <>\r\n                <div className=\"chart-type-toggle\">\r\n                  <button \r\n                    className={`chart-type-btn ${chartType === 'bar' ? 'active' : ''}`}\r\n                    onClick={() => setChartType('bar')}\r\n                  >\r\n                    Bar Chart\r\n                  </button>\r\n                  <button \r\n                    className={`chart-type-btn ${chartType === 'radar' ? 'active' : ''}`}\r\n                    onClick={() => setChartType('radar')}\r\n                  >\r\n                    Radar Chart\r\n                  </button>\r\n                </div>\r\n              \r\n                <div className=\"chart-container\">\r\n                  {chartType === 'bar' ? (\r\n                    <Bar data={getChartData()} options={getChartOptions()} />\r\n                  ) : (\r\n                    <Chart type=\"radar\" data={getChartData()} options={getChartOptions()} />\r\n                  )}\r\n                </div>\r\n                \r\n                <div className=\"insights-container\">\r\n                  <h4>Insights</h4>\r\n                  <ul className=\"insights-list\">\r\n                    {analysis.insights.map((insight, index) => (\r\n                      <li \r\n                        key={index} \r\n                        className={`insight-item insight-${insight.type}`}\r\n                      >\r\n                        {insight.text}\r\n                      </li>\r\n                    ))}\r\n                    \r\n                    {analysis.insights.length === 0 && (\r\n                      <li className=\"insight-item insight-neutral\">\r\n                        Weather doesn't appear to have a strong effect on your mood based on current data.\r\n                      </li>\r\n                    )}\r\n                  </ul>\r\n                </div>\r\n              </>\r\n            )}\r\n          </div>\r\n          \r\n          <div className=\"weather-tips\">\r\n            <h4>Weather Wellness Tips</h4>\r\n            {currentWeather && currentWeather.current && (\r\n              <div className=\"tips-container\">\r\n                {currentWeather.current.weather_code <= 1 && (\r\n                  <p> <strong>Sunny day tip:</strong> Sunshine boosts vitamin D production, which can improve mood. Consider spending 15-20 minutes outside.</p>\r\n                )}\r\n                \r\n                {currentWeather.current.weather_code >= 2 && currentWeather.current.weather_code <= 3 && (\r\n                  <p> <strong>Cloudy day tip:</strong> Cloudy days can sometimes affect mood. Try brightening your environment with good lighting.</p>\r\n                )}\r\n                \r\n                {currentWeather.current.weather_code >= 51 && currentWeather.current.weather_code <= 67 && (\r\n                  <p> <strong>Rainy day tip:</strong> The sound of rain can be calming. Consider mindful listening or using the day for cozy indoor activities.</p>\r\n                )}\r\n                \r\n                {currentWeather.current.weather_code >= 71 && currentWeather.current.weather_code <= 86 && (\r\n                  <p> <strong>Snowy day tip:</strong> Cold weather can make us less active. Try to maintain physical movement indoors.</p>\r\n                )}\r\n                \r\n                {currentWeather.current.weather_code >= 95 && (\r\n                  <p> <strong>Stormy day tip:</strong> Storms can trigger anxiety in some people. Practice deep breathing exercises if you feel anxious.</p>\r\n                )}\r\n                \r\n                <p className=\"general-tip\">\r\n                  Being aware of how weather affects your mood can help you prepare and adapt your self-care routines.\r\n                </p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default WeatherMood;","/**\r\n * Service to detect user's location using ipapi.co\r\n */\r\n\r\n// Cache the location data\r\nlet cachedLocationData = null;\r\nlet cacheTTL = 24 * 60 * 60 * 1000; // 24 hours in milliseconds\r\nlet cacheTimestamp = 0;\r\n\r\n/**\r\n * Get the user's country based on IP address\r\n * @returns {Promise<Object>} Promise resolving to country info\r\n */\r\nexport const getUserCountry = async () => {\r\n  // Return cached data if it's still valid\r\n  if (cachedLocationData && (Date.now() - cacheTimestamp) < cacheTTL) {\r\n    return cachedLocationData;\r\n  }\r\n\r\n  try {\r\n    // Check if we're offline\r\n    if (!navigator.onLine) {\r\n      // Try to get from local storage\r\n      const storedLocation = localStorage.getItem('userCountry');\r\n      if (storedLocation) {\r\n        return JSON.parse(storedLocation);\r\n      }\r\n      throw new Error('Offline and no cached location data');\r\n    }\r\n\r\n    // Fetch from ipapi.co\r\n    const response = await fetch('https://ipapi.co/json/', {\r\n      signal: AbortSignal.timeout(5000) // 5 second timeout\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`Geolocation API error: ${response.status}`);\r\n    }\r\n\r\n    const data = await response.json();\r\n    \r\n    // Store in cache and localStorage\r\n    cachedLocationData = {\r\n      country: data.country_name,\r\n      countryCode: data.country_code,\r\n      city: data.city,\r\n      region: data.region,\r\n      source: 'api'\r\n    };\r\n    \r\n    cacheTimestamp = Date.now();\r\n    localStorage.setItem('userCountry', JSON.stringify(cachedLocationData));\r\n    \r\n    return cachedLocationData;\r\n  } catch (error) {\r\n    console.error('Failed to detect country:', error);\r\n    \r\n    // Return default if we can't get location\r\n    return {\r\n      country: 'United States',\r\n      countryCode: 'US',\r\n      source: 'default'\r\n    };\r\n  }\r\n};","/**\r\n * Crisis hotlines data by country\r\n * Source: Compiled from Wikipedia and various national mental health resources\r\n */\r\n\r\nconst crisisHotlines = [\r\n  {\r\n    country: \"Algeria\",\r\n    countryCode: \"DZ\",\r\n    hotlines: [\r\n      {\r\n        name: \"National Police\",\r\n        phone: \"17\",\r\n        description: \"National police emergency number in Algeria\"\r\n      },\r\n      {\r\n        name: \"National Ambulance\",\r\n        phone: \"43\",\r\n        description: \"National ambulance emergency number in Algeria\"\r\n      },\r\n      {\r\n        name: \"Fire Brigade\",\r\n        phone: \"14\",\r\n        description: \"National fire brigade number in Algeria\"\r\n      },\r\n      {\r\n        name: \"National Gendarmerie\",\r\n        phone: \"1055\",\r\n        description: \"National gendarmerie number in Algeria\"\r\n      },\r\n      {\r\n        name: \"Suicide Hotline Algeria\",\r\n        phone: \"0021 3983 2000 58\",\r\n        description: \"Crisis support service in Algeria\"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    country: \"Argentina\",\r\n    countryCode: \"AR\",\r\n    hotlines: [\r\n      {\r\n        name: \"National Emergency Number\",\r\n        phone: \"911\",\r\n        description: \"National emergency number in Argentina\"\r\n      },\r\n      {\r\n        name: \"Centro de Asistencia al Suicida\",\r\n        phone: \"135\",\r\n        altPhone: \"5275-1135\",\r\n        description: \"Crisis support for Greater Buenos Aires and rest of the country\",\r\n        website: \"https://www.asistencialsuicida.org.ar/\"\r\n      },\r\n      {\r\n        name: \"SOS Un Amigo Anonimo\",\r\n        phone: \"5263-0583\",\r\n        description: \"Available Monday to Friday from 10am to 7pm and Saturdays from 10am to 4pm\"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    country: \"Armenia\",\r\n    countryCode: \"AM\",\r\n    hotlines: [\r\n      {\r\n        name: \"National Emergency Number\",\r\n        phone: \"112\",\r\n        altPhone: \"911\",\r\n        description: \"National emergency numbers in Armenia\"\r\n      },\r\n      {\r\n        name: \"Trust Social Work and Sociological Research Centre\",\r\n        phone: \"(2) 538194\",\r\n        altPhone: \"(2) 538197\",\r\n        description: \"Crisis support service in Armenia\"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    country: \"Australia\",\r\n    countryCode: \"AU\",\r\n    hotlines: [\r\n      {\r\n        name: \"National Emergency Number\",\r\n        phone: \"000\",\r\n        altPhone: \"112\",\r\n        description: \"National emergency numbers in Australia\"\r\n      },\r\n      {\r\n        name: \"Lifeline\",\r\n        phone: \"13 11 14\",\r\n        description: \"24-hour nationwide service for crisis support, suicide prevention and mental health support\",\r\n        website: \"https://www.lifeline.org.au/\"\r\n      },\r\n      {\r\n        name: \"Kids Helpline\",\r\n        phone: \"1800 55 1800\",\r\n        description: \"24-hour support for Australians aged 5-25\",\r\n        website: \"https://kidshelpphone.ca/\"\r\n      },\r\n      {\r\n        name: \"Beyond Blue\",\r\n        phone: \"1300 224 636\",\r\n        description: \"24/7 information and support for anxiety, depression, and suicide\",\r\n        website: \"https://www.beyondblue.org.au/\"\r\n      },\r\n      {\r\n        name: \"Suicide Call Back Service\",\r\n        phone: \"1300 659 467\",\r\n        description: \"Professional 24/7 telephone and online counselling\",\r\n        website: \"https://www.suicidecallbackservice.org.au/\"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    country: \"Austria\",\r\n    countryCode: \"AT\",\r\n    hotlines: [\r\n      {\r\n        name: \"National Emergency Number\",\r\n        phone: \"112\",\r\n        description: \"National emergency number in Austria\"\r\n      },\r\n      {\r\n        name: \"Telefonseelsorge\",\r\n        phone: \"142\",\r\n        description: \"Free of charge emotional support, operating 24 hours a day\",\r\n        website: \"https://www.telefonseelsorge.at/\"\r\n      },\r\n      {\r\n        name: \"Rat auf Draht\",\r\n        phone: \"147\",\r\n        description: \"Crisis support for children, juveniles and their attachment figures, 24/7\",\r\n        website: \"https://www.rataufdraht.at/\"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    country: \"Bangladesh\",\r\n    countryCode: \"BD\",\r\n    hotlines: [\r\n      {\r\n        name: \"National Emergency Number\",\r\n        phone: \"999\",\r\n        description: \"National emergency number in Bangladesh\"\r\n      },\r\n      {\r\n        name: \"Kaan Pete Roi\",\r\n        phone: \"+88 09612 119911\",\r\n        description: \"Emotional support helpline for people with feelings of despair, isolation, distress or suicidal feelings\",\r\n        website: \"https://shuni.org/\"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    country: \"Brazil\",\r\n    countryCode: \"BR\",\r\n    hotlines: [\r\n      {\r\n        name: \"National Emergency Number\",\r\n        phone: \"190\",\r\n        description: \"National emergency number in Brazil\"\r\n      },\r\n      {\r\n        name: \"National Suicide Hotline\",\r\n        phone: \"188\",\r\n        description: \"National suicide prevention hotline in Brazil\"\r\n      },\r\n      {\r\n        name: \"Centro de Valorizao da Vida\",\r\n        phone: \"188\",\r\n        description: \"Emotional and suicidal prevention support, 24/7\",\r\n        website: \"https://www.cvv.org.br/\"\r\n      },\r\n      {\r\n        name: \"TouchPeace\",\r\n        description: \"Free emotional support via video call, available 24/7\",\r\n        website: \"https://www.touchpeace.org/\"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    country: \"Canada\",\r\n    countryCode: \"CA\",\r\n    hotlines: [\r\n      {\r\n        name: \"National Emergency Number\",\r\n        phone: \"911\",\r\n        description: \"National emergency number in Canada\"\r\n      },\r\n      {\r\n        name: \"Suicide Crisis Helpline\",\r\n        phone: \"988\",\r\n        description: \"24/7 suicide crisis helpline in both English and French\",\r\n        website: \"https://www.canada.ca/en/public-health/services/suicide-prevention/warning-signs.html\"\r\n      },\r\n      {\r\n        name: \"Kids Help Phone\",\r\n        phone: \"1-800-668-6868\",\r\n        altPhone: \"Text CONNECT to 686868\",\r\n        description: \"24/7 national support service for youth in English and French\",\r\n        website: \"https://kidshelpphone.ca/\"\r\n      },\r\n      {\r\n        name: \"Talk Suicide Canada\",\r\n        phone: \"1-833-456-4566\",\r\n        altPhone: \"Text 45645\",\r\n        description: \"Nationwide suicide prevention service, 24/7\",\r\n        website: \"https://talksuicide.ca/\"\r\n      },\r\n      {\r\n        name: \"Trans Lifeline\",\r\n        phone: \"1-877-330-6366\",\r\n        description: \"Crisis hotline for transgender people, staffed by transgender individuals\",\r\n        website: \"http://www.translifeline.org/\"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    country: \"China\",\r\n    countryCode: \"CN\",\r\n    hotlines: [\r\n      {\r\n        name: \"Police Emergency\",\r\n        phone: \"110\",\r\n        description: \"National police emergency number in China\"\r\n      },\r\n      {\r\n        name: \"Ambulance Emergency\",\r\n        phone: \"120\",\r\n        description: \"National ambulance emergency number in China\"\r\n      },\r\n      {\r\n        name: \"Beijing Suicide Research and Prevention Center\",\r\n        phone: \"800-810-1117\",\r\n        altPhone: \"010-8295-1332\",\r\n        description: \"24/7 suicide prevention service\",\r\n        website: \"http://www.crisis.org.cn\"\r\n      },\r\n      {\r\n        name: \"Lifeline China\",\r\n        phone: \"400 821 1215\",\r\n        description: \"Available 10am to 10pm every day\",\r\n        website: \"https://www.lifelinechina.org/\"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    country: \"France\",\r\n    countryCode: \"FR\",\r\n    hotlines: [\r\n      {\r\n        name: \"National Emergency Number\",\r\n        phone: \"112\",\r\n        description: \"National emergency number in France\"\r\n      },\r\n      {\r\n        name: \"Suicide Prevention Hotline\",\r\n        phone: \"3114\",\r\n        description: \"National suicide prevention hotline, 24/7\",\r\n        website: \"https://3114.fr/\"\r\n      },\r\n      {\r\n        name: \"SOS Amiti\",\r\n        phone: \"09 72 39 40 50\",\r\n        description: \"Distress listening service on multimedia platform: phone, email, chat\",\r\n        website: \"https://www.sos-amitie.com/\"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    country: \"Germany\",\r\n    countryCode: \"DE\",\r\n    hotlines: [\r\n      {\r\n        name: \"National Emergency Number\",\r\n        phone: \"112\",\r\n        description: \"National emergency number for fire and ambulance in Germany\"\r\n      },\r\n      {\r\n        name: \"Police Emergency\",\r\n        phone: \"110\",\r\n        description: \"National emergency number for police in Germany\"\r\n      },\r\n      {\r\n        name: \"Telefonseelsorge\",\r\n        phone: \"0800 111 0 111\",\r\n        altPhone: \"0800 111 0 222\",\r\n        description: \"24/7 telephone counseling service\",\r\n        website: \"http://www.telefonseelsorge.de/\"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    country: \"India\",\r\n    countryCode: \"IN\",\r\n    hotlines: [\r\n      {\r\n        name: \"National Emergency Number\",\r\n        phone: \"112\",\r\n        description: \"National emergency number in India\"\r\n      },\r\n      {\r\n        name: \"Kiran Mental Health Helpline\",\r\n        phone: \"1800-599-0019\",\r\n        description: \"24/7 toll-free helpline for suicidal thoughts, depression and mental health issues\"\r\n      },\r\n      {\r\n        name: \"AASRA\",\r\n        phone: \"+91-22-27546669\",\r\n        description: \"24/7 voluntary, professional and confidential services\",\r\n        website: \"http://www.aasra.info/\"\r\n      },\r\n      {\r\n        name: \"Vandrevala Foundation\",\r\n        phone: \"+91 9999666555\",\r\n        description: \"24/7 helpline for psychological counselling and crisis intervention\",\r\n        website: \"http://www.vandrevalafoundation.com\"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    country: \"Ireland\",\r\n    countryCode: \"IE\",\r\n    hotlines: [\r\n      {\r\n        name: \"National Emergency Number\",\r\n        phone: \"112\",\r\n        altPhone: \"999\",\r\n        description: \"National emergency numbers in Ireland\"\r\n      },\r\n      {\r\n        name: \"Samaritans\",\r\n        phone: \"116 123\",\r\n        description: \"Free emotional support to anyone in distress or at risk of suicide\",\r\n        website: \"http://www.samaritans.org/\"\r\n      },\r\n      {\r\n        name: \"Text Crisis Service\",\r\n        phone: \"Text HELLO to 50808\",\r\n        description: \"Free, confidential 24/7 national crisis-intervention text-message service\",\r\n        website: \"https://text50808.ie/\"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    country: \"Japan\",\r\n    countryCode: \"JP\",\r\n    hotlines: [\r\n      {\r\n        name: \"National Emergency Number\",\r\n        phone: \"110\",\r\n        altPhone: \"119\",\r\n        description: \"National emergency numbers in Japan\"\r\n      },\r\n      {\r\n        name: \"TELL Lifeline\",\r\n        phone: \"03-5774-0992\",\r\n        description: \"English-language counseling service\",\r\n        website: \"http://telljp.com/lifeline/\"\r\n      },\r\n      {\r\n        name: \"Federation of Inochi No Denwa\",\r\n        phone: \"0120-783-556\",\r\n        description: \"Japanese-language suicide prevention hotline\",\r\n        website: \"https://www.inochinodenwa.org/\"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    country: \"South Africa\",\r\n    countryCode: \"ZA\",\r\n    hotlines: [\r\n      {\r\n        name: \"National Emergency Number (Police)\",\r\n        phone: \"10111\",\r\n        description: \"National police emergency number in South Africa\"\r\n      },\r\n      {\r\n        name: \"National Emergency Number (Ambulance)\",\r\n        phone: \"10177\",\r\n        description: \"National ambulance emergency number in South Africa\"\r\n      },\r\n      {\r\n        name: \"Suicide Crisis Line\",\r\n        phone: \"0800 567 567\",\r\n        altPhone: \"SMS 31393\",\r\n        description: \"Crisis support for suicidal individuals\"\r\n      },\r\n      {\r\n        name: \"South African Depression and Anxiety Group\",\r\n        phone: \"0800 456 789\",\r\n        altPhone: \"0800 567 567\",\r\n        description: \"Suicide crisis helpline, 8am-8pm daily\",\r\n        website: \"https://www.sadag.org/\"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    country: \"United Kingdom\",\r\n    countryCode: \"GB\",\r\n    hotlines: [\r\n      {\r\n        name: \"National Emergency Number\",\r\n        phone: \"999\",\r\n        altPhone: \"112\",\r\n        description: \"National emergency numbers in the United Kingdom\"\r\n      },\r\n      {\r\n        name: \"Samaritans\",\r\n        phone: \"116 123\",\r\n        description: \"24/7 support for anyone in distress or at risk of suicide\",\r\n        website: \"http://www.samaritans.org/\"\r\n      },\r\n      {\r\n        name: \"CALM (Campaign Against Living Miserably)\",\r\n        phone: \"0800 58 58 58\",\r\n        description: \"Helpline for men, open 5pm-midnight every day\",\r\n        website: \"https://www.thecalmzone.net/\"\r\n      },\r\n      {\r\n        name: \"SHOUT\",\r\n        phone: \"Text SHOUT to 85258\",\r\n        description: \"UK's free 24/7 text service for anyone in crisis\",\r\n        website: \"https://www.giveusashout.org/\"\r\n      },\r\n      {\r\n        name: \"PAPYRUS Prevention of Young Suicide\",\r\n        phone: \"0800 068 4141\",\r\n        altPhone: \"Text 07860039967\",\r\n        description: \"Support for young people struggling with suicidal thoughts\",\r\n        website: \"https://www.papyrus-uk.org/\"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    country: \"United States\",\r\n    countryCode: \"US\",\r\n    hotlines: [\r\n      {\r\n        name: \"National Emergency Number\",\r\n        phone: \"911\",\r\n        description: \"National emergency number in the United States\"\r\n      },\r\n      {\r\n        name: \"988 Suicide & Crisis Lifeline\",\r\n        phone: \"988\",\r\n        altPhone: \"1-800-273-8255\",\r\n        description: \"24/7 free support for people in suicidal crisis or emotional distress\",\r\n        website: \"https://988lifeline.org/\"\r\n      },\r\n      {\r\n        name: \"Crisis Text Line\",\r\n        phone: \"Text HOME to 741741\",\r\n        description: \"24/7 crisis-intervention text-message service\",\r\n        website: \"https://www.crisistextline.org/\"\r\n      },\r\n      {\r\n        name: \"Veterans Crisis Line\",\r\n        phone: \"988, then Press 1\",\r\n        altPhone: \"1-800-273-8255, Press 1\",\r\n        description: \"Crisis support for military veterans and their families\",\r\n        website: \"https://www.veteranscrisisline.net/\"\r\n      },\r\n      {\r\n        name: \"The Trevor Project\",\r\n        phone: \"1-866-488-7386\",\r\n        altPhone: \"Text START to 678-678\",\r\n        description: \"Crisis support for LGBTQ+ youth\",\r\n        website: \"http://www.thetrevorproject.org/\"\r\n      },\r\n      {\r\n        name: \"Trans Lifeline\",\r\n        phone: \"1-877-565-8860\",\r\n        description: \"Crisis hotline for transgender people, staffed by transgender individuals\",\r\n        website: \"https://www.translifeline.org/\"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    country: \"International\",\r\n    countryCode: \"INTL\",\r\n    hotlines: [\r\n      {\r\n        name: \"International Association for Suicide Prevention\",\r\n        description: \"Find crisis centers around the world\",\r\n        website: \"https://www.iasp.info/resources/Crisis_Centres/\"\r\n      },\r\n      {\r\n        name: \"Befrienders Worldwide\",\r\n        description: \"Global network of helplines providing emotional support\",\r\n        website: \"https://www.befrienders.org/\"\r\n      }\r\n    ]\r\n  }\r\n];\r\n\r\nexport default crisisHotlines;\r\n\r\n/**\r\n * Find hotlines for a specific country code\r\n * @param {string} countryCode - Two-letter country code\r\n * @returns {Object|null} Country hotlines or null if not found\r\n */\r\nexport const getHotlinesForCountry = (countryCode) => {\r\n  if (!countryCode) return null;\r\n  \r\n  // Normalize country code to uppercase\r\n  const normalizedCode = countryCode.toUpperCase();\r\n  \r\n  // Find matching country\r\n  const country = crisisHotlines.find(c => c.countryCode === normalizedCode);\r\n  \r\n  // Return country data or international as fallback\r\n  return country || crisisHotlines.find(c => c.countryCode === \"INTL\");\r\n};\r\n\r\n/**\r\n * Get all available countries with hotlines\r\n * @returns {Array} List of countries with their codes\r\n */\r\nexport const getAvailableCountries = () => {\r\n  return crisisHotlines.map(country => ({\r\n    name: country.country,\r\n    code: country.countryCode\r\n  }));\r\n};","/**\r\n * Service to fetch and parse crisis hotline data from Wikipedia\r\n */\r\n\r\n// Cache configuration\r\nconst CACHE_KEY = 'wikiHotlinesCache';\r\nconst CACHE_TTL = 7 * 24 * 60 * 60 * 1000; // 7 days in milliseconds\r\n\r\n/**\r\n * Fetches crisis hotlines from Wikipedia and caches them\r\n * @returns {Promise<Array>} Array of country hotline objects\r\n */\r\nexport const fetchWikipediaCrisisHotlines = async (forceRefresh = false) => {\r\n  try {\r\n    // Check if we're offline\r\n    if (!navigator.onLine) {\r\n      const cachedData = localStorage.getItem(CACHE_KEY);\r\n      if (cachedData) {\r\n        const { hotlines, timestamp } = JSON.parse(cachedData);\r\n        console.log('Using cached Wikipedia hotlines (offline)');\r\n        return hotlines;\r\n      }\r\n      throw new Error('Offline and no cached hotlines');\r\n    }\r\n\r\n    // Check cache if not forcing refresh\r\n    if (!forceRefresh) {\r\n      const cachedData = localStorage.getItem(CACHE_KEY);\r\n      if (cachedData) {\r\n        const { hotlines, timestamp } = JSON.parse(cachedData);\r\n        // Use cache if it's not expired\r\n        if (Date.now() - timestamp < CACHE_TTL) {\r\n          console.log('Using cached Wikipedia hotlines');\r\n          return hotlines;\r\n        }\r\n      }\r\n    }\r\n\r\n    // Fetch data from Wikipedia\r\n    console.log('Fetching hotlines from Wikipedia...');\r\n    const response = await fetch(\r\n      'https://corsproxy.org/?' + encodeURIComponent('https://en.wikipedia.org/wiki/List_of_suicide_crisis_lines'), \r\n      {\r\n        signal: AbortSignal.timeout(10000) // 10 second timeout\r\n      }\r\n    );\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`Failed to fetch from Wikipedia: ${response.status}`);\r\n    }\r\n\r\n    const html = await response.text();\r\n    \r\n    // Parse the HTML\r\n    const hotlines = parseWikipediaHotlines(html);\r\n\r\n    // Cache the results\r\n    localStorage.setItem(CACHE_KEY, JSON.stringify({\r\n      hotlines,\r\n      timestamp: Date.now()\r\n    }));\r\n\r\n    return hotlines;\r\n  } catch (error) {\r\n    console.error('Error fetching Wikipedia crisis hotlines:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Parse Wikipedia HTML to extract crisis hotline data\r\n * @param {string} html - HTML content of the Wikipedia page\r\n * @returns {Array} Array of parsed hotline data\r\n */\r\nconst parseWikipediaHotlines = (html) => {\r\n  // Create a temporary DOM element to parse the HTML\r\n  const parser = new DOMParser();\r\n  const doc = parser.parseFromString(html, 'text/html');\r\n  \r\n  // Find the main table with the hotlines\r\n  const table = doc.querySelector('.wikitable');\r\n  if (!table) {\r\n    throw new Error('Could not find hotlines table on Wikipedia page');\r\n  }\r\n  \r\n  // Extract table rows (skip the header row)\r\n  const rows = Array.from(table.querySelectorAll('tr')).slice(1);\r\n  \r\n  // Parse each row into a country hotline object\r\n  const hotlinesData = rows.map(row => {\r\n    const columns = row.querySelectorAll('td');\r\n    \r\n    // Some rows might be layout elements, skip if not enough columns\r\n    if (columns.length < 2) return null;\r\n    \r\n    // Extract the country name\r\n    const countryColumn = columns[0];\r\n    const country = countryColumn.textContent.trim();\r\n    \r\n    // Try to find country code (this is a simplification)\r\n    const countryCode = getCountryCode(country);\r\n    \r\n    // Extract hotlines (organizations and numbers)\r\n    const hotlines = [];\r\n    for (let i = 1; i < columns.length; i += 2) {\r\n      const orgColumn = columns[i];\r\n      const numberColumn = columns[i+1];\r\n      \r\n      if (!orgColumn || !numberColumn) continue;\r\n      \r\n      const orgLinks = orgColumn.querySelectorAll('a');\r\n      let name = orgColumn.textContent.trim();\r\n      let website = null;\r\n      \r\n      // Try to extract website URL if available\r\n      if (orgLinks && orgLinks.length > 0) {\r\n        const href = orgLinks[0].getAttribute('href');\r\n        if (href && href.startsWith('http')) {\r\n          website = href;\r\n        } else if (href && href.startsWith('/wiki/')) {\r\n          website = `https://en.wikipedia.org${href}`;\r\n        }\r\n      }\r\n      \r\n      // Extract phone number(s)\r\n      const phoneText = numberColumn ? numberColumn.textContent.trim() : '';\r\n      const phones = phoneText\r\n        .split(/[,;\\n]/)\r\n        .map(p => p.trim())\r\n        .filter(p => p.length > 0);\r\n      \r\n      if (phones.length > 0) {\r\n        hotlines.push({\r\n          name,\r\n          phone: phones[0],\r\n          altPhone: phones.length > 1 ? phones[1] : null,\r\n          description: `Crisis support service in ${country}`,\r\n          website\r\n        });\r\n      }\r\n    }\r\n    \r\n    if (hotlines.length === 0) return null;\r\n    \r\n    return {\r\n      country,\r\n      countryCode,\r\n      hotlines\r\n    };\r\n  }).filter(Boolean); // Remove nulls\r\n  \r\n  return hotlinesData;\r\n};\r\n\r\n/**\r\n * Simple mapping of country names to country codes\r\n * @param {string} countryName \r\n * @returns {string} Two-letter country code\r\n */\r\nconst getCountryCode = (countryName) => {\r\n  const countryMap = {\r\n    'Argentina': 'AR',\r\n    'Australia': 'AU',\r\n    'Austria': 'AT',\r\n    'Belgium': 'BE',\r\n    'Brazil': 'BR',\r\n    'Bulgaria': 'BG',\r\n    'Canada': 'CA',\r\n    'China': 'CN',\r\n    'Croatia': 'HR',\r\n    'Cyprus': 'CY',\r\n    'Czech Republic': 'CZ',\r\n    'Denmark': 'DK',\r\n    'Estonia': 'EE',\r\n    'Finland': 'FI',\r\n    'France': 'FR',\r\n    'Germany': 'DE',\r\n    'Greece': 'GR',\r\n    'Hong Kong': 'HK',\r\n    'Hungary': 'HU',\r\n    'Iceland': 'IS',\r\n    'India': 'IN',\r\n    'Iran': 'IR',\r\n    'Ireland': 'IE',\r\n    'Israel': 'IL',\r\n    'Italy': 'IT',\r\n    'Japan': 'JP',\r\n    'Jordan': 'JO',\r\n    'Latvia': 'LV',\r\n    'Lebanon': 'LB',\r\n    'Lithuania': 'LT',\r\n    'Luxembourg': 'LU',\r\n    'Malaysia': 'MY',\r\n    'Malta': 'MT',\r\n    'Mexico': 'MX',\r\n    'Netherlands': 'NL',\r\n    'New Zealand': 'NZ',\r\n    'Norway': 'NO',\r\n    'Philippines': 'PH',\r\n    'Poland': 'PL',\r\n    'Portugal': 'PT',\r\n    'Romania': 'RO',\r\n    'Russia': 'RU',\r\n    'Serbia': 'RS',\r\n    'Singapore': 'SG',\r\n    'Slovakia': 'SK',\r\n    'Slovenia': 'SI',\r\n    'South Africa': 'ZA',\r\n    'South Korea': 'KR',\r\n    'Spain': 'ES',\r\n    'Sri Lanka': 'LK',\r\n    'Sweden': 'SE',\r\n    'Switzerland': 'CH',\r\n    'Taiwan': 'TW',\r\n    'Thailand': 'TH',\r\n    'Trinidad and Tobago': 'TT',\r\n    'Turkey': 'TR',\r\n    'Ukraine': 'UA',\r\n    'United Arab Emirates': 'AE',\r\n    'United Kingdom': 'GB',\r\n    'United States': 'US',\r\n    'Uruguay': 'UY',\r\n    'Venezuela': 'VE',\r\n    'Vietnam': 'VN'\r\n  };\r\n  \r\n  // Try direct mapping first\r\n  if (countryMap[countryName]) {\r\n    return countryMap[countryName];\r\n  }\r\n  \r\n  // Try to find a partial match\r\n  for (const [name, code] of Object.entries(countryMap)) {\r\n    if (countryName.includes(name) || name.includes(countryName)) {\r\n      return code;\r\n    }\r\n  }\r\n  \r\n  // Default to INTL for unknown countries\r\n  return 'INTL';\r\n};\r\n\r\n/**\r\n * Get the last fetch timestamp for Wikipedia data\r\n * @returns {Object} Timestamp and age information\r\n */\r\nexport const getWikiHotlinesCacheInfo = () => {\r\n  const cachedData = localStorage.getItem(CACHE_KEY);\r\n  if (!cachedData) {\r\n    return { \r\n      timestamp: null, \r\n      age: null,\r\n      exists: false \r\n    };\r\n  }\r\n  \r\n  const { timestamp } = JSON.parse(cachedData);\r\n  const now = Date.now();\r\n  const age = now - timestamp;\r\n  const ageInDays = Math.floor(age / (24 * 60 * 60 * 1000));\r\n  \r\n  return {\r\n    timestamp: new Date(timestamp).toLocaleString(),\r\n    age: ageInDays === 0 \r\n      ? 'today' \r\n      : ageInDays === 1 \r\n        ? 'yesterday' \r\n        : `${ageInDays} days ago`,\r\n    exists: true\r\n  };\r\n};","import staticHotlines from '../data/crisisHotlines';\r\nimport { fetchWikipediaCrisisHotlines, getWikiHotlinesCacheInfo } from './wikiHotlineService';\r\n\r\n/**\r\n * Get combined crisis hotlines from Wikipedia and static data\r\n * @param {boolean} forceRefresh - Whether to force refresh Wikipedia data\r\n * @returns {Promise<Array>} Combined hotline data\r\n */\r\nexport const getCombinedHotlines = async (forceRefresh = false) => {\r\n  // Skip trying to fetch from Wikipedia - just use static data\r\n  return { \r\n    hotlines: staticHotlines,\r\n    source: 'static',\r\n    wikiSuccess: false,\r\n    error: \"Using reliable local database only\"\r\n  };\r\n};\r\n\r\n/**\r\n * Get the cache status of Wikipedia hotlines\r\n */\r\nexport const getHotlinesCacheStatus = () => {\r\n  return getWikiHotlinesCacheInfo();\r\n};\r\n\r\n/**\r\n * Find hotlines for a specific country code\r\n * @param {Array} hotlines - Array of hotline data\r\n * @param {string} countryCode - Two-letter country code\r\n * @returns {Object|null} Country hotlines or null if not found\r\n */\r\nexport const getHotlinesForCountry = (hotlines, countryCode) => {\r\n  if (!countryCode || !hotlines || !Array.isArray(hotlines)) return null;\r\n  \r\n  // Normalize country code to uppercase\r\n  const normalizedCode = countryCode.toUpperCase();\r\n  \r\n  // Find matching country\r\n  const country = hotlines.find(c => c.countryCode === normalizedCode);\r\n  \r\n  // Return country data or international as fallback\r\n  return country || hotlines.find(c => c.countryCode === \"INTL\");\r\n};\r\n\r\n/**\r\n * Get all available countries with hotlines\r\n * @param {Array} hotlines - Array of hotline data\r\n * @returns {Array} List of countries with their codes\r\n */\r\nexport const getAvailableCountries = (hotlines) => {\r\n  if (!hotlines || !Array.isArray(hotlines)) return [];\r\n  \r\n  return hotlines.map(country => ({\r\n    name: country.country,\r\n    code: country.countryCode\r\n  }));\r\n};\r\n\r\n/**\r\n * Merge Wikipedia and static hotline data\r\n * @param {Array} wikiHotlines - Hotlines from Wikipedia\r\n * @param {Array} staticHotlines - Our static hotlines\r\n * @returns {Array} Merged hotlines\r\n */\r\nconst mergeCrisisHotlines = (wikiHotlines, staticHotlines) => {\r\n  // Start with a copy of wiki hotlines\r\n  const merged = [...wikiHotlines];\r\n  const wikiCountryCodes = wikiHotlines.map(h => h.countryCode);\r\n  \r\n  // Add static hotlines that aren't in Wikipedia data\r\n  for (const hotline of staticHotlines) {\r\n    if (!wikiCountryCodes.includes(hotline.countryCode)) {\r\n      merged.push(hotline);\r\n    }\r\n  }\r\n  \r\n  // Always include international entry if not present\r\n  if (!merged.find(h => h.countryCode === 'INTL')) {\r\n    merged.push(staticHotlines.find(h => h.countryCode === 'INTL'));\r\n  }\r\n  \r\n  // Sort by country name\r\n  return merged.sort((a, b) => a.country.localeCompare(b.country));\r\n};","import React, { useState, useEffect } from 'react';\r\nimport { getUserCountry } from '../services/geoLocationService';\r\nimport { getCombinedHotlines, getHotlinesForCountry, getAvailableCountries, getHotlinesCacheStatus } from '../services/crisisHotlineService';\r\nimport './CrisisHotlines.css';\r\n\r\nconst CrisisHotlines = () => {\r\n  const [userCountry, setUserCountry] = useState(null);\r\n  const [countryHotlines, setCountryHotlines] = useState(null);\r\n  const [availableCountries, setAvailableCountries] = useState([]);\r\n  const [allHotlines, setAllHotlines] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [selectedCountry, setSelectedCountry] = useState(null);\r\n  const [dataSource, setDataSource] = useState(null);\r\n  const [cacheInfo, setCacheInfo] = useState(null);\r\n  const [isRefreshing, setIsRefreshing] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      setLoading(true);\r\n      try {\r\n        // Get the user's country\r\n        const country = await getUserCountry();\r\n        setUserCountry(country);\r\n        \r\n        // Get combined hotlines\r\n        const { hotlines, source, wikiSuccess, error } = await getCombinedHotlines();\r\n        setAllHotlines(hotlines);\r\n        setDataSource({ source, wikiSuccess, error });\r\n        \r\n        // Get cache information\r\n        const cacheStatus = getHotlinesCacheStatus();\r\n        setCacheInfo(cacheStatus);\r\n        \r\n        // Get available countries with hotlines\r\n        const countries = getAvailableCountries(hotlines);\r\n        setAvailableCountries(countries);\r\n        \r\n        // Set the initial selected country to user's country or first in list\r\n        const initialCountry = country?.countryCode || (countries.length > 0 ? countries[0].code : null);\r\n        setSelectedCountry(initialCountry);\r\n        \r\n        // Get hotlines for the country\r\n        if (initialCountry) {\r\n          const countryData = getHotlinesForCountry(hotlines, initialCountry);\r\n          setCountryHotlines(countryData);\r\n        }\r\n      } catch (err) {\r\n        console.error(\"Error fetching hotline data:\", err);\r\n        setError(\"Could not retrieve crisis hotlines. Please check your connection.\");\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    \r\n    fetchData();\r\n  }, []);\r\n\r\n  const handleCountryChange = (e) => {\r\n    const countryCode = e.target.value;\r\n    setSelectedCountry(countryCode);\r\n    const hotlines = getHotlinesForCountry(allHotlines, countryCode);\r\n    setCountryHotlines(hotlines);\r\n  };\r\n\r\n  const handleRefreshData = async () => {\r\n    if (isRefreshing) return;\r\n    \r\n    setIsRefreshing(true);\r\n    try {\r\n      // Force refresh of Wikipedia data\r\n      const { hotlines, source, wikiSuccess, error } = await getCombinedHotlines(true);\r\n      setAllHotlines(hotlines);\r\n      setDataSource({ source, wikiSuccess, error });\r\n      \r\n      // Update cache information\r\n      const cacheStatus = getHotlinesCacheStatus();\r\n      setCacheInfo(cacheStatus);\r\n      \r\n      // Update available countries\r\n      const countries = getAvailableCountries(hotlines);\r\n      setAvailableCountries(countries);\r\n      \r\n      // Update selected country's data\r\n      if (selectedCountry) {\r\n        const countryData = getHotlinesForCountry(hotlines, selectedCountry);\r\n        setCountryHotlines(countryData);\r\n      }\r\n      \r\n      // Show success message\r\n      setError(\"Crisis hotlines updated successfully!\");\r\n      setTimeout(() => setError(null), 3000);\r\n    } catch (err) {\r\n      console.error(\"Error refreshing hotline data:\", err);\r\n      setError(\"Failed to refresh crisis hotlines. Please check your connection.\");\r\n    } finally {\r\n      setIsRefreshing(false);\r\n    }\r\n  };\r\n\r\n  const callHotline = (phoneNumber) => {\r\n    if (phoneNumber && !phoneNumber.toLowerCase().startsWith('text')) {\r\n      window.location.href = `tel:${phoneNumber.replace(/\\s+/g, '')}`;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"crisis-hotlines\">\r\n      <h2>\r\n        <span className=\"emergency-icon\"></span> \r\n        Emergency Crisis Hotlines\r\n      </h2>\r\n      \r\n      {loading ? (\r\n        <div className=\"hotlines-loading\">\r\n          <div className=\"hotlines-spinner\"></div>\r\n          <p>Finding emergency resources for your location...</p>\r\n        </div>\r\n      ) : (\r\n        <>\r\n          <div className=\"country-selection\">\r\n            <div className=\"country-selector\">\r\n              <label htmlFor=\"country-select\">\r\n                Select your country:\r\n                {userCountry && userCountry.source === 'api' && (\r\n                  <span className=\"detected-country\"> \r\n                    (Detected: {userCountry.country})\r\n                  </span>\r\n                )}\r\n              </label>\r\n              <select \r\n                id=\"country-select\" \r\n                value={selectedCountry || ''} \r\n                onChange={handleCountryChange}\r\n              >\r\n                {availableCountries.map(country => (\r\n                  <option key={country.code} value={country.code}>\r\n                    {country.name}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n            \r\n            <div className=\"data-source-info\">\r\n              {dataSource && (\r\n                <div className={`data-source ${dataSource.wikiSuccess ? 'wiki-success' : 'wiki-error'}`}>\r\n                  <span>\r\n                    Source: {dataSource.wikiSuccess ? 'Wikipedia + Local Database' : 'Local Database Only'}\r\n                  </span>\r\n                  {cacheInfo && cacheInfo.exists && (\r\n                    <span className=\"cache-age\">Updated: {cacheInfo.age}</span>\r\n                  )}\r\n                  <button \r\n                    onClick={handleRefreshData} \r\n                    disabled={isRefreshing || !navigator.onLine}\r\n                    className=\"refresh-button\"\r\n                    title=\"Update crisis hotlines from Wikipedia\"\r\n                  >\r\n                    <span className={`refresh-icon ${isRefreshing ? 'spinning' : ''}`}></span>\r\n                    <span className=\"refresh-text\">Update</span>\r\n                  </button>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n          \r\n          {error && (\r\n            <div className={`hotlines-message ${error.includes('successfully') ? 'success' : 'error'}`}>\r\n              <p>{error}</p>\r\n            </div>\r\n          )}\r\n          \r\n          <div className=\"emergency-notice\">\r\n            <p className=\"emergency-text\">\r\n              <strong>If you are in immediate danger of harming yourself or others,\r\n              please call your local emergency services (such as 911 in the US) immediately.</strong>\r\n            </p>\r\n          </div>\r\n          \r\n          {countryHotlines && (\r\n            <div className=\"hotlines-list\">\r\n              <h3>Crisis Support in {countryHotlines.country}</h3>\r\n              {countryHotlines.hotlines.map((hotline, index) => (\r\n                <div key={index} className=\"hotline-card\">\r\n                  <h4 className=\"hotline-name\">{hotline.name}</h4>\r\n                  \r\n                  {hotline.phone && (\r\n                    <div \r\n                      className={`hotline-phone ${!hotline.phone.toLowerCase().startsWith('text') ? 'clickable' : ''}`}\r\n                      onClick={() => callHotline(hotline.phone)}\r\n                    >\r\n                      <span className=\"phone-icon\"></span> {hotline.phone}\r\n                    </div>\r\n                  )}\r\n                  \r\n                  {hotline.altPhone && (\r\n                    <div \r\n                      className={`hotline-alt-phone ${!hotline.altPhone.toLowerCase().startsWith('text') ? 'clickable' : ''}`}\r\n                      onClick={() => callHotline(hotline.altPhone)}\r\n                    >\r\n                      <span className=\"phone-icon\"></span> {hotline.altPhone}\r\n                    </div>\r\n                  )}\r\n                  \r\n                  {hotline.description && (\r\n                    <div className=\"hotline-description\">\r\n                      {hotline.description}\r\n                    </div>\r\n                  )}\r\n                  \r\n                  {hotline.website && (\r\n                    <a \r\n                      href={hotline.website} \r\n                      target=\"_blank\" \r\n                      rel=\"noopener noreferrer\"\r\n                      className=\"hotline-website\"\r\n                    >\r\n                      Visit Website <span className=\"external-icon\"></span>\r\n                    </a>\r\n                  )}\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n          \r\n          <div className=\"additional-resources\">\r\n            <h3>Additional Resources</h3>\r\n            <p>\r\n              International Association for Suicide Prevention: \r\n              <a \r\n                href=\"https://www.iasp.info/resources/Crisis_Centres/\" \r\n                target=\"_blank\" \r\n                rel=\"noopener noreferrer\"\r\n              >\r\n                Find more crisis centers worldwide\r\n              </a>\r\n            </p>\r\n            <p>\r\n              Wikipedia List of Suicide Crisis Lines: \r\n              <a \r\n                href=\"https://en.wikipedia.org/wiki/List_of_suicide_crisis_lines\" \r\n                target=\"_blank\" \r\n                rel=\"noopener noreferrer\"\r\n              >\r\n                View complete list\r\n              </a>\r\n            </p>\r\n          </div>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CrisisHotlines;","/**\r\n * Service for handling push notifications and reminders\r\n */\r\n\r\nimport { openDB } from 'idb';\r\n\r\nconst DB_NAME = 'MindMattersDB';\r\nconst DB_VERSION = 1;\r\nconst SETTINGS_STORE = 'settings';\r\n\r\n/**\r\n * Check if notifications are supported and permission is granted\r\n * @returns {Promise<boolean>} Whether notifications can be used\r\n */\r\nexport const canUseNotifications = async () => {\r\n  if (!('Notification' in window)) {\r\n    return false;\r\n  }\r\n  \r\n  // If permission is already granted\r\n  if (Notification.permission === 'granted') {\r\n    return true;\r\n  }\r\n  \r\n  // If permission is denied, we can't request again\r\n  if (Notification.permission === 'denied') {\r\n    return false;\r\n  }\r\n  \r\n  // Otherwise, we need to request permission\r\n  try {\r\n    const permission = await Notification.requestPermission();\r\n    return permission === 'granted';\r\n  } catch (error) {\r\n    console.error('Error requesting notification permission:', error);\r\n    return false;\r\n  }\r\n};\r\n\r\n/**\r\n * Request notification permission\r\n * @returns {Promise<string>} The permission status\r\n */\r\nexport const requestNotificationPermission = async () => {\r\n  if (!('Notification' in window)) {\r\n    return 'unsupported';\r\n  }\r\n  \r\n  try {\r\n    return await Notification.requestPermission();\r\n  } catch (error) {\r\n    console.error('Error requesting notification permission:', error);\r\n    return 'error';\r\n  }\r\n};\r\n\r\n/**\r\n * Schedule a daily reminder notification\r\n * @param {number} hour - Hour of day (0-23)\r\n * @param {number} minute - Minute of hour (0-59)\r\n */\r\nexport const scheduleDailyReminder = async (hour = 20, minute = 0) => {\r\n  // Check if we can use notifications\r\n  const canUse = await canUseNotifications();\r\n  if (!canUse) {\r\n    console.warn('Cannot use notifications. Permission denied or not supported.');\r\n    return false;\r\n  }\r\n  \r\n  try {\r\n    // Save reminder settings to IndexedDB\r\n    await saveNotificationSettings({\r\n      enabled: true,\r\n      reminderTime: { hour, minute }\r\n    });\r\n    \r\n    // Create a Date object for today at the specified time\r\n    const now = new Date();\r\n    const reminderTime = new Date(\r\n      now.getFullYear(),\r\n      now.getMonth(),\r\n      now.getDate(),\r\n      hour,\r\n      minute,\r\n      0\r\n    );\r\n    \r\n    // If the time has already passed today, set it for tomorrow\r\n    if (reminderTime < now) {\r\n      reminderTime.setDate(reminderTime.getDate() + 1);\r\n    }\r\n    \r\n    // Schedule with service worker if available\r\n    if ('serviceWorker' in navigator && navigator.serviceWorker.controller) {\r\n      navigator.serviceWorker.controller.postMessage({\r\n        type: 'SCHEDULE_NOTIFICATION',\r\n        title: 'MindMatters Daily Check-in',\r\n        body: 'How are you feeling today? Take a moment to log your mood.',\r\n        tag: 'daily-reminder',\r\n        timestamp: reminderTime.getTime()\r\n      });\r\n      \r\n      return true;\r\n    } else {\r\n      // Fallback to setTimeout if service worker is not available\r\n      // Note: This won't work if the app is closed\r\n      const delay = reminderTime.getTime() - now.getTime();\r\n      \r\n      setTimeout(() => {\r\n        new Notification('MindMatters Daily Check-in', {\r\n          body: 'How are you feeling today? Take a moment to log your mood.',\r\n          icon: '/icons/icon-192x192.png',\r\n          badge: '/icons/badge-96x96.png',\r\n        });\r\n      }, delay);\r\n      \r\n      return true;\r\n    }\r\n  } catch (error) {\r\n    console.error('Error scheduling notification:', error);\r\n    return false;\r\n  }\r\n};\r\n\r\n/**\r\n * Cancel scheduled daily reminders\r\n */\r\nexport const cancelDailyReminder = async () => {\r\n  try {\r\n    // Save the disabled state to IndexedDB\r\n    await saveNotificationSettings({\r\n      enabled: false\r\n    });\r\n    \r\n    // Notify service worker if available\r\n    if ('serviceWorker' in navigator && navigator.serviceWorker.controller) {\r\n      navigator.serviceWorker.controller.postMessage({\r\n        type: 'CANCEL_NOTIFICATIONS',\r\n        tag: 'daily-reminder'\r\n      });\r\n    }\r\n    \r\n    return true;\r\n  } catch (error) {\r\n    console.error('Error cancelling reminders:', error);\r\n    return false;\r\n  }\r\n};\r\n\r\n/**\r\n * Check if a reminder is currently scheduled\r\n * @returns {Promise<boolean>} Whether a reminder is active\r\n */\r\nexport const isReminderActive = async () => {\r\n  try {\r\n    const settings = await getNotificationSettings();\r\n    return settings && settings.enabled;\r\n  } catch (error) {\r\n    console.error('Error checking reminder state:', error);\r\n    return false;\r\n  }\r\n};\r\n\r\n/**\r\n * Get the current reminder time\r\n * @returns {Promise<Object|null>} The reminder time { hour, minute } or null\r\n */\r\nexport const getReminderTime = async () => {\r\n  try {\r\n    const settings = await getNotificationSettings();\r\n    return settings && settings.reminderTime ? \r\n      settings.reminderTime : \r\n      { hour: 20, minute: 0 }; // Default: 8:00 PM\r\n  } catch (error) {\r\n    console.error('Error getting reminder time:', error);\r\n    return { hour: 20, minute: 0 };\r\n  }\r\n};\r\n\r\n// Helper functions for working with IndexedDB\r\n\r\n/**\r\n * Save notification settings to IndexedDB\r\n * @param {Object} settings - Notification settings\r\n */\r\nconst saveNotificationSettings = async (settings) => {\r\n  const db = await openDB(DB_NAME, DB_VERSION, {\r\n    upgrade(db) {\r\n      if (!db.objectStoreNames.contains(SETTINGS_STORE)) {\r\n        db.createObjectStore(SETTINGS_STORE, { keyPath: 'id' });\r\n      }\r\n    }\r\n  });\r\n  \r\n  await db.put(SETTINGS_STORE, {\r\n    id: 'notificationSettings',\r\n    value: settings\r\n  });\r\n};\r\n\r\n/**\r\n * Get notification settings from IndexedDB\r\n * @returns {Promise<Object|null>} The notification settings or null\r\n */\r\nconst getNotificationSettings = async () => {\r\n  try {\r\n    const db = await openDB(DB_NAME, DB_VERSION);\r\n    const settings = await db.get(SETTINGS_STORE, 'notificationSettings');\r\n    return settings ? settings.value : null;\r\n  } catch (error) {\r\n    console.error('Error getting notification settings:', error);\r\n    return null;\r\n  }\r\n};\r\n\r\n/**\r\n * Register for background periodic sync (Chrome only)\r\n */\r\nexport const registerPeriodicSync = async () => {\r\n  if ('serviceWorker' in navigator && 'periodicSync' in navigator.serviceWorker) {\r\n    try {\r\n      // Get the service worker registration\r\n      const registration = await navigator.serviceWorker.ready;\r\n      \r\n      // Check if periodic sync is available\r\n      if ('periodicSync' in registration) {\r\n        // Request permission\r\n        const status = await navigator.permissions.query({\r\n          name: 'periodic-background-sync',\r\n        });\r\n        \r\n        if (status.state === 'granted') {\r\n          // Register for daily sync\r\n          await registration.periodicSync.register('daily-reminder', {\r\n            minInterval: 24 * 60 * 60 * 1000, // Once per day\r\n          });\r\n          \r\n          return true;\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Error registering for periodic sync:', error);\r\n    }\r\n  }\r\n  \r\n  return false;\r\n};\r\n\r\n/**\r\n * Send a test notification\r\n */\r\nexport const sendTestNotification = async () => {\r\n  const canUse = await canUseNotifications();\r\n  \r\n  if (!canUse) {\r\n    console.warn('Cannot send test notification. Permission denied or not supported.');\r\n    return false;\r\n  }\r\n  \r\n  try {\r\n    new Notification('MindMatters Test Notification', {\r\n      body: 'This is a test notification from MindMatters app.',\r\n      icon: '/icons/icon-192x192.png',\r\n      badge: '/icons/badge-96x96.png',\r\n    });\r\n    \r\n    return true;\r\n  } catch (error) {\r\n    console.error('Error sending test notification:', error);\r\n    return false;\r\n  }\r\n};","import React, { useState, useEffect } from 'react';\r\nimport { requestNotificationPermission, scheduleDailyReminder, cancelDailyReminder, isReminderActive, getReminderTime, sendTestNotification } from '../services/notificationService';\r\nimport './Settings.css';\r\n\r\nconst Settings = () => {\r\n    const [activeSection, setActiveSection] = useState('notifications');\r\n    const [notificationPermission, setNotificationPermission] = useState('default');\r\n    const [reminderEnabled, setReminderEnabled] = useState(false);\r\n    const [reminderTime, setReminderTime] = useState('20:00');\r\n    const [isInstalledPWA, setIsInstalledPWA] = useState(false);\r\n    const [appVersion, setAppVersion] = useState('1.0.0');\r\n    const [offlineStatus, setOfflineStatus] = useState(navigator.onLine ? 'online' : 'offline');\r\n    const [testNotificationSent, setTestNotificationSent] = useState(false);\r\n    const [storageUsage, setStorageUsage] = useState(null);\r\n\r\n    // Check notification permission and reminder status on mount\r\n    useEffect(() => {\r\n        const checkNotificationState = async () => {\r\n            setNotificationPermission(Notification.permission);\r\n            \r\n            const reminderActive = await isReminderActive();\r\n            setReminderEnabled(reminderActive);\r\n            \r\n            const time = await getReminderTime();\r\n            if (time) {\r\n                setReminderTime(\r\n                    `${String(time.hour).padStart(2, '0')}:${String(time.minute).padStart(2, '0')}`\r\n                );\r\n            }\r\n        };\r\n        \r\n        if ('Notification' in window) {\r\n            checkNotificationState();\r\n        }\r\n    }, []);\r\n    \r\n    // Check if app is installed as PWA\r\n    useEffect(() => {\r\n        const checkPWAStatus = () => {\r\n            // Check if app is in standalone mode or display-mode is standalone\r\n            const isStandalone = window.matchMedia('(display-mode: standalone)').matches || \r\n                                window.navigator.standalone || \r\n                                document.referrer.includes('android-app://');\r\n                                \r\n            setIsInstalledPWA(isStandalone);\r\n        };\r\n        \r\n        checkPWAStatus();\r\n    }, []);\r\n    \r\n    // Monitor online/offline status\r\n    useEffect(() => {\r\n        const handleOnline = () => setOfflineStatus('online');\r\n        const handleOffline = () => setOfflineStatus('offline');\r\n        \r\n        window.addEventListener('online', handleOnline);\r\n        window.addEventListener('offline', handleOffline);\r\n        \r\n        return () => {\r\n            window.removeEventListener('online', handleOnline);\r\n            window.removeEventListener('offline', handleOffline);\r\n        };\r\n    }, []);\r\n    \r\n    // Calculate storage usage\r\n    useEffect(() => {\r\n        const calculateStorageUsage = async () => {\r\n            if ('storage' in navigator && 'estimate' in navigator.storage) {\r\n                try {\r\n                    const estimate = await navigator.storage.estimate();\r\n                    const usedMB = Math.round(estimate.usage / (1024 * 1024) * 10) / 10;\r\n                    const quotaMB = Math.round(estimate.quota / (1024 * 1024) * 10) / 10;\r\n                    const percentUsed = Math.round((estimate.usage / estimate.quota) * 100);\r\n                    \r\n                    setStorageUsage({\r\n                        used: usedMB,\r\n                        quota: quotaMB,\r\n                        percent: percentUsed\r\n                    });\r\n                } catch (error) {\r\n                    console.error('Error calculating storage usage:', error);\r\n                }\r\n            }\r\n        };\r\n        \r\n        calculateStorageUsage();\r\n    }, []);\r\n\r\n    // Request notification permission\r\n    const handleRequestPermission = async () => {\r\n        const permission = await requestNotificationPermission();\r\n        setNotificationPermission(permission);\r\n    };\r\n\r\n    // Toggle daily reminder\r\n    const handleToggleReminder = async () => {\r\n        try {\r\n            if (reminderEnabled) {\r\n                await cancelDailyReminder();\r\n                setReminderEnabled(false);\r\n            } else {\r\n                const [hour, minute] = reminderTime.split(':').map(Number);\r\n                const success = await scheduleDailyReminder(hour, minute);\r\n                setReminderEnabled(success);\r\n            }\r\n        } catch (error) {\r\n            console.error('Error toggling reminder:', error);\r\n        }\r\n    };\r\n\r\n    // Update reminder time\r\n    const handleTimeChange = async (e) => {\r\n        const newTime = e.target.value;\r\n        setReminderTime(newTime);\r\n        \r\n        if (reminderEnabled) {\r\n            const [hour, minute] = newTime.split(':').map(Number);\r\n            await scheduleDailyReminder(hour, minute);\r\n        }\r\n    };\r\n    \r\n    // Send test notification\r\n    const handleTestNotification = async () => {\r\n        const success = await sendTestNotification();\r\n        setTestNotificationSent(success);\r\n        \r\n        if (success) {\r\n            setTimeout(() => setTestNotificationSent(false), 3000);\r\n        }\r\n    };\r\n    \r\n    // Handle app installation\r\n    const handleInstallClick = () => {\r\n        if (window.deferredPrompt) {\r\n            window.deferredPrompt.prompt();\r\n            window.deferredPrompt.userChoice.then((choiceResult) => {\r\n                if (choiceResult.outcome === 'accepted') {\r\n                    console.log('User accepted the install prompt');\r\n                    setIsInstalledPWA(true);\r\n                } else {\r\n                    console.log('User dismissed the install prompt');\r\n                }\r\n                window.deferredPrompt = null;\r\n            });\r\n        }\r\n    };\r\n    \r\n    // Clear app data\r\n    const handleClearData = async () => {\r\n        if (window.confirm('Are you sure? This will delete all your journal entries and settings.')) {\r\n            try {\r\n                // Clear IndexedDB\r\n                const databases = await window.indexedDB.databases();\r\n                databases.forEach(db => {\r\n                    window.indexedDB.deleteDatabase(db.name);\r\n                });\r\n                \r\n                // Clear localStorage\r\n                localStorage.clear();\r\n                \r\n                // Clear caches\r\n                if ('caches' in window) {\r\n                    const keys = await caches.keys();\r\n                    await Promise.all(keys.map(key => caches.delete(key)));\r\n                }\r\n                \r\n                // Reload the app\r\n                window.location.reload();\r\n            } catch (error) {\r\n                console.error('Error clearing app data:', error);\r\n            }\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"settings\">\r\n            <h2>\r\n                <span className=\"settings-icon\"></span>\r\n                Settings\r\n            </h2>\r\n            \r\n            <div className=\"settings-container\">\r\n                <div className=\"settings-sidebar\">\r\n                    <button \r\n                        className={`settings-nav-btn ${activeSection === 'notifications' ? 'active' : ''}`}\r\n                        onClick={() => setActiveSection('notifications')}\r\n                    >\r\n                        <span className=\"settings-nav-icon\"></span>\r\n                        Notifications\r\n                    </button>\r\n                    <button \r\n                        className={`settings-nav-btn ${activeSection === 'app' ? 'active' : ''}`}\r\n                        onClick={() => setActiveSection('app')}\r\n                    >\r\n                        <span className=\"settings-nav-icon\"></span>\r\n                        App Installation\r\n                    </button>\r\n                    <button \r\n                        className={`settings-nav-btn ${activeSection === 'data' ? 'active' : ''}`}\r\n                        onClick={() => setActiveSection('data')}\r\n                    >\r\n                        <span className=\"settings-nav-icon\"></span>\r\n                        Data Management\r\n                    </button>\r\n                    <button \r\n                        className={`settings-nav-btn ${activeSection === 'about' ? 'active' : ''}`}\r\n                        onClick={() => setActiveSection('about')}\r\n                    >\r\n                        <span className=\"settings-nav-icon\"></span>\r\n                        About\r\n                    </button>\r\n                </div>\r\n                \r\n                <div className=\"settings-content\">\r\n                    {activeSection === 'notifications' && (\r\n                        <div className=\"settings-section\">\r\n                            <h3>Notification Settings</h3>\r\n                            <p>Configure reminders to help you maintain a consistent journaling habit.</p>\r\n                            \r\n                            <div className=\"settings-subsection\">\r\n                                <h4>Push Notifications</h4>\r\n                                {!('Notification' in window) ? (\r\n                                    <p className=\"settings-warning\">\r\n                                        Your browser doesn't support push notifications.\r\n                                    </p>\r\n                                ) : notificationPermission === 'denied' ? (\r\n                                    <p className=\"settings-warning\">\r\n                                        Notification permission was denied. Please update your browser settings to enable notifications.\r\n                                    </p>\r\n                                ) : notificationPermission !== 'granted' ? (\r\n                                    <div>\r\n                                        <p>Allow MindMatters to send you helpful reminders.</p>\r\n                                        <button \r\n                                            onClick={handleRequestPermission} \r\n                                            className=\"settings-btn\"\r\n                                        >\r\n                                            Enable Notifications\r\n                                        </button>\r\n                                    </div>\r\n                                ) : (\r\n                                    <div>\r\n                                        <p>Notification permission granted. You can now receive reminders.</p>\r\n                                        <button \r\n                                            onClick={handleTestNotification} \r\n                                            className=\"settings-btn\"\r\n                                            disabled={testNotificationSent}\r\n                                        >\r\n                                            {testNotificationSent ? 'Notification Sent!' : 'Send Test Notification'}\r\n                                        </button>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                            \r\n                            <div className=\"settings-subsection\">\r\n                                <h4>Daily Journal Reminder</h4>\r\n                                <div className=\"toggle-setting\">\r\n                                    <label className=\"toggle-label\">\r\n                                        Enable daily reminder\r\n                                        <div className=\"toggle-switch\">\r\n                                            <input\r\n                                                type=\"checkbox\"\r\n                                                checked={reminderEnabled}\r\n                                                onChange={handleToggleReminder}\r\n                                                disabled={notificationPermission !== 'granted'}\r\n                                            />\r\n                                            <span className=\"toggle-slider\"></span>\r\n                                        </div>\r\n                                    </label>\r\n                                </div>\r\n                                \r\n                                <div className=\"time-setting\">\r\n                                    <label htmlFor=\"reminderTime\">Reminder Time:</label>\r\n                                    <input\r\n                                        type=\"time\"\r\n                                        id=\"reminderTime\"\r\n                                        value={reminderTime}\r\n                                        onChange={handleTimeChange}\r\n                                        disabled={!reminderEnabled || notificationPermission !== 'granted'}\r\n                                    />\r\n                                    <p className=\"time-note\">We'll send you a reminder to journal at this time each day.</p>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                    \r\n                    {activeSection === 'app' && (\r\n                        <div className=\"settings-section\">\r\n                            <h3>App Installation</h3>\r\n                            <p>Install MindMatters on your device for a better experience and offline access.</p>\r\n                            \r\n                            <div className=\"settings-subsection\">\r\n                                <h4>Install as App</h4>\r\n                                {isInstalledPWA ? (\r\n                                    <p>MindMatters is already installed on your device.</p>\r\n                                ) : (\r\n                                    <>\r\n                                        <p>\r\n                                            Install MindMatters on your home screen for quick access and a full-screen experience,\r\n                                            even when offline.\r\n                                        </p>\r\n                                        <button \r\n                                            onClick={handleInstallClick} \r\n                                            className=\"install-button\"\r\n                                            disabled={!window.deferredPrompt}\r\n                                        >\r\n                                            Install MindMatters\r\n                                        </button>\r\n                                        {!window.deferredPrompt && (\r\n                                            <div className=\"install-note\">\r\n                                                <p>\r\n                                                    To install manually:\r\n                                                    {navigator.userAgent.includes('Chrome') && (\r\n                                                        <span> Click the menu () then \"Install App\"</span>\r\n                                                    )}\r\n                                                    {navigator.userAgent.includes('Firefox') && (\r\n                                                        <span> Click the menu () then \"Install app\"</span>\r\n                                                    )}\r\n                                                    {navigator.userAgent.includes('Safari') && !navigator.userAgent.includes('Chrome') && (\r\n                                                        <span> Click the share button then \"Add to Home Screen\"</span>\r\n                                                    )}\r\n                                                </p>\r\n                                            </div>\r\n                                        )}\r\n                                    </>\r\n                                )}\r\n                            </div>\r\n                            \r\n                            <div className=\"settings-subsection\">\r\n                                <h4>Offline Capability</h4>\r\n                                <div className=\"status-items\">\r\n                                    <div className=\"status-item\">\r\n                                        <span className=\"status-label\">Current Status:</span>\r\n                                        <span className={`status-value ${offlineStatus}`}>\r\n                                            {offlineStatus === 'online' ? 'Connected' : 'Offline'}\r\n                                        </span>\r\n                                    </div>\r\n                                    <p className=\"status-info\">\r\n                                        MindMatters works even when you're offline. Your data will be stored locally\r\n                                        and synced when you reconnect.\r\n                                    </p>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                    \r\n                    {activeSection === 'data' && (\r\n                        <div className=\"settings-section\">\r\n                            <h3>Data Management</h3>\r\n                            <p>Manage your journal data and app storage.</p>\r\n                            \r\n                            <div className=\"settings-subsection\">\r\n                                <h4>Storage Usage</h4>\r\n                                {storageUsage ? (\r\n                                    <div className=\"storage-usage\">\r\n                                        <div className=\"usage-bar-container\">\r\n                                            <div \r\n                                                className=\"usage-bar\" \r\n                                                style={{ width: `${storageUsage.percent}%` }}\r\n                                            ></div>\r\n                                        </div>\r\n                                        <p className=\"usage-text\">\r\n                                            Using {storageUsage.used} MB of {storageUsage.quota} MB ({storageUsage.percent}%)\r\n                                        </p>\r\n                                    </div>\r\n                                ) : (\r\n                                    <p>Storage information not available in this browser.</p>\r\n                                )}\r\n                            </div>\r\n                            \r\n                            <div className=\"settings-subsection\">\r\n                                <h4>Data Actions</h4>\r\n                                <div className=\"data-actions\">\r\n                                    {/* This section could include import/export features in the future */}\r\n                                    <button \r\n                                        onClick={handleClearData} \r\n                                        className=\"danger-button\"\r\n                                    >\r\n                                        Clear All App Data\r\n                                    </button>\r\n                                    <p className=\"warning-text\">\r\n                                        This will delete all your journal entries, mood tracking data, and app settings.\r\n                                        This action cannot be undone.\r\n                                    </p>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                    \r\n                    {activeSection === 'about' && (\r\n                        <div className=\"settings-section\">\r\n                            <h3>About MindMatters</h3>\r\n                            \r\n                            <div className=\"settings-subsection\">\r\n                                <div className=\"app-info\">\r\n                                    <img \r\n                                        src=\"/icons/icon-192x192.png\" \r\n                                        alt=\"MindMatters Logo\" \r\n                                        className=\"app-logo\" \r\n                                    />\r\n                                    <div>\r\n                                        <h4>MindMatters</h4>\r\n                                        <p>Version {appVersion}</p>\r\n                                    </div>\r\n                                </div>\r\n                                <p className=\"app-description\">\r\n                                    MindMatters is an offline-first mental health journal designed to help you track\r\n                                    your mood, thoughts, and emotions.\r\n                                </p>\r\n                            </div>\r\n                            \r\n                            <div className=\"settings-subsection\">\r\n                                <h4>App Status</h4>\r\n                                <div className=\"status-items\">\r\n                                    <div className=\"status-item\">\r\n                                        <span className=\"status-label\">Service Worker:</span>\r\n                                        <span className=\"status-value\">\r\n                                            {'serviceWorker' in navigator ? 'Supported' : 'Not Supported'}\r\n                                        </span>\r\n                                    </div>\r\n                                    <div className=\"status-item\">\r\n                                        <span className=\"status-label\">Installed as PWA:</span>\r\n                                        <span className=\"status-value\">\r\n                                            {isInstalledPWA ? 'Yes' : 'No'}\r\n                                        </span>\r\n                                    </div>\r\n                                    <div className=\"status-item\">\r\n                                        <span className=\"status-label\">Notifications:</span>\r\n                                        <span className=\"status-value\">\r\n                                            {'Notification' in window ? \r\n                                                (notificationPermission === 'granted' ? 'Enabled' : 'Disabled') :\r\n                                                'Not Supported'\r\n                                            }\r\n                                        </span>\r\n                                    </div>\r\n                                    <div className=\"status-item\">\r\n                                        <span className=\"status-label\">Connection:</span>\r\n                                        <span className={`status-value ${offlineStatus}`}>\r\n                                            {offlineStatus === 'online' ? 'Online' : 'Offline'}\r\n                                        </span>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                            \r\n                            <div className=\"credits\">\r\n                                <p> 2025 MindMatters - Created with  for mental wellbeing</p>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Settings;","import React, { useState, useEffect } from 'react';\r\nimport { useHistory, useLocation, Link } from 'react-router-dom';\r\nimport JournalEntry from './JournalEntry';\r\nimport JournalLog from './JournalLog';\r\nimport MoodTracker from './MoodTracker';\r\nimport BreathingExercises from './BreathingExercises';\r\nimport EmergencyContacts from './EmergencyContacts';\r\nimport SOSButton from './SOSButton';\r\nimport DailyQuote from './DailyQuote';\r\nimport WeatherMood from './WeatherMood';\r\nimport CrisisHotlines from './CrisisHotlines';\r\nimport Settings from './Settings';\r\nimport { useTheme } from './ThemeManager';\r\nimport './Dashboard.css';\r\n\r\nconst Dashboard = ({ defaultTab }) => {\r\n    const [activeTab, setActiveTab] = useState(defaultTab || 'journal');\r\n    const [mobileNavOpen, setMobileNavOpen] = useState(false);\r\n    const [isOnline, setIsOnline] = useState(navigator.onLine);\r\n    const history = useHistory();\r\n    const location = useLocation();\r\n    const { currentMood } = useTheme();\r\n    \r\n    // Update active tab when route changes\r\n    useEffect(() => {\r\n        const path = location.pathname;\r\n        if (path === '/journal') setActiveTab('journal');\r\n        else if (path === '/history') setActiveTab('history');\r\n        else if (path === '/mood-tracker') setActiveTab('mood');\r\n        else if (path === '/breathing') setActiveTab('breathing');\r\n        else if (path === '/weather-mood') setActiveTab('weather');\r\n        else if (path === '/daily-quote') setActiveTab('quote');\r\n        else if (path === '/crisis-hotlines') setActiveTab('hotlines');\r\n        else if (path === '/emergency-contacts') setActiveTab('contacts');\r\n        else if (path === '/settings') setActiveTab('settings');\r\n    }, [location]);\r\n    \r\n    // Monitor online/offline status\r\n    useEffect(() => {\r\n        const handleOnline = () => setIsOnline(true);\r\n        const handleOffline = () => setIsOnline(false);\r\n        \r\n        window.addEventListener('online', handleOnline);\r\n        window.addEventListener('offline', handleOffline);\r\n        \r\n        return () => {\r\n            window.removeEventListener('online', handleOnline);\r\n            window.removeEventListener('offline', handleOffline);\r\n        };\r\n    }, []);\r\n    \r\n    // Get mood class for conditional styling\r\n    const getMoodClass = () => {\r\n        return currentMood ? `mood-${currentMood}` : '';\r\n    };\r\n\r\n    // Toggle mobile navigation\r\n    const toggleMobileNav = () => {\r\n        setMobileNavOpen(!mobileNavOpen);\r\n    };\r\n    \r\n    // Navigation items with icons and categories\r\n    const navItems = [\r\n        {\r\n            category: \"Journal\",\r\n            items: [\r\n                { id: 'journal', path: '/journal', label: 'New Entry', icon: '' },\r\n                { id: 'history', path: '/history', label: 'Journal History', icon: '' }\r\n            ]\r\n        },\r\n        {\r\n            category: \"Mood\",\r\n            items: [\r\n                { id: 'mood', path: '/mood-tracker', label: 'Mood Tracker', icon: '' },\r\n                { id: 'weather', path: '/weather-mood', label: 'Weather & Mood', icon: '' }\r\n            ]\r\n        },\r\n        {\r\n            category: \"Wellness\",\r\n            items: [\r\n                { id: 'breathing', path: '/breathing', label: 'Breathing', icon: '' },\r\n                { id: 'quote', path: '/daily-quote', label: 'Daily Quote', icon: '' }\r\n            ]\r\n        },\r\n        {\r\n            category: \"Emergency\",\r\n            items: [\r\n                { id: 'hotlines', path: '/crisis-hotlines', label: 'Crisis Hotlines', icon: '' },\r\n                { id: 'contacts', path: '/emergency-contacts', label: 'Emergency Contacts', icon: '' }\r\n            ]\r\n        }\r\n    ];\r\n    \r\n    return (\r\n        <div className={`dashboard ${getMoodClass()}`}>\r\n            <header className=\"dashboard-header\">\r\n                <div className=\"header-content\">\r\n                    <h1>MindMatters</h1>\r\n                    <p>Your personal mental wellness companion</p>\r\n                </div>\r\n                \r\n                <button \r\n                    className=\"mobile-nav-toggle\"\r\n                    onClick={toggleMobileNav}\r\n                    aria-label=\"Toggle navigation menu\"\r\n                >\r\n                    <span className={`hamburger ${mobileNavOpen ? 'active' : ''}`}></span>\r\n                </button>\r\n                \r\n                <div className=\"header-actions\">\r\n                    {!isOnline && (\r\n                        <div className=\"offline-indicator\" title=\"App is in offline mode\">\r\n                            Offline\r\n                        </div>\r\n                    )}\r\n                    \r\n                    <Link \r\n                        to=\"/settings\"\r\n                        className={`settings-link ${activeTab === 'settings' ? 'active' : ''}`}\r\n                        aria-label=\"Settings\"\r\n                    >\r\n                        <span className=\"settings-icon\"></span>\r\n                    </Link>\r\n                    \r\n                    <SOSButton className=\"header-sos\" />\r\n                </div>\r\n            </header>\r\n            \r\n            <div className={`nav-container ${mobileNavOpen ? 'mobile-open' : ''}`}>\r\n                <nav className=\"dashboard-nav\">\r\n                    {navItems.map(category => (\r\n                        <div key={category.category} className=\"nav-category\">\r\n                            <h3 className=\"category-heading\">{category.category}</h3>\r\n                            <div className=\"nav-items\">\r\n                                {category.items.map(item => (\r\n                                    <Link\r\n                                        key={item.id}\r\n                                        to={item.path}\r\n                                        className={`nav-button ${activeTab === item.id ? 'active' : ''}`}\r\n                                        onClick={() => setMobileNavOpen(false)}\r\n                                    >\r\n                                        <span className=\"nav-icon\">{item.icon}</span>\r\n                                        <span className=\"nav-label\">{item.label}</span>\r\n                                    </Link>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                </nav>\r\n            </div>\r\n            \r\n            <main className=\"dashboard-content\">\r\n                {activeTab === 'journal' && <JournalEntry />}\r\n                {activeTab === 'history' && <JournalLog />}\r\n                {activeTab === 'mood' && <MoodTracker />}\r\n                {activeTab === 'breathing' && <BreathingExercises />}\r\n                {activeTab === 'weather' && <WeatherMood />}\r\n                {activeTab === 'quote' && <DailyQuote />}\r\n                {activeTab === 'hotlines' && <CrisisHotlines />}\r\n                {activeTab === 'contacts' && <EmergencyContacts />}\r\n                {activeTab === 'settings' && <Settings />}\r\n                \r\n                {/* Show the quote on the journal page as well for daily inspiration */}\r\n                {activeTab === 'journal' && <DailyQuote />}\r\n            </main>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Dashboard;","import React from 'react';\r\nimport { HashRouter as Router, Route, Switch, Redirect } from 'react-router-dom';\r\nimport Dashboard from './components/Dashboard';\r\nimport Settings from './components/Settings'; // Add this import\r\nimport { ThemeProvider } from './components/ThemeManager';\r\nimport './styles/main.css';\r\n\r\nfunction App() {\r\n  return (\r\n    <ThemeProvider>\r\n      <Router>\r\n        <div className=\"App\">\r\n          <Switch>\r\n            <Route path=\"/journal\" exact>\r\n              <Dashboard defaultTab=\"journal\" />\r\n            </Route>\r\n            <Route path=\"/history\" exact>\r\n              <Dashboard defaultTab=\"history\" />\r\n            </Route>\r\n            <Route path=\"/mood-tracker\" exact>\r\n              <Dashboard defaultTab=\"mood\" />\r\n            </Route>\r\n            <Route path=\"/breathing\" exact>\r\n              <Dashboard defaultTab=\"breathing\" />\r\n            </Route>\r\n            <Route path=\"/weather-mood\" exact>\r\n              <Dashboard defaultTab=\"weather\" />\r\n            </Route>\r\n            <Route path=\"/daily-quote\" exact>\r\n              <Dashboard defaultTab=\"quote\" />\r\n            </Route>\r\n            <Route path=\"/crisis-hotlines\" exact>\r\n              <Dashboard defaultTab=\"hotlines\" />\r\n            </Route>\r\n            <Route path=\"/emergency-contacts\" exact>\r\n              <Dashboard defaultTab=\"contacts\" />\r\n            </Route>\r\n            <Route path=\"/settings\" exact>\r\n              <Dashboard defaultTab=\"settings\" />\r\n            </Route>\r\n            <Route path=\"/\" exact>\r\n              <Redirect to=\"/journal\" />\r\n            </Route>\r\n            <Route path=\"*\">\r\n              <Redirect to=\"/journal\" />\r\n            </Route>\r\n          </Switch>\r\n        </div>\r\n      </Router>\r\n    </ThemeProvider>\r\n  );\r\n}\r\n\r\nexport default App;","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\nimport './styles/main.css';\r\n\r\n// Fix service worker registration\r\nif ('serviceWorker' in navigator) {\r\n  window.addEventListener('load', () => {\r\n    // Use the correct path with proper scope for GitHub Pages\r\n    const swUrl = `${window.location.pathname.includes('/mindmatters-app') ? '/mindmatters-app' : ''}/service-worker.js`;\r\n    \r\n    navigator.serviceWorker.register(swUrl, {\r\n      scope: window.location.pathname.includes('/mindmatters-app') ? '/mindmatters-app/' : '/'\r\n    })\r\n      .then(registration => {\r\n        console.log('ServiceWorker registered with scope:', registration.scope);\r\n      })\r\n      .catch(error => {\r\n        console.error('ServiceWorker registration failed:', error);\r\n      });\r\n  });\r\n}\r\n\r\n// This will hold the deferred prompt for installation\r\nwindow.deferredPrompt = null;\r\n\r\n// Listen for the beforeinstallprompt event\r\nwindow.addEventListener('beforeinstallprompt', (e) => {\r\n  // Prevent Chrome 67+ from automatically showing the prompt\r\n  e.preventDefault();\r\n  \r\n  // Stash the event so it can be triggered later\r\n  window.deferredPrompt = e;\r\n  \r\n  console.log('App can be installed');\r\n});\r\n\r\n// Listen for app installed event\r\nwindow.addEventListener('appinstalled', () => {\r\n  // Clear the deferredPrompt so it can't be used again\r\n  window.deferredPrompt = null;\r\n  console.log('PWA installed successfully');\r\n});\r\n\r\n// Handle offline status initially\r\nif (!navigator.onLine) {\r\n  document.body.classList.add('offline-mode');\r\n}\r\n\r\n// Listen for online/offline events\r\nwindow.addEventListener('online', () => document.body.classList.remove('offline-mode'));\r\nwindow.addEventListener('offline', () => document.body.classList.add('offline-mode'));\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);"],"sourceRoot":""}